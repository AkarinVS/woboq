<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>yaml-parser-fuzzer.cpp source code [llvm/llvm/tools/llvm-yaml-parser-fuzzer/yaml-parser-fuzzer.cpp] - Woboq Code Browser</title>
<link rel="stylesheet" href="../../../.././data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../.././data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../.././data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../.././data/jquery/jquery-ui.min.js"></script>
<script>var file = 'llvm/llvm/tools/llvm-yaml-parser-fuzzer/yaml-parser-fuzzer.cpp'; var root_path = '../../../..'; var data_path = '../../../.././data'; var ecma_script_api_version = 2;</script>
<script src='../../../.././data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../..'>llvm</a>/<a href='../..'>llvm</a>/<a href='..'>tools</a>/<a href='./'>llvm-yaml-parser-fuzzer</a>/<a href='yaml-parser-fuzzer.cpp.html'>yaml-parser-fuzzer.cpp</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>//===-- yaml-parser-fuzzer.cpp - Fuzzer for YAML parser -------------------===//</i></td></tr>
<tr><th id="2">2</th><td><i>//</i></td></tr>
<tr><th id="3">3</th><td><i>// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</i></td></tr>
<tr><th id="4">4</th><td><i>// See <a href="https://llvm.org/LICENSE.txt">https://llvm.org/LICENSE.txt</a> for license information.</i></td></tr>
<tr><th id="5">5</th><td><i>// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</i></td></tr>
<tr><th id="6">6</th><td><i>//</i></td></tr>
<tr><th id="7">7</th><td><i>//===----------------------------------------------------------------------===//</i></td></tr>
<tr><th id="8">8</th><td></td></tr>
<tr><th id="9">9</th><td><u>#include <a href="../../include/llvm/ADT/StringRef.h.html">"llvm/ADT/StringRef.h"</a></u></td></tr>
<tr><th id="10">10</th><td><u>#include <a href="../../include/llvm/Support/YAMLParser.h.html">"llvm/Support/YAMLParser.h"</a></u></td></tr>
<tr><th id="11">11</th><td></td></tr>
<tr><th id="12">12</th><td><b>using</b> <b>namespace</b> <span class="namespace">llvm</span>;</td></tr>
<tr><th id="13">13</th><td></td></tr>
<tr><th id="14">14</th><td><em>static</em> <em>bool</em> <dfn class="tu decl def fn" id="_ZL11isValidYamlPKhm" title='isValidYaml' data-type='bool isValidYaml(const uint8_t * Data, size_t Size)' data-ref="_ZL11isValidYamlPKhm" data-ref-filename="_ZL11isValidYamlPKhm">isValidYaml</dfn>(<em>const</em> <a class="typedef" href="../../../../include/bits/stdint-uintn.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a> *<dfn class="local col1 decl" id="1Data" title='Data' data-type='const uint8_t *' data-ref="1Data" data-ref-filename="1Data">Data</dfn>, <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col2 decl" id="2Size" title='Size' data-type='size_t' data-ref="2Size" data-ref-filename="2Size">Size</dfn>) {</td></tr>
<tr><th id="15">15</th><td>  <a class="type" href="../../include/llvm/Support/SourceMgr.h.html#llvm::SourceMgr" title='llvm::SourceMgr' data-ref="llvm::SourceMgr" data-ref-filename="llvm..SourceMgr">SourceMgr</a> <a class="ref fn fake" href="../../include/llvm/Support/SourceMgr.h.html#_ZN4llvm9SourceMgrC1Ev" title='llvm::SourceMgr::SourceMgr' data-ref="_ZN4llvm9SourceMgrC1Ev" data-ref-filename="_ZN4llvm9SourceMgrC1Ev"></a><dfn class="local col3 decl" id="3SM" title='SM' data-type='llvm::SourceMgr' data-ref="3SM" data-ref-filename="3SM">SM</dfn>;</td></tr>
<tr><th id="16">16</th><td>  <span class="namespace">yaml::</span><a class="type" href="../../include/llvm/Support/YAMLParser.h.html#llvm::yaml::Stream" title='llvm::yaml::Stream' data-ref="llvm::yaml::Stream" data-ref-filename="llvm..yaml..Stream">Stream</a> <dfn class="local col4 decl" id="4Stream" title='Stream' data-type='yaml::Stream' data-ref="4Stream" data-ref-filename="4Stream">Stream</dfn><a class="ref fn" href="../../include/llvm/Support/YAMLParser.h.html#_ZN4llvm4yaml6StreamC1ENS_9StringRefERNS_9SourceMgrEbPSt10error_code" title='llvm::yaml::Stream::Stream' data-ref="_ZN4llvm4yaml6StreamC1ENS_9StringRefERNS_9SourceMgrEbPSt10error_code" data-ref-filename="_ZN4llvm4yaml6StreamC1ENS_9StringRefERNS_9SourceMgrEbPSt10error_code">(</a><a class="type" href="../../include/llvm/ADT/StringRef.h.html#llvm::StringRef" title='llvm::StringRef' data-ref="llvm::StringRef" data-ref-filename="llvm..StringRef">StringRef</a><a class="ref fn" href="../../include/llvm/ADT/StringRef.h.html#_ZN4llvm9StringRefC1EPKcm" title='llvm::StringRef::StringRef' data-ref="_ZN4llvm9StringRefC1EPKcm" data-ref-filename="_ZN4llvm9StringRefC1EPKcm">(</a><b>reinterpret_cast</b>&lt;<em>const</em> <em>char</em> *&gt;(<a class="local col1 ref" href="#1Data" title='Data' data-ref="1Data" data-ref-filename="1Data">Data</a>), <a class="local col2 ref" href="#2Size" title='Size' data-ref="2Size" data-ref-filename="2Size">Size</a>),</td></tr>
<tr><th id="17">17</th><td>                      <a class="local col3 ref" href="#3SM" title='SM' data-ref="3SM" data-ref-filename="3SM">SM</a>);</td></tr>
<tr><th id="18">18</th><td>  <b>return</b> <a class="local col4 ref" href="#4Stream" title='Stream' data-ref="4Stream" data-ref-filename="4Stream">Stream</a>.<a class="ref fn" href="../../include/llvm/Support/YAMLParser.h.html#_ZN4llvm4yaml6Stream8validateEv" title='llvm::yaml::Stream::validate' data-ref="_ZN4llvm4yaml6Stream8validateEv" data-ref-filename="_ZN4llvm4yaml6Stream8validateEv">validate</a>();</td></tr>
<tr><th id="19">19</th><td>}</td></tr>
<tr><th id="20">20</th><td></td></tr>
<tr><th id="21">21</th><td><b>extern</b> <q>"C"</q> <em>int</em> <dfn class="decl def fn" id="LLVMFuzzerTestOneInput" title='LLVMFuzzerTestOneInput' data-ref="LLVMFuzzerTestOneInput" data-ref-filename="LLVMFuzzerTestOneInput">LLVMFuzzerTestOneInput</dfn>(<em>const</em> <a class="typedef" href="../../../../include/bits/stdint-uintn.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a> *<dfn class="local col5 decl" id="5Data" title='Data' data-type='const uint8_t *' data-ref="5Data" data-ref-filename="5Data">Data</dfn>, <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col6 decl" id="6Size" title='Size' data-type='size_t' data-ref="6Size" data-ref-filename="6Size">Size</dfn>) {</td></tr>
<tr><th id="22">22</th><td>  <span class="namespace">std::</span><span class='type' title='std::vector' data-ref="std::vector" data-ref-filename="std..vector">vector</span>&lt;<a class="typedef" href="../../../../include/bits/stdint-uintn.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>&gt; <dfn class="local col7 decl" id="7Input" title='Input' data-type='std::vector&lt;uint8_t&gt;' data-ref="7Input" data-ref-filename="7Input">Input</dfn><span class='ref fn' title='std::vector::vector&lt;_Tp, _Alloc&gt;' data-ref="_ZNSt6vectorC1ETL0__S0_RKT0_" data-ref-filename="_ZNSt6vectorC1ETL0__S0_RKT0_">(</span><a class="local col5 ref" href="#5Data" title='Data' data-ref="5Data" data-ref-filename="5Data">Data</a>, <a class="local col5 ref" href="#5Data" title='Data' data-ref="5Data" data-ref-filename="5Data">Data</a> + <a class="local col6 ref" href="#6Size" title='Size' data-ref="6Size" data-ref-filename="6Size">Size</a>);</td></tr>
<tr><th id="23">23</th><td></td></tr>
<tr><th id="24">24</th><td>  <i>// Ensure we don't crash on any arbitrary byte string.</i></td></tr>
<tr><th id="25">25</th><td>  <a class="tu ref fn" href="#_ZL11isValidYamlPKhm" title='isValidYaml' data-use='c' data-ref="_ZL11isValidYamlPKhm" data-ref-filename="_ZL11isValidYamlPKhm">isValidYaml</a>(<a class="local col7 ref" href="#7Input" title='Input' data-ref="7Input" data-ref-filename="7Input">Input</a>.<span class='ref fn' title='std::vector::data' data-ref="_ZNSt6vector4dataEv" data-ref-filename="_ZNSt6vector4dataEv">data</span>(), <a class="local col7 ref" href="#7Input" title='Input' data-ref="7Input" data-ref-filename="7Input">Input</a>.<span class='ref fn' title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv" data-ref-filename="_ZNKSt6vector4sizeEv">size</span>());</td></tr>
<tr><th id="26">26</th><td></td></tr>
<tr><th id="27">27</th><td>  <i>// Ensure we don't crash on byte strings with no null characters.</i></td></tr>
<tr><th id="28">28</th><td>  <span class="namespace">llvm::</span><a class="ref fn" href="../../include/llvm/ADT/STLExtras.h.html#_ZN4llvm11erase_valueERT_T0_" title='llvm::erase_value' data-ref="_ZN4llvm11erase_valueERT_T0_" data-ref-filename="_ZN4llvm11erase_valueERT_T0_">erase_value</a>(<span class='refarg'><a class="local col7 ref" href="#7Input" title='Input' data-ref="7Input" data-ref-filename="7Input">Input</a></span>, <var>0</var>);</td></tr>
<tr><th id="29">29</th><td>  <a class="local col7 ref" href="#7Input" title='Input' data-ref="7Input" data-ref-filename="7Input">Input</a>.<span class='ref fn' title='std::vector::shrink_to_fit' data-ref="_ZNSt6vector13shrink_to_fitEv" data-ref-filename="_ZNSt6vector13shrink_to_fitEv">shrink_to_fit</span>();</td></tr>
<tr><th id="30">30</th><td>  <em>bool</em> <dfn class="local col8 decl" id="8IsValidWithout0s" title='IsValidWithout0s' data-type='bool' data-ref="8IsValidWithout0s" data-ref-filename="8IsValidWithout0s">IsValidWithout0s</dfn> = <a class="tu ref fn" href="#_ZL11isValidYamlPKhm" title='isValidYaml' data-use='c' data-ref="_ZL11isValidYamlPKhm" data-ref-filename="_ZL11isValidYamlPKhm">isValidYaml</a>(<a class="local col7 ref" href="#7Input" title='Input' data-ref="7Input" data-ref-filename="7Input">Input</a>.<span class='ref fn' title='std::vector::data' data-ref="_ZNSt6vector4dataEv" data-ref-filename="_ZNSt6vector4dataEv">data</span>(), <a class="local col7 ref" href="#7Input" title='Input' data-ref="7Input" data-ref-filename="7Input">Input</a>.<span class='ref fn' title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv" data-ref-filename="_ZNKSt6vector4sizeEv">size</span>());</td></tr>
<tr><th id="31">31</th><td></td></tr>
<tr><th id="32">32</th><td>  <i>// Ensure we don't crash on byte strings where the only null character is</i></td></tr>
<tr><th id="33">33</th><td><i>  // one-past-the-end of the actual input to the parser.</i></td></tr>
<tr><th id="34">34</th><td>  <a class="local col7 ref" href="#7Input" title='Input' data-ref="7Input" data-ref-filename="7Input">Input</a>.<span class='ref fn' title='std::vector::push_back' data-ref="_ZNSt6vector9push_backEOT_" data-ref-filename="_ZNSt6vector9push_backEOT_">push_back</span>(<var>0</var>);</td></tr>
<tr><th id="35">35</th><td>  <a class="local col7 ref" href="#7Input" title='Input' data-ref="7Input" data-ref-filename="7Input">Input</a>.<span class='ref fn' title='std::vector::shrink_to_fit' data-ref="_ZNSt6vector13shrink_to_fitEv" data-ref-filename="_ZNSt6vector13shrink_to_fitEv">shrink_to_fit</span>();</td></tr>
<tr><th id="36">36</th><td>  <em>bool</em> <dfn class="local col9 decl" id="9IsValidWhen0Terminated" title='IsValidWhen0Terminated' data-type='bool' data-ref="9IsValidWhen0Terminated" data-ref-filename="9IsValidWhen0Terminated">IsValidWhen0Terminated</dfn> = <a class="tu ref fn" href="#_ZL11isValidYamlPKhm" title='isValidYaml' data-use='c' data-ref="_ZL11isValidYamlPKhm" data-ref-filename="_ZL11isValidYamlPKhm">isValidYaml</a>(<a class="local col7 ref" href="#7Input" title='Input' data-ref="7Input" data-ref-filename="7Input">Input</a>.<span class='ref fn' title='std::vector::data' data-ref="_ZNSt6vector4dataEv" data-ref-filename="_ZNSt6vector4dataEv">data</span>(), <a class="local col7 ref" href="#7Input" title='Input' data-ref="7Input" data-ref-filename="7Input">Input</a>.<span class='ref fn' title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv" data-ref-filename="_ZNKSt6vector4sizeEv">size</span>() - <var>1</var>);</td></tr>
<tr><th id="37">37</th><td></td></tr>
<tr><th id="38">38</th><td>  <i>// Ensure we don't crash on byte strings with no null characters, but with</i></td></tr>
<tr><th id="39">39</th><td><i>  // an invalid character one-past-the-end of the actual input to the parser.</i></td></tr>
<tr><th id="40">40</th><td>  <a class="local col7 ref" href="#7Input" title='Input' data-ref="7Input" data-ref-filename="7Input">Input</a>.<span class='ref fn' title='std::vector::back' data-ref="_ZNSt6vector4backEv" data-ref-filename="_ZNSt6vector4backEv">back</span>() = <var>1</var>;</td></tr>
<tr><th id="41">41</th><td>  <em>bool</em> <dfn class="local col0 decl" id="10IsValidWhen1Terminated" title='IsValidWhen1Terminated' data-type='bool' data-ref="10IsValidWhen1Terminated" data-ref-filename="10IsValidWhen1Terminated">IsValidWhen1Terminated</dfn> = <a class="tu ref fn" href="#_ZL11isValidYamlPKhm" title='isValidYaml' data-use='c' data-ref="_ZL11isValidYamlPKhm" data-ref-filename="_ZL11isValidYamlPKhm">isValidYaml</a>(<a class="local col7 ref" href="#7Input" title='Input' data-ref="7Input" data-ref-filename="7Input">Input</a>.<span class='ref fn' title='std::vector::data' data-ref="_ZNSt6vector4dataEv" data-ref-filename="_ZNSt6vector4dataEv">data</span>(), <a class="local col7 ref" href="#7Input" title='Input' data-ref="7Input" data-ref-filename="7Input">Input</a>.<span class='ref fn' title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv" data-ref-filename="_ZNKSt6vector4sizeEv">size</span>() - <var>1</var>);</td></tr>
<tr><th id="42">42</th><td></td></tr>
<tr><th id="43">43</th><td>  <i>// The parser should either accept all of these inputs, or reject all of</i></td></tr>
<tr><th id="44">44</th><td><i>  // them, because the parser sees an identical byte string in each case. This</i></td></tr>
<tr><th id="45">45</th><td><i>  // should hopefully catch some cases where the parser is sensitive to what is</i></td></tr>
<tr><th id="46">46</th><td><i>  // present one-past-the-end of the actual input.</i></td></tr>
<tr><th id="47">47</th><td>  <b>if</b> (<a class="local col8 ref" href="#8IsValidWithout0s" title='IsValidWithout0s' data-ref="8IsValidWithout0s" data-ref-filename="8IsValidWithout0s">IsValidWithout0s</a> != <a class="local col9 ref" href="#9IsValidWhen0Terminated" title='IsValidWhen0Terminated' data-ref="9IsValidWhen0Terminated" data-ref-filename="9IsValidWhen0Terminated">IsValidWhen0Terminated</a> ||</td></tr>
<tr><th id="48">48</th><td>      <a class="local col9 ref" href="#9IsValidWhen0Terminated" title='IsValidWhen0Terminated' data-ref="9IsValidWhen0Terminated" data-ref-filename="9IsValidWhen0Terminated">IsValidWhen0Terminated</a> != <a class="local col0 ref" href="#10IsValidWhen1Terminated" title='IsValidWhen1Terminated' data-ref="10IsValidWhen1Terminated" data-ref-filename="10IsValidWhen1Terminated">IsValidWhen1Terminated</a>)</td></tr>
<tr><th id="49">49</th><td>    <a class="macro" href="../../include/llvm/Support/Compiler.h.html#333" title="__builtin_trap()" data-ref="_M/LLVM_BUILTIN_TRAP">LLVM_BUILTIN_TRAP</a>;</td></tr>
<tr><th id="50">50</th><td></td></tr>
<tr><th id="51">51</th><td>  <b>return</b> <var>0</var>;</td></tr>
<tr><th id="52">52</th><td>}</td></tr>
<tr><th id="53">53</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2021-Jul-01</em> from project llvm revision <em>12</em>