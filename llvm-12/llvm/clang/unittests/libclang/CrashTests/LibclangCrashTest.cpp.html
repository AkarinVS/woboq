<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>LibclangCrashTest.cpp source code [llvm/clang/unittests/libclang/CrashTests/LibclangCrashTest.cpp] - Woboq Code Browser</title>
<link rel="stylesheet" href="../../../../.././data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../../.././data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../../.././data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../.././data/jquery/jquery-ui.min.js"></script>
<script>var file = 'llvm/clang/unittests/libclang/CrashTests/LibclangCrashTest.cpp'; var root_path = '../../../../..'; var data_path = '../../../../.././data'; var ecma_script_api_version = 2;</script>
<script src='../../../../.././data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../..'>llvm</a>/<a href='../../..'>clang</a>/<a href='../..'>unittests</a>/<a href='..'>libclang</a>/<a href='./'>CrashTests</a>/<a href='LibclangCrashTest.cpp.html'>LibclangCrashTest.cpp</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>//===- unittests/libclang/LibclangCrashTest.cpp --- libclang tests --------===//</i></td></tr>
<tr><th id="2">2</th><td><i>//</i></td></tr>
<tr><th id="3">3</th><td><i>// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</i></td></tr>
<tr><th id="4">4</th><td><i>// See <a href="https://llvm.org/LICENSE.txt">https://llvm.org/LICENSE.txt</a> for license information.</i></td></tr>
<tr><th id="5">5</th><td><i>// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</i></td></tr>
<tr><th id="6">6</th><td><i>//</i></td></tr>
<tr><th id="7">7</th><td><i>//===----------------------------------------------------------------------===//</i></td></tr>
<tr><th id="8">8</th><td></td></tr>
<tr><th id="9">9</th><td><u>#include <a href="../TestUtils.h.html">"../TestUtils.h"</a></u></td></tr>
<tr><th id="10">10</th><td><u>#include <a href="../../../include/clang-c/FatalErrorHandler.h.html">"clang-c/FatalErrorHandler.h"</a></u></td></tr>
<tr><th id="11">11</th><td><u>#include <a href="../../../../llvm/utils/unittest/googletest/include/gtest/gtest.h.html">"gtest/gtest.h"</a></u></td></tr>
<tr><th id="12">12</th><td><u>#include &lt;string&gt;</u></td></tr>
<tr><th id="13">13</th><td></td></tr>
<tr><th id="14">14</th><td><a class="macro" href="../../../../llvm/utils/unittest/googletest/include/gtest/gtest.h.html#2216" title="class LibclangParseTest_InstallAbortingLLVMFatalErrorHandler_Test : public LibclangParseTest { public: LibclangParseTest_InstallAbortingLLVMFatalErrorHandler_Test() {} private: virtual void TestBody(); static ::testing::TestInfo* const test_info_ __attribute__ ((unused)); LibclangParseTest_InstallAbortingLLVMFatalErrorHandler_Test(LibclangParseTest_InstallAbortingLLVMFatalErrorHandler_Test const &amp;) = delete; void operator=(LibclangParseTest_InstallAbortingLLVMFatalErrorHandler_Test const &amp;) = delete;};::testing::TestInfo* const LibclangParseTest_InstallAbortingLLVMFatalErrorHandler_Test ::test_info_ = ::testing::internal::MakeAndRegisterTestInfo( &quot;LibclangParseTest&quot;, &quot;InstallAbortingLLVMFatalErrorHandler&quot;, __null, __null, ::testing::internal::CodeLocation(&quot;/fast/tmp/llvm-proj-12/clang/unittests/libclang/CrashTests/LibclangCrashTest.cpp&quot;, 14), (::testing::internal::GetTypeId&lt;LibclangParseTest&gt;()), LibclangParseTest::SetUpTestCase, LibclangParseTest::TearDownTestCase, new ::testing::internal::TestFactoryImpl&lt; LibclangParseTest_InstallAbortingLLVMFatalErrorHandler_Test&gt;);void LibclangParseTest_InstallAbortingLLVMFatalErrorHandler_Test::TestBody()" data-ref="_M/TEST_F">TEST_F</a>(<a class="type" href="../TestUtils.h.html#LibclangParseTest" title='LibclangParseTest' data-ref="LibclangParseTest" data-ref-filename="LibclangParseTest">LibclangParseTest</a>, InstallAbortingLLVMFatalErrorHandler) {</td></tr>
<tr><th id="15">15</th><td>  <a class="ref fn" href="../../../include/clang-c/Index.h.html#clang_toggleCrashRecovery" title='clang_toggleCrashRecovery' data-ref="clang_toggleCrashRecovery" data-ref-filename="clang_toggleCrashRecovery">clang_toggleCrashRecovery</a>(<var>0</var>);</td></tr>
<tr><th id="16">16</th><td>  <a class="ref fn" href="../../../include/clang-c/FatalErrorHandler.h.html#clang_install_aborting_llvm_fatal_error_handler" title='clang_install_aborting_llvm_fatal_error_handler' data-ref="clang_install_aborting_llvm_fatal_error_handler" data-ref-filename="clang_install_aborting_llvm_fatal_error_handler">clang_install_aborting_llvm_fatal_error_handler</a>();</td></tr>
<tr><th id="17">17</th><td></td></tr>
<tr><th id="18">18</th><td>  <span class="namespace">std::</span><span class='typedef' title='std::string' data-type='basic_string&lt;char&gt;' data-ref="std::string" data-ref-filename="std..string">string</span> <dfn class="local col8 decl" id="18Main" title='Main' data-type='std::string' data-ref="18Main" data-ref-filename="18Main">Main</dfn> = <span class='ref fn fake' title='std::__cxx11::basic_string::basic_string&lt;_CharT, _Traits, _Alloc&gt;' data-ref="_ZNSt7__cxx1112basic_stringC1EPKT_RKT1_" data-ref-filename="_ZNSt7__cxx1112basic_stringC1EPKT_RKT1_"></span><q>"main.h"</q>;</td></tr>
<tr><th id="19">19</th><td>  <a class="member fn" href="../TestUtils.h.html#_ZN17LibclangParseTest9WriteFileERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEERKS5_" title='LibclangParseTest::WriteFile' data-ref="_ZN17LibclangParseTest9WriteFileERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEERKS5_" data-ref-filename="_ZN17LibclangParseTest9WriteFileERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEERKS5_">WriteFile</a>(<span class='refarg'><a class="local col8 ref" href="#18Main" title='Main' data-ref="18Main" data-ref-filename="18Main">Main</a></span>, <span class='ref fn fake' title='std::__cxx11::basic_string::basic_string&lt;_CharT, _Traits, _Alloc&gt;' data-ref="_ZNSt7__cxx1112basic_stringC1EPKT_RKT1_" data-ref-filename="_ZNSt7__cxx1112basic_stringC1EPKT_RKT1_"></span><q>"#pragma clang __debug llvm_fatal_error"</q>);</td></tr>
<tr><th id="20">20</th><td></td></tr>
<tr><th id="21">21</th><td>  <a class="macro" href="../../../../llvm/utils/unittest/googletest/include/gtest/gtest-death-test.h.html#184" title="switch (0) case 0: default: if (::testing::internal::AlwaysTrue()) { const ::testing::internal::RE&amp; gtest_regex = (&quot;&quot;); ::testing::internal::DeathTest* gtest_dt; if (!::testing::internal::DeathTest::Create(&quot;clang_parseTranslationUnit(Index, Main.c_str(), nullptr, 0, nullptr, 0, TUFlags)&quot;, &amp;gtest_regex, &quot;/fast/tmp/llvm-proj-12/clang/unittests/libclang/CrashTests/LibclangCrashTest.cpp&quot;, 23, &amp;gtest_dt)) { goto gtest_label_23; } if (gtest_dt != __null) { ::testing::internal::scoped_ptr&lt; ::testing::internal::DeathTest&gt; gtest_dt_ptr(gtest_dt); switch (gtest_dt-&gt;AssumeRole()) { case ::testing::internal::DeathTest::OVERSEE_TEST: if (!gtest_dt-&gt;Passed(::testing::internal::ExitedUnsuccessfully(gtest_dt-&gt;Wait()))) { goto gtest_label_23; } break; case ::testing::internal::DeathTest::EXECUTE_TEST: { ::testing::internal::DeathTest::ReturnSentinel gtest_sentinel(gtest_dt); if (::testing::internal::AlwaysTrue()) { clang_parseTranslationUnit(Index, Main.c_str(), nullptr, 0, nullptr, 0, TUFlags); }; gtest_dt-&gt;Abort(::testing::internal::DeathTest::TEST_DID_NOT_DIE); break; } } } } else gtest_label_23: ::testing::internal::AssertHelper(::testing::TestPartResult::kNonFatalFailure, &quot;/fast/tmp/llvm-proj-12/clang/unittests/libclang/CrashTests/LibclangCrashTest.cpp&quot;, 23, ::testing::internal::DeathTest::LastMessage()) = ::testing::Message()" data-ref="_M/EXPECT_DEATH">EXPECT_DEATH</a>(<a class="ref fn" href="../../../include/clang-c/Index.h.html#clang_parseTranslationUnit" title='clang_parseTranslationUnit' data-ref="clang_parseTranslationUnit" data-ref-filename="clang_parseTranslationUnit">clang_parseTranslationUnit</a>(<a class="member field" href="../TestUtils.h.html#LibclangParseTest::Index" title='LibclangParseTest::Index' data-ref="LibclangParseTest::Index" data-ref-filename="LibclangParseTest..Index">Index</a>, <a class="local col8 ref" href="#18Main" title='Main' data-ref="18Main" data-ref-filename="18Main">Main</a>.<span class='ref fn' title='std::__cxx11::basic_string::c_str' data-ref="_ZNKSt7__cxx1112basic_string5c_strEv" data-ref-filename="_ZNKSt7__cxx1112basic_string5c_strEv">c_str</span>(), <b>nullptr</b>, <var>0</var>,</td></tr>
<tr><th id="22">22</th><td>                                          <b>nullptr</b>, <var>0</var>, <a class="member field" href="../TestUtils.h.html#LibclangParseTest::TUFlags" title='LibclangParseTest::TUFlags' data-ref="LibclangParseTest::TUFlags" data-ref-filename="LibclangParseTest..TUFlags">TUFlags</a>),</td></tr>
<tr><th id="23">23</th><td>               <q>""</q>);</td></tr>
<tr><th id="24">24</th><td>}</td></tr>
<tr><th id="25">25</th><td></td></tr>
<tr><th id="26">26</th><td><a class="macro" href="../../../../llvm/utils/unittest/googletest/include/gtest/gtest.h.html#2216" title="class LibclangParseTest_UninstallAbortingLLVMFatalErrorHandler_Test : public LibclangParseTest { public: LibclangParseTest_UninstallAbortingLLVMFatalErrorHandler_Test() {} private: virtual void TestBody(); static ::testing::TestInfo* const test_info_ __attribute__ ((unused)); LibclangParseTest_UninstallAbortingLLVMFatalErrorHandler_Test(LibclangParseTest_UninstallAbortingLLVMFatalErrorHandler_Test const &amp;) = delete; void operator=(LibclangParseTest_UninstallAbortingLLVMFatalErrorHandler_Test const &amp;) = delete;};::testing::TestInfo* const LibclangParseTest_UninstallAbortingLLVMFatalErrorHandler_Test ::test_info_ = ::testing::internal::MakeAndRegisterTestInfo( &quot;LibclangParseTest&quot;, &quot;UninstallAbortingLLVMFatalErrorHandler&quot;, __null, __null, ::testing::internal::CodeLocation(&quot;/fast/tmp/llvm-proj-12/clang/unittests/libclang/CrashTests/LibclangCrashTest.cpp&quot;, 26), (::testing::internal::GetTypeId&lt;LibclangParseTest&gt;()), LibclangParseTest::SetUpTestCase, LibclangParseTest::TearDownTestCase, new ::testing::internal::TestFactoryImpl&lt; LibclangParseTest_UninstallAbortingLLVMFatalErrorHandler_Test&gt;);void LibclangParseTest_UninstallAbortingLLVMFatalErrorHandler_Test::TestBody()" data-ref="_M/TEST_F">TEST_F</a>(<a class="type" href="../TestUtils.h.html#LibclangParseTest" title='LibclangParseTest' data-ref="LibclangParseTest" data-ref-filename="LibclangParseTest">LibclangParseTest</a>, UninstallAbortingLLVMFatalErrorHandler) {</td></tr>
<tr><th id="27">27</th><td>  <a class="ref fn" href="../../../include/clang-c/Index.h.html#clang_toggleCrashRecovery" title='clang_toggleCrashRecovery' data-ref="clang_toggleCrashRecovery" data-ref-filename="clang_toggleCrashRecovery">clang_toggleCrashRecovery</a>(<var>0</var>);</td></tr>
<tr><th id="28">28</th><td>  <a class="ref fn" href="../../../include/clang-c/FatalErrorHandler.h.html#clang_install_aborting_llvm_fatal_error_handler" title='clang_install_aborting_llvm_fatal_error_handler' data-ref="clang_install_aborting_llvm_fatal_error_handler" data-ref-filename="clang_install_aborting_llvm_fatal_error_handler">clang_install_aborting_llvm_fatal_error_handler</a>();</td></tr>
<tr><th id="29">29</th><td>  <a class="ref fn" href="../../../include/clang-c/FatalErrorHandler.h.html#clang_uninstall_llvm_fatal_error_handler" title='clang_uninstall_llvm_fatal_error_handler' data-ref="clang_uninstall_llvm_fatal_error_handler" data-ref-filename="clang_uninstall_llvm_fatal_error_handler">clang_uninstall_llvm_fatal_error_handler</a>();</td></tr>
<tr><th id="30">30</th><td></td></tr>
<tr><th id="31">31</th><td>  <span class="namespace">std::</span><span class='typedef' title='std::string' data-type='basic_string&lt;char&gt;' data-ref="std::string" data-ref-filename="std..string">string</span> <dfn class="local col9 decl" id="19Main" title='Main' data-type='std::string' data-ref="19Main" data-ref-filename="19Main">Main</dfn> = <span class='ref fn fake' title='std::__cxx11::basic_string::basic_string&lt;_CharT, _Traits, _Alloc&gt;' data-ref="_ZNSt7__cxx1112basic_stringC1EPKT_RKT1_" data-ref-filename="_ZNSt7__cxx1112basic_stringC1EPKT_RKT1_"></span><q>"main.h"</q>;</td></tr>
<tr><th id="32">32</th><td>  <a class="member fn" href="../TestUtils.h.html#_ZN17LibclangParseTest9WriteFileERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEERKS5_" title='LibclangParseTest::WriteFile' data-ref="_ZN17LibclangParseTest9WriteFileERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEERKS5_" data-ref-filename="_ZN17LibclangParseTest9WriteFileERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEERKS5_">WriteFile</a>(<span class='refarg'><a class="local col9 ref" href="#19Main" title='Main' data-ref="19Main" data-ref-filename="19Main">Main</a></span>, <span class='ref fn fake' title='std::__cxx11::basic_string::basic_string&lt;_CharT, _Traits, _Alloc&gt;' data-ref="_ZNSt7__cxx1112basic_stringC1EPKT_RKT1_" data-ref-filename="_ZNSt7__cxx1112basic_stringC1EPKT_RKT1_"></span><q>"#pragma clang __debug llvm_fatal_error"</q>);</td></tr>
<tr><th id="33">33</th><td></td></tr>
<tr><th id="34">34</th><td>  <a class="macro" href="../../../../llvm/utils/unittest/googletest/include/gtest/gtest-death-test.h.html#184" title="switch (0) case 0: default: if (::testing::internal::AlwaysTrue()) { const ::testing::internal::RE&amp; gtest_regex = (&quot;ERROR&quot;); ::testing::internal::DeathTest* gtest_dt; if (!::testing::internal::DeathTest::Create(&quot;clang_parseTranslationUnit(Index, Main.c_str(), nullptr, 0, nullptr, 0, TUFlags)&quot;, &amp;gtest_regex, &quot;/fast/tmp/llvm-proj-12/clang/unittests/libclang/CrashTests/LibclangCrashTest.cpp&quot;, 36, &amp;gtest_dt)) { goto gtest_label_36; } if (gtest_dt != __null) { ::testing::internal::scoped_ptr&lt; ::testing::internal::DeathTest&gt; gtest_dt_ptr(gtest_dt); switch (gtest_dt-&gt;AssumeRole()) { case ::testing::internal::DeathTest::OVERSEE_TEST: if (!gtest_dt-&gt;Passed(::testing::internal::ExitedUnsuccessfully(gtest_dt-&gt;Wait()))) { goto gtest_label_36; } break; case ::testing::internal::DeathTest::EXECUTE_TEST: { ::testing::internal::DeathTest::ReturnSentinel gtest_sentinel(gtest_dt); if (::testing::internal::AlwaysTrue()) { clang_parseTranslationUnit(Index, Main.c_str(), nullptr, 0, nullptr, 0, TUFlags); }; gtest_dt-&gt;Abort(::testing::internal::DeathTest::TEST_DID_NOT_DIE); break; } } } } else gtest_label_36: ::testing::internal::AssertHelper(::testing::TestPartResult::kNonFatalFailure, &quot;/fast/tmp/llvm-proj-12/clang/unittests/libclang/CrashTests/LibclangCrashTest.cpp&quot;, 36, ::testing::internal::DeathTest::LastMessage()) = ::testing::Message()" data-ref="_M/EXPECT_DEATH">EXPECT_DEATH</a>(<a class="ref fn" href="../../../include/clang-c/Index.h.html#clang_parseTranslationUnit" title='clang_parseTranslationUnit' data-ref="clang_parseTranslationUnit" data-ref-filename="clang_parseTranslationUnit">clang_parseTranslationUnit</a>(<a class="member field" href="../TestUtils.h.html#LibclangParseTest::Index" title='LibclangParseTest::Index' data-ref="LibclangParseTest::Index" data-ref-filename="LibclangParseTest..Index">Index</a>, <a class="local col9 ref" href="#19Main" title='Main' data-ref="19Main" data-ref-filename="19Main">Main</a>.<span class='ref fn' title='std::__cxx11::basic_string::c_str' data-ref="_ZNKSt7__cxx1112basic_string5c_strEv" data-ref-filename="_ZNKSt7__cxx1112basic_string5c_strEv">c_str</span>(), <b>nullptr</b>, <var>0</var>,</td></tr>
<tr><th id="35">35</th><td>                                          <b>nullptr</b>, <var>0</var>, <a class="member field" href="../TestUtils.h.html#LibclangParseTest::TUFlags" title='LibclangParseTest::TUFlags' data-ref="LibclangParseTest::TUFlags" data-ref-filename="LibclangParseTest..TUFlags">TUFlags</a>),</td></tr>
<tr><th id="36">36</th><td>               <q>"ERROR"</q>);</td></tr>
<tr><th id="37">37</th><td>}</td></tr>
<tr><th id="38">38</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2021-Jul-01</em> from project llvm revision <em>12</em>