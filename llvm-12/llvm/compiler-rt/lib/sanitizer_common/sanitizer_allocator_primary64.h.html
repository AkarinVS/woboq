<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>sanitizer_allocator_primary64.h source code [llvm/compiler-rt/lib/sanitizer_common/sanitizer_allocator_primary64.h] - Woboq Code Browser</title>
<meta name="woboq:interestingDefinitions" content="__sanitizer::SizeClassAllocator64,__sanitizer::SizeClassAllocator64FlagMasks "/>
<link rel="stylesheet" href="../../../.././data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../.././data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../.././data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../.././data/jquery/jquery-ui.min.js"></script>
<script>var file = 'llvm/compiler-rt/lib/sanitizer_common/sanitizer_allocator_primary64.h'; var root_path = '../../../..'; var data_path = '../../../.././data'; var ecma_script_api_version = 2;</script>
<script src='../../../.././data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../..'>llvm</a>/<a href='../..'>compiler-rt</a>/<a href='..'>lib</a>/<a href='./'>sanitizer_common</a>/<a href='sanitizer_allocator_primary64.h.html'>sanitizer_allocator_primary64.h</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>//===-- sanitizer_allocator_primary64.h -------------------------*- C++ -*-===//</i></td></tr>
<tr><th id="2">2</th><td><i>//</i></td></tr>
<tr><th id="3">3</th><td><i>// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</i></td></tr>
<tr><th id="4">4</th><td><i>// See <a href="https://llvm.org/LICENSE.txt">https://llvm.org/LICENSE.txt</a> for license information.</i></td></tr>
<tr><th id="5">5</th><td><i>// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</i></td></tr>
<tr><th id="6">6</th><td><i>//</i></td></tr>
<tr><th id="7">7</th><td><i>//===----------------------------------------------------------------------===//</i></td></tr>
<tr><th id="8">8</th><td><i>//</i></td></tr>
<tr><th id="9">9</th><td><i>// Part of the Sanitizer Allocator.</i></td></tr>
<tr><th id="10">10</th><td><i>//</i></td></tr>
<tr><th id="11">11</th><td><i>//===----------------------------------------------------------------------===//</i></td></tr>
<tr><th id="12">12</th><td><u>#<span data-ppcond="12">ifndef</span> <a class="macro" href="sanitizer_allocator.h.html#14" data-ref="_M/SANITIZER_ALLOCATOR_H">SANITIZER_ALLOCATOR_H</a></u></td></tr>
<tr><th id="13">13</th><td><u>#error This file must be included inside sanitizer_allocator.h</u></td></tr>
<tr><th id="14">14</th><td><u>#<span data-ppcond="12">endif</span></u></td></tr>
<tr><th id="15">15</th><td></td></tr>
<tr><th id="16">16</th><td><b>template</b>&lt;<b>class</b> SizeClassAllocator&gt; <b>struct</b> <a class="type" href="sanitizer_allocator_local_cache.h.html#__sanitizer::SizeClassAllocator64LocalCache" title='__sanitizer::SizeClassAllocator64LocalCache' data-ref="__sanitizer::SizeClassAllocator64LocalCache" data-ref-filename="__sanitizer..SizeClassAllocator64LocalCache" id="__sanitizer::SizeClassAllocator64LocalCache">SizeClassAllocator64LocalCache</a>;</td></tr>
<tr><th id="17">17</th><td></td></tr>
<tr><th id="18">18</th><td><i>// SizeClassAllocator64 -- allocator for 64-bit address space.</i></td></tr>
<tr><th id="19">19</th><td><i>// The template parameter Params is a class containing the actual parameters.</i></td></tr>
<tr><th id="20">20</th><td><i>//</i></td></tr>
<tr><th id="21">21</th><td><i>// Space: a portion of address space of kSpaceSize bytes starting at SpaceBeg.</i></td></tr>
<tr><th id="22">22</th><td><i>// If kSpaceBeg is ~0 then SpaceBeg is chosen dynamically my mmap.</i></td></tr>
<tr><th id="23">23</th><td><i>// Otherwise SpaceBeg=kSpaceBeg (fixed address).</i></td></tr>
<tr><th id="24">24</th><td><i>// kSpaceSize is a power of two.</i></td></tr>
<tr><th id="25">25</th><td><i>// At the beginning the entire space is mprotect-ed, then small parts of it</i></td></tr>
<tr><th id="26">26</th><td><i>// are mapped on demand.</i></td></tr>
<tr><th id="27">27</th><td><i>//</i></td></tr>
<tr><th id="28">28</th><td><i>// Region: a part of Space dedicated to a single size class.</i></td></tr>
<tr><th id="29">29</th><td><i>// There are kNumClasses Regions of equal size.</i></td></tr>
<tr><th id="30">30</th><td><i>//</i></td></tr>
<tr><th id="31">31</th><td><i>// UserChunk: a piece of memory returned to user.</i></td></tr>
<tr><th id="32">32</th><td><i>// MetaChunk: kMetadataSize bytes of metadata associated with a UserChunk.</i></td></tr>
<tr><th id="33">33</th><td><i></i></td></tr>
<tr><th id="34">34</th><td><i>// FreeArray is an array free-d chunks (stored as 4-byte offsets)</i></td></tr>
<tr><th id="35">35</th><td><i>//</i></td></tr>
<tr><th id="36">36</th><td><i>// A Region looks like this:</i></td></tr>
<tr><th id="37">37</th><td><i>// UserChunk1 ... UserChunkN &lt;gap&gt; MetaChunkN ... MetaChunk1 FreeArray</i></td></tr>
<tr><th id="38">38</th><td></td></tr>
<tr><th id="39">39</th><td><b>struct</b> <dfn class="type def" id="__sanitizer::SizeClassAllocator64FlagMasks" title='__sanitizer::SizeClassAllocator64FlagMasks' data-ref="__sanitizer::SizeClassAllocator64FlagMasks" data-ref-filename="__sanitizer..SizeClassAllocator64FlagMasks">SizeClassAllocator64FlagMasks</dfn> {  <i>//  Bit masks.</i></td></tr>
<tr><th id="40">40</th><td>  <b>enum</b> {</td></tr>
<tr><th id="41">41</th><td>    <dfn class="enum" id="__sanitizer::SizeClassAllocator64FlagMasks::kRandomShuffleChunks" title='__sanitizer::SizeClassAllocator64FlagMasks::kRandomShuffleChunks' data-ref="__sanitizer::SizeClassAllocator64FlagMasks::kRandomShuffleChunks" data-ref-filename="__sanitizer..SizeClassAllocator64FlagMasks..kRandomShuffleChunks">kRandomShuffleChunks</dfn> = <var>1</var>,</td></tr>
<tr><th id="42">42</th><td>  };</td></tr>
<tr><th id="43">43</th><td>};</td></tr>
<tr><th id="44">44</th><td></td></tr>
<tr><th id="45">45</th><td><b>template</b> &lt;<b>class</b> Params&gt;</td></tr>
<tr><th id="46">46</th><td><b>class</b> <dfn class="type def" id="__sanitizer::SizeClassAllocator64" title='__sanitizer::SizeClassAllocator64' data-ref="__sanitizer::SizeClassAllocator64" data-ref-filename="__sanitizer..SizeClassAllocator64">SizeClassAllocator64</dfn> {</td></tr>
<tr><th id="47">47</th><td> <b>public</b>:</td></tr>
<tr><th id="48">48</th><td>  <b>using</b> <dfn class="typedef" id="__sanitizer::SizeClassAllocator64::AddressSpaceView" title='__sanitizer::SizeClassAllocator64::AddressSpaceView' data-type='typename Params::AddressSpaceView' data-ref="__sanitizer::SizeClassAllocator64::AddressSpaceView" data-ref-filename="__sanitizer..SizeClassAllocator64..AddressSpaceView">AddressSpaceView</dfn> = <b>typename</b> Params::AddressSpaceView;</td></tr>
<tr><th id="49">49</th><td>  <em>static</em> <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl" id="__sanitizer::SizeClassAllocator64::kSpaceBeg" title='__sanitizer::SizeClassAllocator64::kSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::kSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..kSpaceBeg">kSpaceBeg</dfn> = Params::kSpaceBeg;</td></tr>
<tr><th id="50">50</th><td>  <em>static</em> <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl" id="__sanitizer::SizeClassAllocator64::kSpaceSize" title='__sanitizer::SizeClassAllocator64::kSpaceSize' data-ref="__sanitizer::SizeClassAllocator64::kSpaceSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kSpaceSize">kSpaceSize</dfn> = Params::kSpaceSize;</td></tr>
<tr><th id="51">51</th><td>  <em>static</em> <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl" id="__sanitizer::SizeClassAllocator64::kMetadataSize" title='__sanitizer::SizeClassAllocator64::kMetadataSize' data-ref="__sanitizer::SizeClassAllocator64::kMetadataSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kMetadataSize">kMetadataSize</dfn> = Params::kMetadataSize;</td></tr>
<tr><th id="52">52</th><td>  <b>typedef</b> <b>typename</b> Params::SizeClassMap <dfn class="typedef" id="__sanitizer::SizeClassAllocator64::SizeClassMap" title='__sanitizer::SizeClassAllocator64::SizeClassMap' data-type='typename Params::SizeClassMap' data-ref="__sanitizer::SizeClassAllocator64::SizeClassMap" data-ref-filename="__sanitizer..SizeClassAllocator64..SizeClassMap">SizeClassMap</dfn>;</td></tr>
<tr><th id="53">53</th><td>  <b>typedef</b> <b>typename</b> Params::MapUnmapCallback <dfn class="typedef" id="__sanitizer::SizeClassAllocator64::MapUnmapCallback" title='__sanitizer::SizeClassAllocator64::MapUnmapCallback' data-type='typename Params::MapUnmapCallback' data-ref="__sanitizer::SizeClassAllocator64::MapUnmapCallback" data-ref-filename="__sanitizer..SizeClassAllocator64..MapUnmapCallback">MapUnmapCallback</dfn>;</td></tr>
<tr><th id="54">54</th><td></td></tr>
<tr><th id="55">55</th><td>  <em>static</em> <em>const</em> <em>bool</em> <dfn class="decl" id="__sanitizer::SizeClassAllocator64::kRandomShuffleChunks" title='__sanitizer::SizeClassAllocator64::kRandomShuffleChunks' data-ref="__sanitizer::SizeClassAllocator64::kRandomShuffleChunks" data-ref-filename="__sanitizer..SizeClassAllocator64..kRandomShuffleChunks">kRandomShuffleChunks</dfn> =</td></tr>
<tr><th id="56">56</th><td>      Params::kFlags &amp; <a class="type" href="#__sanitizer::SizeClassAllocator64FlagMasks" title='__sanitizer::SizeClassAllocator64FlagMasks' data-ref="__sanitizer::SizeClassAllocator64FlagMasks" data-ref-filename="__sanitizer..SizeClassAllocator64FlagMasks">SizeClassAllocator64FlagMasks</a>::<a class="enum" href="#__sanitizer::SizeClassAllocator64FlagMasks::kRandomShuffleChunks" title='__sanitizer::SizeClassAllocator64FlagMasks::kRandomShuffleChunks' data-ref="__sanitizer::SizeClassAllocator64FlagMasks::kRandomShuffleChunks" data-ref-filename="__sanitizer..SizeClassAllocator64FlagMasks..kRandomShuffleChunks">kRandomShuffleChunks</a>;</td></tr>
<tr><th id="57">57</th><td></td></tr>
<tr><th id="58">58</th><td>  <b>typedef</b> <a class="type" href="#__sanitizer::SizeClassAllocator64" title='__sanitizer::SizeClassAllocator64' data-ref="__sanitizer::SizeClassAllocator64" data-ref-filename="__sanitizer..SizeClassAllocator64">SizeClassAllocator64</a>&lt;Params&gt; <dfn class="typedef" id="__sanitizer::SizeClassAllocator64::ThisT" title='__sanitizer::SizeClassAllocator64::ThisT' data-type='SizeClassAllocator64&lt;Params&gt;' data-ref="__sanitizer::SizeClassAllocator64::ThisT" data-ref-filename="__sanitizer..SizeClassAllocator64..ThisT">ThisT</dfn>;</td></tr>
<tr><th id="59">59</th><td>  <b>typedef</b> <a class="type" href="#__sanitizer::SizeClassAllocator64LocalCache" title='__sanitizer::SizeClassAllocator64LocalCache' data-ref="__sanitizer::SizeClassAllocator64LocalCache" data-ref-filename="__sanitizer..SizeClassAllocator64LocalCache">SizeClassAllocator64LocalCache</a>&lt;<a class="typedef" href="#__sanitizer::SizeClassAllocator64::ThisT" title='__sanitizer::SizeClassAllocator64::ThisT' data-type='SizeClassAllocator64&lt;Params&gt;' data-ref="__sanitizer::SizeClassAllocator64::ThisT" data-ref-filename="__sanitizer..SizeClassAllocator64..ThisT">ThisT</a>&gt; <dfn class="typedef" id="__sanitizer::SizeClassAllocator64::AllocatorCache" title='__sanitizer::SizeClassAllocator64::AllocatorCache' data-type='SizeClassAllocator64LocalCache&lt;__sanitizer::SizeClassAllocator64::ThisT&gt;' data-ref="__sanitizer::SizeClassAllocator64::AllocatorCache" data-ref-filename="__sanitizer..SizeClassAllocator64..AllocatorCache">AllocatorCache</dfn>;</td></tr>
<tr><th id="60">60</th><td></td></tr>
<tr><th id="61">61</th><td>  <i>// When we know the size class (the region base) we can represent a pointer</i></td></tr>
<tr><th id="62">62</th><td><i>  // as a 4-byte integer (offset from the region start shifted right by 4).</i></td></tr>
<tr><th id="63">63</th><td>  <b>typedef</b> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::u32" title='__sanitizer::u32' data-type='unsigned int' data-ref="__sanitizer::u32" data-ref-filename="__sanitizer..u32">u32</a> <dfn class="typedef" id="__sanitizer::SizeClassAllocator64::CompactPtrT" title='__sanitizer::SizeClassAllocator64::CompactPtrT' data-type='__sanitizer::u32' data-ref="__sanitizer::SizeClassAllocator64::CompactPtrT" data-ref-filename="__sanitizer..SizeClassAllocator64..CompactPtrT">CompactPtrT</dfn>;</td></tr>
<tr><th id="64">64</th><td>  <em>static</em> <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl" id="__sanitizer::SizeClassAllocator64::kCompactPtrScale" title='__sanitizer::SizeClassAllocator64::kCompactPtrScale' data-ref="__sanitizer::SizeClassAllocator64::kCompactPtrScale" data-ref-filename="__sanitizer..SizeClassAllocator64..kCompactPtrScale">kCompactPtrScale</dfn> = <var>4</var>;</td></tr>
<tr><th id="65">65</th><td>  <a class="typedef" href="#__sanitizer::SizeClassAllocator64::CompactPtrT" title='__sanitizer::SizeClassAllocator64::CompactPtrT' data-type='__sanitizer::u32' data-ref="__sanitizer::SizeClassAllocator64::CompactPtrT" data-ref-filename="__sanitizer..SizeClassAllocator64..CompactPtrT">CompactPtrT</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::PointerToCompactPtr" title='__sanitizer::SizeClassAllocator64::PointerToCompactPtr' data-ref="__sanitizer::SizeClassAllocator64::PointerToCompactPtr" data-ref-filename="__sanitizer..SizeClassAllocator64..PointerToCompactPtr">PointerToCompactPtr</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col7 decl" id="1007base" title='base' data-type='__sanitizer::uptr' data-ref="1007base" data-ref-filename="1007base">base</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col8 decl" id="1008ptr" title='ptr' data-type='__sanitizer::uptr' data-ref="1008ptr" data-ref-filename="1008ptr">ptr</dfn>) <em>const</em> {</td></tr>
<tr><th id="66">66</th><td>    <b>return</b> <b>static_cast</b>&lt;<a class="typedef" href="#__sanitizer::SizeClassAllocator64::CompactPtrT" title='__sanitizer::SizeClassAllocator64::CompactPtrT' data-type='__sanitizer::u32' data-ref="__sanitizer::SizeClassAllocator64::CompactPtrT" data-ref-filename="__sanitizer..SizeClassAllocator64..CompactPtrT">CompactPtrT</a>&gt;((<a class="local col8 ref" href="#1008ptr" title='ptr' data-ref="1008ptr" data-ref-filename="1008ptr">ptr</a> - <a class="local col7 ref" href="#1007base" title='base' data-ref="1007base" data-ref-filename="1007base">base</a>) &gt;&gt; <a class="member" href="#__sanitizer::SizeClassAllocator64::kCompactPtrScale" title='__sanitizer::SizeClassAllocator64::kCompactPtrScale' data-ref="__sanitizer::SizeClassAllocator64::kCompactPtrScale" data-ref-filename="__sanitizer..SizeClassAllocator64..kCompactPtrScale">kCompactPtrScale</a>);</td></tr>
<tr><th id="67">67</th><td>  }</td></tr>
<tr><th id="68">68</th><td>  <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::CompactPtrToPointer" title='__sanitizer::SizeClassAllocator64::CompactPtrToPointer' data-ref="__sanitizer::SizeClassAllocator64::CompactPtrToPointer" data-ref-filename="__sanitizer..SizeClassAllocator64..CompactPtrToPointer">CompactPtrToPointer</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col9 decl" id="1009base" title='base' data-type='__sanitizer::uptr' data-ref="1009base" data-ref-filename="1009base">base</dfn>, <a class="typedef" href="#__sanitizer::SizeClassAllocator64::CompactPtrT" title='__sanitizer::SizeClassAllocator64::CompactPtrT' data-type='__sanitizer::u32' data-ref="__sanitizer::SizeClassAllocator64::CompactPtrT" data-ref-filename="__sanitizer..SizeClassAllocator64..CompactPtrT">CompactPtrT</a> <dfn class="local col0 decl" id="1010ptr32" title='ptr32' data-type='__sanitizer::SizeClassAllocator64::CompactPtrT' data-ref="1010ptr32" data-ref-filename="1010ptr32">ptr32</dfn>) <em>const</em> {</td></tr>
<tr><th id="69">69</th><td>    <b>return</b> <a class="local col9 ref" href="#1009base" title='base' data-ref="1009base" data-ref-filename="1009base">base</a> + (<b>static_cast</b>&lt;<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a>&gt;(<a class="local col0 ref" href="#1010ptr32" title='ptr32' data-ref="1010ptr32" data-ref-filename="1010ptr32">ptr32</a>) &lt;&lt; <a class="member" href="#__sanitizer::SizeClassAllocator64::kCompactPtrScale" title='__sanitizer::SizeClassAllocator64::kCompactPtrScale' data-ref="__sanitizer::SizeClassAllocator64::kCompactPtrScale" data-ref-filename="__sanitizer..SizeClassAllocator64..kCompactPtrScale">kCompactPtrScale</a>);</td></tr>
<tr><th id="70">70</th><td>  }</td></tr>
<tr><th id="71">71</th><td></td></tr>
<tr><th id="72">72</th><td>  <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::Init" title='__sanitizer::SizeClassAllocator64::Init' data-ref="__sanitizer::SizeClassAllocator64::Init" data-ref-filename="__sanitizer..SizeClassAllocator64..Init">Init</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::s32" title='__sanitizer::s32' data-type='int' data-ref="__sanitizer::s32" data-ref-filename="__sanitizer..s32">s32</a> <dfn class="local col1 decl" id="1011release_to_os_interval_ms" title='release_to_os_interval_ms' data-type='__sanitizer::s32' data-ref="1011release_to_os_interval_ms" data-ref-filename="1011release_to_os_interval_ms">release_to_os_interval_ms</dfn>) {</td></tr>
<tr><th id="73">73</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col2 decl" id="1012TotalSpaceSize" title='TotalSpaceSize' data-type='__sanitizer::uptr' data-ref="1012TotalSpaceSize" data-ref-filename="1012TotalSpaceSize">TotalSpaceSize</dfn> = <a class="member" href="#__sanitizer::SizeClassAllocator64::kSpaceSize" title='__sanitizer::SizeClassAllocator64::kSpaceSize' data-ref="__sanitizer::SizeClassAllocator64::kSpaceSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kSpaceSize">kSpaceSize</a> + <a class="member fn" href="#__sanitizer::SizeClassAllocator64::AdditionalSize" title='__sanitizer::SizeClassAllocator64::AdditionalSize' data-ref="__sanitizer::SizeClassAllocator64::AdditionalSize" data-ref-filename="__sanitizer..SizeClassAllocator64..AdditionalSize">AdditionalSize</a>();</td></tr>
<tr><th id="74">74</th><td>    <b>if</b> (<a class="member" href="#__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg" title='__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..kUsingConstantSpaceBeg">kUsingConstantSpaceBeg</a>) {</td></tr>
<tr><th id="75">75</th><td>      <a class="macro" href="sanitizer_internal_defs.h.html#299" title="do { __sanitizer::u64 v1 = (__sanitizer::u64)((IsAligned(kSpaceBeg, SizeClassMap::kMaxSize))); __sanitizer::u64 v2 = (__sanitizer::u64)(0); if (__builtin_expect(!!(!(v1 != v2)), 0)) __sanitizer::CheckFailed(&quot;/fast/tmp/llvm-proj-12/compiler-rt/lib/asan/../sanitizer_common/sanitizer_allocator_primary64.h&quot;, 75, &quot;(&quot; &quot;(IsAligned(kSpaceBeg, SizeClassMap::kMaxSize))&quot; &quot;) &quot; &quot;!=&quot; &quot; (&quot; &quot;0&quot; &quot;)&quot;, v1, v2); } while (false)" data-ref="_M/CHECK">CHECK</a>(IsAligned(<a class="member" href="#__sanitizer::SizeClassAllocator64::kSpaceBeg" title='__sanitizer::SizeClassAllocator64::kSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::kSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..kSpaceBeg">kSpaceBeg</a>, <a class="typedef" href="#__sanitizer::SizeClassAllocator64::SizeClassMap" title='__sanitizer::SizeClassAllocator64::SizeClassMap' data-type='typename Params::SizeClassMap' data-ref="__sanitizer::SizeClassAllocator64::SizeClassMap" data-ref-filename="__sanitizer..SizeClassAllocator64..SizeClassMap">SizeClassMap</a>::kMaxSize));</td></tr>
<tr><th id="76">76</th><td>      <a class="macro" href="sanitizer_internal_defs.h.html#300" title="do { __sanitizer::u64 v1 = (__sanitizer::u64)((kSpaceBeg)); __sanitizer::u64 v2 = (__sanitizer::u64)((address_range.Init(TotalSpaceSize, PrimaryAllocatorName, kSpaceBeg))); if (__builtin_expect(!!(!(v1 == v2)), 0)) __sanitizer::CheckFailed(&quot;/fast/tmp/llvm-proj-12/compiler-rt/lib/asan/../sanitizer_common/sanitizer_allocator_primary64.h&quot;, 77, &quot;(&quot; &quot;(kSpaceBeg)&quot; &quot;) &quot; &quot;==&quot; &quot; (&quot; &quot;(address_range.Init(TotalSpaceSize, PrimaryAllocatorName, kSpaceBeg))&quot; &quot;)&quot;, v1, v2); } while (false)" data-ref="_M/CHECK_EQ">CHECK_EQ</a>(<a class="member" href="#__sanitizer::SizeClassAllocator64::kSpaceBeg" title='__sanitizer::SizeClassAllocator64::kSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::kSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..kSpaceBeg">kSpaceBeg</a>, <a class="member field" href="#__sanitizer::SizeClassAllocator64::address_range" title='__sanitizer::SizeClassAllocator64::address_range' data-ref="__sanitizer::SizeClassAllocator64::address_range" data-ref-filename="__sanitizer..SizeClassAllocator64..address_range">address_range</a>.<a class="ref fn" href="sanitizer_common.h.html#__sanitizer::ReservedAddressRange::Init" title='__sanitizer::ReservedAddressRange::Init' data-ref="__sanitizer::ReservedAddressRange::Init" data-ref-filename="__sanitizer..ReservedAddressRange..Init">Init</a>(<a class="local col2 ref" href="#1012TotalSpaceSize" title='TotalSpaceSize' data-ref="1012TotalSpaceSize" data-ref-filename="1012TotalSpaceSize">TotalSpaceSize</a>,</td></tr>
<tr><th id="77">77</th><td>                                             <a class="ref" href="sanitizer_allocator.h.html#__sanitizer::PrimaryAllocatorName" title='__sanitizer::PrimaryAllocatorName' data-ref="__sanitizer::PrimaryAllocatorName" data-ref-filename="__sanitizer..PrimaryAllocatorName">PrimaryAllocatorName</a>, <a class="member" href="#__sanitizer::SizeClassAllocator64::kSpaceBeg" title='__sanitizer::SizeClassAllocator64::kSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::kSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..kSpaceBeg">kSpaceBeg</a>));</td></tr>
<tr><th id="78">78</th><td>    } <b>else</b> {</td></tr>
<tr><th id="79">79</th><td>      <i>// Combined allocator expects that an 2^N allocation is always aligned to</i></td></tr>
<tr><th id="80">80</th><td><i>      // 2^N. For this to work, the start of the space needs to be aligned as</i></td></tr>
<tr><th id="81">81</th><td><i>      // high as the largest size class (which also needs to be a power of 2).</i></td></tr>
<tr><th id="82">82</th><td>      <a class="member field" href="#__sanitizer::SizeClassAllocator64::NonConstSpaceBeg" title='__sanitizer::SizeClassAllocator64::NonConstSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::NonConstSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..NonConstSpaceBeg">NonConstSpaceBeg</a> = <a class="member field" href="#__sanitizer::SizeClassAllocator64::address_range" title='__sanitizer::SizeClassAllocator64::address_range' data-ref="__sanitizer::SizeClassAllocator64::address_range" data-ref-filename="__sanitizer..SizeClassAllocator64..address_range">address_range</a>.<a class="ref fn" href="sanitizer_common.h.html#__sanitizer::ReservedAddressRange::InitAligned" title='__sanitizer::ReservedAddressRange::InitAligned' data-ref="__sanitizer::ReservedAddressRange::InitAligned" data-ref-filename="__sanitizer..ReservedAddressRange..InitAligned">InitAligned</a>(</td></tr>
<tr><th id="83">83</th><td>          <a class="local col2 ref" href="#1012TotalSpaceSize" title='TotalSpaceSize' data-ref="1012TotalSpaceSize" data-ref-filename="1012TotalSpaceSize">TotalSpaceSize</a>, <a class="typedef" href="#__sanitizer::SizeClassAllocator64::SizeClassMap" title='__sanitizer::SizeClassAllocator64::SizeClassMap' data-type='typename Params::SizeClassMap' data-ref="__sanitizer::SizeClassAllocator64::SizeClassMap" data-ref-filename="__sanitizer..SizeClassAllocator64..SizeClassMap">SizeClassMap</a>::kMaxSize, <a class="ref" href="sanitizer_allocator.h.html#__sanitizer::PrimaryAllocatorName" title='__sanitizer::PrimaryAllocatorName' data-ref="__sanitizer::PrimaryAllocatorName" data-ref-filename="__sanitizer..PrimaryAllocatorName">PrimaryAllocatorName</a>);</td></tr>
<tr><th id="84">84</th><td>      <a class="macro" href="sanitizer_internal_defs.h.html#301" title="do { __sanitizer::u64 v1 = (__sanitizer::u64)((NonConstSpaceBeg)); __sanitizer::u64 v2 = (__sanitizer::u64)((~(uptr)0)); if (__builtin_expect(!!(!(v1 != v2)), 0)) __sanitizer::CheckFailed(&quot;/fast/tmp/llvm-proj-12/compiler-rt/lib/asan/../sanitizer_common/sanitizer_allocator_primary64.h&quot;, 84, &quot;(&quot; &quot;(NonConstSpaceBeg)&quot; &quot;) &quot; &quot;!=&quot; &quot; (&quot; &quot;(~(uptr)0)&quot; &quot;)&quot;, v1, v2); } while (false)" data-ref="_M/CHECK_NE">CHECK_NE</a>(<a class="member field" href="#__sanitizer::SizeClassAllocator64::NonConstSpaceBeg" title='__sanitizer::SizeClassAllocator64::NonConstSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::NonConstSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..NonConstSpaceBeg">NonConstSpaceBeg</a>, ~(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a>)<var>0</var>);</td></tr>
<tr><th id="85">85</th><td>    }</td></tr>
<tr><th id="86">86</th><td>    <a class="member fn" href="#__sanitizer::SizeClassAllocator64::SetReleaseToOSIntervalMs" title='__sanitizer::SizeClassAllocator64::SetReleaseToOSIntervalMs' data-ref="__sanitizer::SizeClassAllocator64::SetReleaseToOSIntervalMs" data-ref-filename="__sanitizer..SizeClassAllocator64..SetReleaseToOSIntervalMs">SetReleaseToOSIntervalMs</a>(<a class="local col1 ref" href="#1011release_to_os_interval_ms" title='release_to_os_interval_ms' data-ref="1011release_to_os_interval_ms" data-ref-filename="1011release_to_os_interval_ms">release_to_os_interval_ms</a>);</td></tr>
<tr><th id="87">87</th><td>    <a class="member fn" href="#__sanitizer::SizeClassAllocator64::MapWithCallbackOrDie" title='__sanitizer::SizeClassAllocator64::MapWithCallbackOrDie' data-ref="__sanitizer::SizeClassAllocator64::MapWithCallbackOrDie" data-ref-filename="__sanitizer..SizeClassAllocator64..MapWithCallbackOrDie">MapWithCallbackOrDie</a>(<a class="member fn" href="#__sanitizer::SizeClassAllocator64::SpaceEnd" title='__sanitizer::SizeClassAllocator64::SpaceEnd' data-ref="__sanitizer::SizeClassAllocator64::SpaceEnd" data-ref-filename="__sanitizer..SizeClassAllocator64..SpaceEnd">SpaceEnd</a>(), <a class="member fn" href="#__sanitizer::SizeClassAllocator64::AdditionalSize" title='__sanitizer::SizeClassAllocator64::AdditionalSize' data-ref="__sanitizer::SizeClassAllocator64::AdditionalSize" data-ref-filename="__sanitizer..SizeClassAllocator64..AdditionalSize">AdditionalSize</a>(),</td></tr>
<tr><th id="88">88</th><td>                         <q>"SizeClassAllocator: region info"</q>);</td></tr>
<tr><th id="89">89</th><td>    <i>// Check that the RegionInfo array is aligned on the CacheLine size.</i></td></tr>
<tr><th id="90">90</th><td>    <a class="macro" href="sanitizer_internal_defs.h.html#317" title="" data-ref="_M/DCHECK_EQ">DCHECK_EQ</a>(SpaceEnd() % kCacheLineSize, <var>0</var>);</td></tr>
<tr><th id="91">91</th><td>  }</td></tr>
<tr><th id="92">92</th><td></td></tr>
<tr><th id="93">93</th><td>  <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::s32" title='__sanitizer::s32' data-type='int' data-ref="__sanitizer::s32" data-ref-filename="__sanitizer..s32">s32</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::ReleaseToOSIntervalMs" title='__sanitizer::SizeClassAllocator64::ReleaseToOSIntervalMs' data-ref="__sanitizer::SizeClassAllocator64::ReleaseToOSIntervalMs" data-ref-filename="__sanitizer..SizeClassAllocator64..ReleaseToOSIntervalMs">ReleaseToOSIntervalMs</dfn>() <em>const</em> {</td></tr>
<tr><th id="94">94</th><td>    <b>return</b> <a class="ref fn" href="sanitizer_atomic_clang_x86.h.html#__sanitizer::atomic_load" title='__sanitizer::atomic_load' data-ref="__sanitizer::atomic_load" data-ref-filename="__sanitizer..atomic_load">atomic_load</a>(&amp;<a class="member field" href="#__sanitizer::SizeClassAllocator64::release_to_os_interval_ms_" title='__sanitizer::SizeClassAllocator64::release_to_os_interval_ms_' data-ref="__sanitizer::SizeClassAllocator64::release_to_os_interval_ms_" data-ref-filename="__sanitizer..SizeClassAllocator64..release_to_os_interval_ms_">release_to_os_interval_ms_</a>, <a class="enum" href="sanitizer_atomic.h.html#__sanitizer::memory_order_relaxed" title='__sanitizer::memory_order_relaxed' data-ref="__sanitizer::memory_order_relaxed" data-ref-filename="__sanitizer..memory_order_relaxed">memory_order_relaxed</a>);</td></tr>
<tr><th id="95">95</th><td>  }</td></tr>
<tr><th id="96">96</th><td></td></tr>
<tr><th id="97">97</th><td>  <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::SetReleaseToOSIntervalMs" title='__sanitizer::SizeClassAllocator64::SetReleaseToOSIntervalMs' data-ref="__sanitizer::SizeClassAllocator64::SetReleaseToOSIntervalMs" data-ref-filename="__sanitizer..SizeClassAllocator64..SetReleaseToOSIntervalMs">SetReleaseToOSIntervalMs</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::s32" title='__sanitizer::s32' data-type='int' data-ref="__sanitizer::s32" data-ref-filename="__sanitizer..s32">s32</a> <dfn class="local col3 decl" id="1013release_to_os_interval_ms" title='release_to_os_interval_ms' data-type='__sanitizer::s32' data-ref="1013release_to_os_interval_ms" data-ref-filename="1013release_to_os_interval_ms">release_to_os_interval_ms</dfn>) {</td></tr>
<tr><th id="98">98</th><td>    <a class="ref fn" href="sanitizer_atomic_clang_x86.h.html#__sanitizer::atomic_store" title='__sanitizer::atomic_store' data-ref="__sanitizer::atomic_store" data-ref-filename="__sanitizer..atomic_store">atomic_store</a>(&amp;<a class="member field" href="#__sanitizer::SizeClassAllocator64::release_to_os_interval_ms_" title='__sanitizer::SizeClassAllocator64::release_to_os_interval_ms_' data-ref="__sanitizer::SizeClassAllocator64::release_to_os_interval_ms_" data-ref-filename="__sanitizer..SizeClassAllocator64..release_to_os_interval_ms_">release_to_os_interval_ms_</a>, <a class="local col3 ref" href="#1013release_to_os_interval_ms" title='release_to_os_interval_ms' data-ref="1013release_to_os_interval_ms" data-ref-filename="1013release_to_os_interval_ms">release_to_os_interval_ms</a>,</td></tr>
<tr><th id="99">99</th><td>                 <a class="enum" href="sanitizer_atomic.h.html#__sanitizer::memory_order_relaxed" title='__sanitizer::memory_order_relaxed' data-ref="__sanitizer::memory_order_relaxed" data-ref-filename="__sanitizer..memory_order_relaxed">memory_order_relaxed</a>);</td></tr>
<tr><th id="100">100</th><td>  }</td></tr>
<tr><th id="101">101</th><td></td></tr>
<tr><th id="102">102</th><td>  <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::ForceReleaseToOS" title='__sanitizer::SizeClassAllocator64::ForceReleaseToOS' data-ref="__sanitizer::SizeClassAllocator64::ForceReleaseToOS" data-ref-filename="__sanitizer..SizeClassAllocator64..ForceReleaseToOS">ForceReleaseToOS</dfn>() {</td></tr>
<tr><th id="103">103</th><td>    <b>for</b> (<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col4 decl" id="1014class_id" title='class_id' data-type='__sanitizer::uptr' data-ref="1014class_id" data-ref-filename="1014class_id">class_id</dfn> = <var>1</var>; <a class="local col4 ref" href="#1014class_id" title='class_id' data-ref="1014class_id" data-ref-filename="1014class_id">class_id</a> &lt; <a class="member" href="#__sanitizer::SizeClassAllocator64::kNumClasses" title='__sanitizer::SizeClassAllocator64::kNumClasses' data-ref="__sanitizer::SizeClassAllocator64::kNumClasses" data-ref-filename="__sanitizer..SizeClassAllocator64..kNumClasses">kNumClasses</a>; <a class="local col4 ref" href="#1014class_id" title='class_id' data-ref="1014class_id" data-ref-filename="1014class_id">class_id</a>++) {</td></tr>
<tr><th id="104">104</th><td>      <a class="typedef" href="sanitizer_mutex.h.html#__sanitizer::BlockingMutexLock" title='__sanitizer::BlockingMutexLock' data-type='GenericScopedLock&lt;__sanitizer::BlockingMutex&gt;' data-ref="__sanitizer::BlockingMutexLock" data-ref-filename="__sanitizer..BlockingMutexLock">BlockingMutexLock</a> <dfn class="local col5 decl" id="1015l" title='l' data-type='__sanitizer::BlockingMutexLock' data-ref="1015l" data-ref-filename="1015l">l</dfn>(&amp;<a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetRegionInfo" title='__sanitizer::SizeClassAllocator64::GetRegionInfo' data-ref="__sanitizer::SizeClassAllocator64::GetRegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionInfo">GetRegionInfo</a>(<a class="local col4 ref" href="#1014class_id" title='class_id' data-ref="1014class_id" data-ref-filename="1014class_id">class_id</a>)-&gt;mutex);</td></tr>
<tr><th id="105">105</th><td>      <a class="member fn" href="#__sanitizer::SizeClassAllocator64::MaybeReleaseToOS" title='__sanitizer::SizeClassAllocator64::MaybeReleaseToOS' data-ref="__sanitizer::SizeClassAllocator64::MaybeReleaseToOS" data-ref-filename="__sanitizer..SizeClassAllocator64..MaybeReleaseToOS">MaybeReleaseToOS</a>(<a class="local col4 ref" href="#1014class_id" title='class_id' data-ref="1014class_id" data-ref-filename="1014class_id">class_id</a>, <b>true</b> <i>/*force*/</i>);</td></tr>
<tr><th id="106">106</th><td>    }</td></tr>
<tr><th id="107">107</th><td>  }</td></tr>
<tr><th id="108">108</th><td></td></tr>
<tr><th id="109">109</th><td>  <em>static</em> <em>bool</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::CanAllocate" title='__sanitizer::SizeClassAllocator64::CanAllocate' data-ref="__sanitizer::SizeClassAllocator64::CanAllocate" data-ref-filename="__sanitizer..SizeClassAllocator64..CanAllocate">CanAllocate</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col6 decl" id="1016size" title='size' data-type='__sanitizer::uptr' data-ref="1016size" data-ref-filename="1016size">size</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col7 decl" id="1017alignment" title='alignment' data-type='__sanitizer::uptr' data-ref="1017alignment" data-ref-filename="1017alignment">alignment</dfn>) {</td></tr>
<tr><th id="110">110</th><td>    <b>return</b> <a class="local col6 ref" href="#1016size" title='size' data-ref="1016size" data-ref-filename="1016size">size</a> &lt;= <a class="typedef" href="#__sanitizer::SizeClassAllocator64::SizeClassMap" title='__sanitizer::SizeClassAllocator64::SizeClassMap' data-type='typename Params::SizeClassMap' data-ref="__sanitizer::SizeClassAllocator64::SizeClassMap" data-ref-filename="__sanitizer..SizeClassAllocator64..SizeClassMap">SizeClassMap</a>::kMaxSize &amp;&amp;</td></tr>
<tr><th id="111">111</th><td>      <a class="local col7 ref" href="#1017alignment" title='alignment' data-ref="1017alignment" data-ref-filename="1017alignment">alignment</a> &lt;= <a class="typedef" href="#__sanitizer::SizeClassAllocator64::SizeClassMap" title='__sanitizer::SizeClassAllocator64::SizeClassMap' data-type='typename Params::SizeClassMap' data-ref="__sanitizer::SizeClassAllocator64::SizeClassMap" data-ref-filename="__sanitizer..SizeClassAllocator64..SizeClassMap">SizeClassMap</a>::kMaxSize;</td></tr>
<tr><th id="112">112</th><td>  }</td></tr>
<tr><th id="113">113</th><td></td></tr>
<tr><th id="114">114</th><td>  <a class="macro" href="sanitizer_internal_defs.h.html#225" title="__attribute__((noinline))" data-ref="_M/NOINLINE">NOINLINE</a> <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::ReturnToAllocator" title='__sanitizer::SizeClassAllocator64::ReturnToAllocator' data-ref="__sanitizer::SizeClassAllocator64::ReturnToAllocator" data-ref-filename="__sanitizer..SizeClassAllocator64..ReturnToAllocator">ReturnToAllocator</dfn>(<a class="type" href="sanitizer_allocator_stats.h.html#__sanitizer::AllocatorStats" title='__sanitizer::AllocatorStats' data-ref="__sanitizer::AllocatorStats" data-ref-filename="__sanitizer..AllocatorStats">AllocatorStats</a> *<dfn class="local col8 decl" id="1018stat" title='stat' data-type='__sanitizer::AllocatorStats *' data-ref="1018stat" data-ref-filename="1018stat">stat</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col9 decl" id="1019class_id" title='class_id' data-type='__sanitizer::uptr' data-ref="1019class_id" data-ref-filename="1019class_id">class_id</dfn>,</td></tr>
<tr><th id="115">115</th><td>                                  <em>const</em> <a class="typedef" href="#__sanitizer::SizeClassAllocator64::CompactPtrT" title='__sanitizer::SizeClassAllocator64::CompactPtrT' data-type='__sanitizer::u32' data-ref="__sanitizer::SizeClassAllocator64::CompactPtrT" data-ref-filename="__sanitizer..SizeClassAllocator64..CompactPtrT">CompactPtrT</a> *<dfn class="local col0 decl" id="1020chunks" title='chunks' data-type='const __sanitizer::SizeClassAllocator64::CompactPtrT *' data-ref="1020chunks" data-ref-filename="1020chunks">chunks</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col1 decl" id="1021n_chunks" title='n_chunks' data-type='__sanitizer::uptr' data-ref="1021n_chunks" data-ref-filename="1021n_chunks">n_chunks</dfn>) {</td></tr>
<tr><th id="116">116</th><td>    <a class="type" href="#__sanitizer::SizeClassAllocator64::RegionInfo" title='__sanitizer::SizeClassAllocator64::RegionInfo' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo">RegionInfo</a> *<dfn class="local col2 decl" id="1022region" title='region' data-type='__sanitizer::SizeClassAllocator64::RegionInfo *' data-ref="1022region" data-ref-filename="1022region">region</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetRegionInfo" title='__sanitizer::SizeClassAllocator64::GetRegionInfo' data-ref="__sanitizer::SizeClassAllocator64::GetRegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionInfo">GetRegionInfo</a>(<a class="local col9 ref" href="#1019class_id" title='class_id' data-ref="1019class_id" data-ref-filename="1019class_id">class_id</a>);</td></tr>
<tr><th id="117">117</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col3 decl" id="1023region_beg" title='region_beg' data-type='__sanitizer::uptr' data-ref="1023region_beg" data-ref-filename="1023region_beg">region_beg</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetRegionBeginBySizeClass" title='__sanitizer::SizeClassAllocator64::GetRegionBeginBySizeClass' data-ref="__sanitizer::SizeClassAllocator64::GetRegionBeginBySizeClass" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionBeginBySizeClass">GetRegionBeginBySizeClass</a>(<a class="local col9 ref" href="#1019class_id" title='class_id' data-ref="1019class_id" data-ref-filename="1019class_id">class_id</a>);</td></tr>
<tr><th id="118">118</th><td>    <a class="typedef" href="#__sanitizer::SizeClassAllocator64::CompactPtrT" title='__sanitizer::SizeClassAllocator64::CompactPtrT' data-type='__sanitizer::u32' data-ref="__sanitizer::SizeClassAllocator64::CompactPtrT" data-ref-filename="__sanitizer..SizeClassAllocator64..CompactPtrT">CompactPtrT</a> *<dfn class="local col4 decl" id="1024free_array" title='free_array' data-type='__sanitizer::SizeClassAllocator64::CompactPtrT *' data-ref="1024free_array" data-ref-filename="1024free_array">free_array</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetFreeArray" title='__sanitizer::SizeClassAllocator64::GetFreeArray' data-ref="__sanitizer::SizeClassAllocator64::GetFreeArray" data-ref-filename="__sanitizer..SizeClassAllocator64..GetFreeArray">GetFreeArray</a>(<a class="local col3 ref" href="#1023region_beg" title='region_beg' data-ref="1023region_beg" data-ref-filename="1023region_beg">region_beg</a>);</td></tr>
<tr><th id="119">119</th><td></td></tr>
<tr><th id="120">120</th><td>    <a class="typedef" href="sanitizer_mutex.h.html#__sanitizer::BlockingMutexLock" title='__sanitizer::BlockingMutexLock' data-type='GenericScopedLock&lt;__sanitizer::BlockingMutex&gt;' data-ref="__sanitizer::BlockingMutexLock" data-ref-filename="__sanitizer..BlockingMutexLock">BlockingMutexLock</a> <dfn class="local col5 decl" id="1025l" title='l' data-type='__sanitizer::BlockingMutexLock' data-ref="1025l" data-ref-filename="1025l">l</dfn>(&amp;<a class="local col2 ref" href="#1022region" title='region' data-ref="1022region" data-ref-filename="1022region">region</a>-&gt;mutex);</td></tr>
<tr><th id="121">121</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col6 decl" id="1026old_num_chunks" title='old_num_chunks' data-type='__sanitizer::uptr' data-ref="1026old_num_chunks" data-ref-filename="1026old_num_chunks">old_num_chunks</dfn> = <a class="local col2 ref" href="#1022region" title='region' data-ref="1022region" data-ref-filename="1022region">region</a>-&gt;num_freed_chunks;</td></tr>
<tr><th id="122">122</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col7 decl" id="1027new_num_freed_chunks" title='new_num_freed_chunks' data-type='__sanitizer::uptr' data-ref="1027new_num_freed_chunks" data-ref-filename="1027new_num_freed_chunks">new_num_freed_chunks</dfn> = <a class="local col6 ref" href="#1026old_num_chunks" title='old_num_chunks' data-ref="1026old_num_chunks" data-ref-filename="1026old_num_chunks">old_num_chunks</a> + <a class="local col1 ref" href="#1021n_chunks" title='n_chunks' data-ref="1021n_chunks" data-ref-filename="1021n_chunks">n_chunks</a>;</td></tr>
<tr><th id="123">123</th><td>    <i>// Failure to allocate free array space while releasing memory is non</i></td></tr>
<tr><th id="124">124</th><td><i>    // recoverable.</i></td></tr>
<tr><th id="125">125</th><td>    <b>if</b> (<a class="macro" href="sanitizer_internal_defs.h.html#229" title="__builtin_expect(!!(!EnsureFreeArraySpace(region, region_beg, new_num_freed_chunks)), 0)" data-ref="_M/UNLIKELY">UNLIKELY</a>(!<a class="member fn" href="#__sanitizer::SizeClassAllocator64::EnsureFreeArraySpace" title='__sanitizer::SizeClassAllocator64::EnsureFreeArraySpace' data-ref="__sanitizer::SizeClassAllocator64::EnsureFreeArraySpace" data-ref-filename="__sanitizer..SizeClassAllocator64..EnsureFreeArraySpace">EnsureFreeArraySpace</a>(<a class="local col2 ref" href="#1022region" title='region' data-ref="1022region" data-ref-filename="1022region">region</a>, <a class="local col3 ref" href="#1023region_beg" title='region_beg' data-ref="1023region_beg" data-ref-filename="1023region_beg">region_beg</a>,</td></tr>
<tr><th id="126">126</th><td>                                       <a class="local col7 ref" href="#1027new_num_freed_chunks" title='new_num_freed_chunks' data-ref="1027new_num_freed_chunks" data-ref-filename="1027new_num_freed_chunks">new_num_freed_chunks</a>))) {</td></tr>
<tr><th id="127">127</th><td>      <a class="ref fn" href="sanitizer_common.h.html#__sanitizer::Report" title='__sanitizer::Report' data-ref="__sanitizer::Report" data-ref-filename="__sanitizer..Report">Report</a>(<q>"FATAL: Internal error: %s's allocator exhausted the free list "</q></td></tr>
<tr><th id="128">128</th><td>             <q>"space for size class %zd (%zd bytes).\n"</q>, <a class="ref" href="sanitizer_common.h.html#__sanitizer::SanitizerToolName" title='__sanitizer::SanitizerToolName' data-ref="__sanitizer::SanitizerToolName" data-ref-filename="__sanitizer..SanitizerToolName">SanitizerToolName</a>,</td></tr>
<tr><th id="129">129</th><td>             <a class="local col9 ref" href="#1019class_id" title='class_id' data-ref="1019class_id" data-ref-filename="1019class_id">class_id</a>, <a class="member fn" href="#__sanitizer::SizeClassAllocator64::ClassIdToSize" title='__sanitizer::SizeClassAllocator64::ClassIdToSize' data-ref="__sanitizer::SizeClassAllocator64::ClassIdToSize" data-ref-filename="__sanitizer..SizeClassAllocator64..ClassIdToSize">ClassIdToSize</a>(<a class="local col9 ref" href="#1019class_id" title='class_id' data-ref="1019class_id" data-ref-filename="1019class_id">class_id</a>));</td></tr>
<tr><th id="130">130</th><td>      <a class="ref fn" href="sanitizer_internal_defs.h.html#__sanitizer::Die" title='__sanitizer::Die' data-ref="__sanitizer::Die" data-ref-filename="__sanitizer..Die">Die</a>();</td></tr>
<tr><th id="131">131</th><td>    }</td></tr>
<tr><th id="132">132</th><td>    <b>for</b> (<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col8 decl" id="1028i" title='i' data-type='__sanitizer::uptr' data-ref="1028i" data-ref-filename="1028i">i</dfn> = <var>0</var>; <a class="local col8 ref" href="#1028i" title='i' data-ref="1028i" data-ref-filename="1028i">i</a> &lt; <a class="local col1 ref" href="#1021n_chunks" title='n_chunks' data-ref="1021n_chunks" data-ref-filename="1021n_chunks">n_chunks</a>; <a class="local col8 ref" href="#1028i" title='i' data-ref="1028i" data-ref-filename="1028i">i</a>++)</td></tr>
<tr><th id="133">133</th><td>      <a class="local col4 ref" href="#1024free_array" title='free_array' data-ref="1024free_array" data-ref-filename="1024free_array">free_array</a>[<a class="local col6 ref" href="#1026old_num_chunks" title='old_num_chunks' data-ref="1026old_num_chunks" data-ref-filename="1026old_num_chunks">old_num_chunks</a> + <a class="local col8 ref" href="#1028i" title='i' data-ref="1028i" data-ref-filename="1028i">i</a>] = <a class="local col0 ref" href="#1020chunks" title='chunks' data-ref="1020chunks" data-ref-filename="1020chunks">chunks</a>[<a class="local col8 ref" href="#1028i" title='i' data-ref="1028i" data-ref-filename="1028i">i</a>];</td></tr>
<tr><th id="134">134</th><td>    <a class="local col2 ref" href="#1022region" title='region' data-ref="1022region" data-ref-filename="1022region">region</a>-&gt;num_freed_chunks = <a class="local col7 ref" href="#1027new_num_freed_chunks" title='new_num_freed_chunks' data-ref="1027new_num_freed_chunks" data-ref-filename="1027new_num_freed_chunks">new_num_freed_chunks</a>;</td></tr>
<tr><th id="135">135</th><td>    <a class="local col2 ref" href="#1022region" title='region' data-ref="1022region" data-ref-filename="1022region">region</a>-&gt;stats.n_freed += <a class="local col1 ref" href="#1021n_chunks" title='n_chunks' data-ref="1021n_chunks" data-ref-filename="1021n_chunks">n_chunks</a>;</td></tr>
<tr><th id="136">136</th><td></td></tr>
<tr><th id="137">137</th><td>    <a class="member fn" href="#__sanitizer::SizeClassAllocator64::MaybeReleaseToOS" title='__sanitizer::SizeClassAllocator64::MaybeReleaseToOS' data-ref="__sanitizer::SizeClassAllocator64::MaybeReleaseToOS" data-ref-filename="__sanitizer..SizeClassAllocator64..MaybeReleaseToOS">MaybeReleaseToOS</a>(<a class="local col9 ref" href="#1019class_id" title='class_id' data-ref="1019class_id" data-ref-filename="1019class_id">class_id</a>, <b>false</b> <i>/*force*/</i>);</td></tr>
<tr><th id="138">138</th><td>  }</td></tr>
<tr><th id="139">139</th><td></td></tr>
<tr><th id="140">140</th><td>  <a class="macro" href="sanitizer_internal_defs.h.html#225" title="__attribute__((noinline))" data-ref="_M/NOINLINE">NOINLINE</a> <em>bool</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::GetFromAllocator" title='__sanitizer::SizeClassAllocator64::GetFromAllocator' data-ref="__sanitizer::SizeClassAllocator64::GetFromAllocator" data-ref-filename="__sanitizer..SizeClassAllocator64..GetFromAllocator">GetFromAllocator</dfn>(<a class="type" href="sanitizer_allocator_stats.h.html#__sanitizer::AllocatorStats" title='__sanitizer::AllocatorStats' data-ref="__sanitizer::AllocatorStats" data-ref-filename="__sanitizer..AllocatorStats">AllocatorStats</a> *<dfn class="local col9 decl" id="1029stat" title='stat' data-type='__sanitizer::AllocatorStats *' data-ref="1029stat" data-ref-filename="1029stat">stat</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col0 decl" id="1030class_id" title='class_id' data-type='__sanitizer::uptr' data-ref="1030class_id" data-ref-filename="1030class_id">class_id</dfn>,</td></tr>
<tr><th id="141">141</th><td>                                 <a class="typedef" href="#__sanitizer::SizeClassAllocator64::CompactPtrT" title='__sanitizer::SizeClassAllocator64::CompactPtrT' data-type='__sanitizer::u32' data-ref="__sanitizer::SizeClassAllocator64::CompactPtrT" data-ref-filename="__sanitizer..SizeClassAllocator64..CompactPtrT">CompactPtrT</a> *<dfn class="local col1 decl" id="1031chunks" title='chunks' data-type='__sanitizer::SizeClassAllocator64::CompactPtrT *' data-ref="1031chunks" data-ref-filename="1031chunks">chunks</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col2 decl" id="1032n_chunks" title='n_chunks' data-type='__sanitizer::uptr' data-ref="1032n_chunks" data-ref-filename="1032n_chunks">n_chunks</dfn>) {</td></tr>
<tr><th id="142">142</th><td>    <a class="type" href="#__sanitizer::SizeClassAllocator64::RegionInfo" title='__sanitizer::SizeClassAllocator64::RegionInfo' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo">RegionInfo</a> *<dfn class="local col3 decl" id="1033region" title='region' data-type='__sanitizer::SizeClassAllocator64::RegionInfo *' data-ref="1033region" data-ref-filename="1033region">region</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetRegionInfo" title='__sanitizer::SizeClassAllocator64::GetRegionInfo' data-ref="__sanitizer::SizeClassAllocator64::GetRegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionInfo">GetRegionInfo</a>(<a class="local col0 ref" href="#1030class_id" title='class_id' data-ref="1030class_id" data-ref-filename="1030class_id">class_id</a>);</td></tr>
<tr><th id="143">143</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col4 decl" id="1034region_beg" title='region_beg' data-type='__sanitizer::uptr' data-ref="1034region_beg" data-ref-filename="1034region_beg">region_beg</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetRegionBeginBySizeClass" title='__sanitizer::SizeClassAllocator64::GetRegionBeginBySizeClass' data-ref="__sanitizer::SizeClassAllocator64::GetRegionBeginBySizeClass" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionBeginBySizeClass">GetRegionBeginBySizeClass</a>(<a class="local col0 ref" href="#1030class_id" title='class_id' data-ref="1030class_id" data-ref-filename="1030class_id">class_id</a>);</td></tr>
<tr><th id="144">144</th><td>    <a class="typedef" href="#__sanitizer::SizeClassAllocator64::CompactPtrT" title='__sanitizer::SizeClassAllocator64::CompactPtrT' data-type='__sanitizer::u32' data-ref="__sanitizer::SizeClassAllocator64::CompactPtrT" data-ref-filename="__sanitizer..SizeClassAllocator64..CompactPtrT">CompactPtrT</a> *<dfn class="local col5 decl" id="1035free_array" title='free_array' data-type='__sanitizer::SizeClassAllocator64::CompactPtrT *' data-ref="1035free_array" data-ref-filename="1035free_array">free_array</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetFreeArray" title='__sanitizer::SizeClassAllocator64::GetFreeArray' data-ref="__sanitizer::SizeClassAllocator64::GetFreeArray" data-ref-filename="__sanitizer..SizeClassAllocator64..GetFreeArray">GetFreeArray</a>(<a class="local col4 ref" href="#1034region_beg" title='region_beg' data-ref="1034region_beg" data-ref-filename="1034region_beg">region_beg</a>);</td></tr>
<tr><th id="145">145</th><td></td></tr>
<tr><th id="146">146</th><td>    <a class="typedef" href="sanitizer_mutex.h.html#__sanitizer::BlockingMutexLock" title='__sanitizer::BlockingMutexLock' data-type='GenericScopedLock&lt;__sanitizer::BlockingMutex&gt;' data-ref="__sanitizer::BlockingMutexLock" data-ref-filename="__sanitizer..BlockingMutexLock">BlockingMutexLock</a> <dfn class="local col6 decl" id="1036l" title='l' data-type='__sanitizer::BlockingMutexLock' data-ref="1036l" data-ref-filename="1036l">l</dfn>(&amp;<a class="local col3 ref" href="#1033region" title='region' data-ref="1033region" data-ref-filename="1033region">region</a>-&gt;mutex);</td></tr>
<tr><th id="147">147</th><td>    <b>if</b> (<a class="macro" href="sanitizer_internal_defs.h.html#229" title="__builtin_expect(!!(region-&gt;num_freed_chunks &lt; n_chunks), 0)" data-ref="_M/UNLIKELY">UNLIKELY</a>(<a class="local col3 ref" href="#1033region" title='region' data-ref="1033region" data-ref-filename="1033region">region</a>-&gt;num_freed_chunks &lt; <a class="local col2 ref" href="#1032n_chunks" title='n_chunks' data-ref="1032n_chunks" data-ref-filename="1032n_chunks">n_chunks</a>)) {</td></tr>
<tr><th id="148">148</th><td>      <b>if</b> (<a class="macro" href="sanitizer_internal_defs.h.html#229" title="__builtin_expect(!!(!PopulateFreeArray(stat, class_id, region, n_chunks - region-&gt;num_freed_chunks)), 0)" data-ref="_M/UNLIKELY">UNLIKELY</a>(!<a class="member fn" href="#__sanitizer::SizeClassAllocator64::PopulateFreeArray" title='__sanitizer::SizeClassAllocator64::PopulateFreeArray' data-ref="__sanitizer::SizeClassAllocator64::PopulateFreeArray" data-ref-filename="__sanitizer..SizeClassAllocator64..PopulateFreeArray">PopulateFreeArray</a>(<a class="local col9 ref" href="#1029stat" title='stat' data-ref="1029stat" data-ref-filename="1029stat">stat</a>, <a class="local col0 ref" href="#1030class_id" title='class_id' data-ref="1030class_id" data-ref-filename="1030class_id">class_id</a>, <a class="local col3 ref" href="#1033region" title='region' data-ref="1033region" data-ref-filename="1033region">region</a>,</td></tr>
<tr><th id="149">149</th><td>                                      <a class="local col2 ref" href="#1032n_chunks" title='n_chunks' data-ref="1032n_chunks" data-ref-filename="1032n_chunks">n_chunks</a> - <a class="local col3 ref" href="#1033region" title='region' data-ref="1033region" data-ref-filename="1033region">region</a>-&gt;num_freed_chunks)))</td></tr>
<tr><th id="150">150</th><td>        <b>return</b> <b>false</b>;</td></tr>
<tr><th id="151">151</th><td>      <a class="macro" href="sanitizer_internal_defs.h.html#305" title="do { __sanitizer::u64 v1 = (__sanitizer::u64)((region-&gt;num_freed_chunks)); __sanitizer::u64 v2 = (__sanitizer::u64)((n_chunks)); if (__builtin_expect(!!(!(v1 &gt;= v2)), 0)) __sanitizer::CheckFailed(&quot;/fast/tmp/llvm-proj-12/compiler-rt/lib/asan/../sanitizer_common/sanitizer_allocator_primary64.h&quot;, 151, &quot;(&quot; &quot;(region-&gt;num_freed_chunks)&quot; &quot;) &quot; &quot;&gt;=&quot; &quot; (&quot; &quot;(n_chunks)&quot; &quot;)&quot;, v1, v2); } while (false)" data-ref="_M/CHECK_GE">CHECK_GE</a>(<a class="local col3 ref" href="#1033region" title='region' data-ref="1033region" data-ref-filename="1033region">region</a>-&gt;num_freed_chunks, <a class="local col2 ref" href="#1032n_chunks" title='n_chunks' data-ref="1032n_chunks" data-ref-filename="1032n_chunks">n_chunks</a>);</td></tr>
<tr><th id="152">152</th><td>    }</td></tr>
<tr><th id="153">153</th><td>    <a class="local col3 ref" href="#1033region" title='region' data-ref="1033region" data-ref-filename="1033region">region</a>-&gt;num_freed_chunks -= <a class="local col2 ref" href="#1032n_chunks" title='n_chunks' data-ref="1032n_chunks" data-ref-filename="1032n_chunks">n_chunks</a>;</td></tr>
<tr><th id="154">154</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col7 decl" id="1037base_idx" title='base_idx' data-type='__sanitizer::uptr' data-ref="1037base_idx" data-ref-filename="1037base_idx">base_idx</dfn> = <a class="local col3 ref" href="#1033region" title='region' data-ref="1033region" data-ref-filename="1033region">region</a>-&gt;num_freed_chunks;</td></tr>
<tr><th id="155">155</th><td>    <b>for</b> (<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col8 decl" id="1038i" title='i' data-type='__sanitizer::uptr' data-ref="1038i" data-ref-filename="1038i">i</dfn> = <var>0</var>; <a class="local col8 ref" href="#1038i" title='i' data-ref="1038i" data-ref-filename="1038i">i</a> &lt; <a class="local col2 ref" href="#1032n_chunks" title='n_chunks' data-ref="1032n_chunks" data-ref-filename="1032n_chunks">n_chunks</a>; <a class="local col8 ref" href="#1038i" title='i' data-ref="1038i" data-ref-filename="1038i">i</a>++)</td></tr>
<tr><th id="156">156</th><td>      <a class="local col1 ref" href="#1031chunks" title='chunks' data-ref="1031chunks" data-ref-filename="1031chunks">chunks</a>[<a class="local col8 ref" href="#1038i" title='i' data-ref="1038i" data-ref-filename="1038i">i</a>] = <a class="local col5 ref" href="#1035free_array" title='free_array' data-ref="1035free_array" data-ref-filename="1035free_array">free_array</a>[<a class="local col7 ref" href="#1037base_idx" title='base_idx' data-ref="1037base_idx" data-ref-filename="1037base_idx">base_idx</a> + <a class="local col8 ref" href="#1038i" title='i' data-ref="1038i" data-ref-filename="1038i">i</a>];</td></tr>
<tr><th id="157">157</th><td>    <a class="local col3 ref" href="#1033region" title='region' data-ref="1033region" data-ref-filename="1033region">region</a>-&gt;stats.n_allocated += <a class="local col2 ref" href="#1032n_chunks" title='n_chunks' data-ref="1032n_chunks" data-ref-filename="1032n_chunks">n_chunks</a>;</td></tr>
<tr><th id="158">158</th><td>    <b>return</b> <b>true</b>;</td></tr>
<tr><th id="159">159</th><td>  }</td></tr>
<tr><th id="160">160</th><td></td></tr>
<tr><th id="161">161</th><td>  <em>bool</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::PointerIsMine" title='__sanitizer::SizeClassAllocator64::PointerIsMine' data-ref="__sanitizer::SizeClassAllocator64::PointerIsMine" data-ref-filename="__sanitizer..SizeClassAllocator64..PointerIsMine">PointerIsMine</dfn>(<em>const</em> <em>void</em> *<dfn class="local col9 decl" id="1039p" title='p' data-type='const void *' data-ref="1039p" data-ref-filename="1039p">p</dfn>) <em>const</em> {</td></tr>
<tr><th id="162">162</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col0 decl" id="1040P" title='P' data-type='__sanitizer::uptr' data-ref="1040P" data-ref-filename="1040P">P</dfn> = <b>reinterpret_cast</b>&lt;<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a>&gt;(<a class="local col9 ref" href="#1039p" title='p' data-ref="1039p" data-ref-filename="1039p">p</a>);</td></tr>
<tr><th id="163">163</th><td>    <b>if</b> (<a class="member" href="#__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg" title='__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..kUsingConstantSpaceBeg">kUsingConstantSpaceBeg</a> &amp;&amp; (<a class="member" href="#__sanitizer::SizeClassAllocator64::kSpaceBeg" title='__sanitizer::SizeClassAllocator64::kSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::kSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..kSpaceBeg">kSpaceBeg</a> % <a class="member" href="#__sanitizer::SizeClassAllocator64::kSpaceSize" title='__sanitizer::SizeClassAllocator64::kSpaceSize' data-ref="__sanitizer::SizeClassAllocator64::kSpaceSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kSpaceSize">kSpaceSize</a>) == <var>0</var>)</td></tr>
<tr><th id="164">164</th><td>      <b>return</b> <a class="local col0 ref" href="#1040P" title='P' data-ref="1040P" data-ref-filename="1040P">P</a> / <a class="member" href="#__sanitizer::SizeClassAllocator64::kSpaceSize" title='__sanitizer::SizeClassAllocator64::kSpaceSize' data-ref="__sanitizer::SizeClassAllocator64::kSpaceSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kSpaceSize">kSpaceSize</a> == <a class="member" href="#__sanitizer::SizeClassAllocator64::kSpaceBeg" title='__sanitizer::SizeClassAllocator64::kSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::kSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..kSpaceBeg">kSpaceBeg</a> / <a class="member" href="#__sanitizer::SizeClassAllocator64::kSpaceSize" title='__sanitizer::SizeClassAllocator64::kSpaceSize' data-ref="__sanitizer::SizeClassAllocator64::kSpaceSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kSpaceSize">kSpaceSize</a>;</td></tr>
<tr><th id="165">165</th><td>    <b>return</b> <a class="local col0 ref" href="#1040P" title='P' data-ref="1040P" data-ref-filename="1040P">P</a> &gt;= <a class="member fn" href="#__sanitizer::SizeClassAllocator64::SpaceBeg" title='__sanitizer::SizeClassAllocator64::SpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::SpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..SpaceBeg">SpaceBeg</a>() &amp;&amp; <a class="local col0 ref" href="#1040P" title='P' data-ref="1040P" data-ref-filename="1040P">P</a> &lt; <a class="member fn" href="#__sanitizer::SizeClassAllocator64::SpaceEnd" title='__sanitizer::SizeClassAllocator64::SpaceEnd' data-ref="__sanitizer::SizeClassAllocator64::SpaceEnd" data-ref-filename="__sanitizer..SizeClassAllocator64..SpaceEnd">SpaceEnd</a>();</td></tr>
<tr><th id="166">166</th><td>  }</td></tr>
<tr><th id="167">167</th><td></td></tr>
<tr><th id="168">168</th><td>  <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::GetRegionBegin" title='__sanitizer::SizeClassAllocator64::GetRegionBegin' data-ref="__sanitizer::SizeClassAllocator64::GetRegionBegin" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionBegin">GetRegionBegin</dfn>(<em>const</em> <em>void</em> *<dfn class="local col1 decl" id="1041p" title='p' data-type='const void *' data-ref="1041p" data-ref-filename="1041p">p</dfn>) {</td></tr>
<tr><th id="169">169</th><td>    <b>if</b> (<a class="member" href="#__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg" title='__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..kUsingConstantSpaceBeg">kUsingConstantSpaceBeg</a>)</td></tr>
<tr><th id="170">170</th><td>      <b>return</b> <b>reinterpret_cast</b>&lt;<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a>&gt;(<a class="local col1 ref" href="#1041p" title='p' data-ref="1041p" data-ref-filename="1041p">p</a>) &amp; ~(<a class="member" href="#__sanitizer::SizeClassAllocator64::kRegionSize" title='__sanitizer::SizeClassAllocator64::kRegionSize' data-ref="__sanitizer::SizeClassAllocator64::kRegionSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kRegionSize">kRegionSize</a> - <var>1</var>);</td></tr>
<tr><th id="171">171</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col2 decl" id="1042space_beg" title='space_beg' data-type='__sanitizer::uptr' data-ref="1042space_beg" data-ref-filename="1042space_beg">space_beg</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::SpaceBeg" title='__sanitizer::SizeClassAllocator64::SpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::SpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..SpaceBeg">SpaceBeg</a>();</td></tr>
<tr><th id="172">172</th><td>    <b>return</b> ((<b>reinterpret_cast</b>&lt;<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a>&gt;(<a class="local col1 ref" href="#1041p" title='p' data-ref="1041p" data-ref-filename="1041p">p</a>)  - <a class="local col2 ref" href="#1042space_beg" title='space_beg' data-ref="1042space_beg" data-ref-filename="1042space_beg">space_beg</a>) &amp; ~(<a class="member" href="#__sanitizer::SizeClassAllocator64::kRegionSize" title='__sanitizer::SizeClassAllocator64::kRegionSize' data-ref="__sanitizer::SizeClassAllocator64::kRegionSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kRegionSize">kRegionSize</a> - <var>1</var>)) +</td></tr>
<tr><th id="173">173</th><td>        <a class="local col2 ref" href="#1042space_beg" title='space_beg' data-ref="1042space_beg" data-ref-filename="1042space_beg">space_beg</a>;</td></tr>
<tr><th id="174">174</th><td>  }</td></tr>
<tr><th id="175">175</th><td></td></tr>
<tr><th id="176">176</th><td>  <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::GetRegionBeginBySizeClass" title='__sanitizer::SizeClassAllocator64::GetRegionBeginBySizeClass' data-ref="__sanitizer::SizeClassAllocator64::GetRegionBeginBySizeClass" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionBeginBySizeClass">GetRegionBeginBySizeClass</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col3 decl" id="1043class_id" title='class_id' data-type='__sanitizer::uptr' data-ref="1043class_id" data-ref-filename="1043class_id">class_id</dfn>) <em>const</em> {</td></tr>
<tr><th id="177">177</th><td>    <b>return</b> <a class="member fn" href="#__sanitizer::SizeClassAllocator64::SpaceBeg" title='__sanitizer::SizeClassAllocator64::SpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::SpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..SpaceBeg">SpaceBeg</a>() + <a class="member" href="#__sanitizer::SizeClassAllocator64::kRegionSize" title='__sanitizer::SizeClassAllocator64::kRegionSize' data-ref="__sanitizer::SizeClassAllocator64::kRegionSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kRegionSize">kRegionSize</a> * <a class="local col3 ref" href="#1043class_id" title='class_id' data-ref="1043class_id" data-ref-filename="1043class_id">class_id</a>;</td></tr>
<tr><th id="178">178</th><td>  }</td></tr>
<tr><th id="179">179</th><td></td></tr>
<tr><th id="180">180</th><td>  <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::GetSizeClass" title='__sanitizer::SizeClassAllocator64::GetSizeClass' data-ref="__sanitizer::SizeClassAllocator64::GetSizeClass" data-ref-filename="__sanitizer..SizeClassAllocator64..GetSizeClass">GetSizeClass</dfn>(<em>const</em> <em>void</em> *<dfn class="local col4 decl" id="1044p" title='p' data-type='const void *' data-ref="1044p" data-ref-filename="1044p">p</dfn>) {</td></tr>
<tr><th id="181">181</th><td>    <b>if</b> (<a class="member" href="#__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg" title='__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..kUsingConstantSpaceBeg">kUsingConstantSpaceBeg</a> &amp;&amp; (<a class="member" href="#__sanitizer::SizeClassAllocator64::kSpaceBeg" title='__sanitizer::SizeClassAllocator64::kSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::kSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..kSpaceBeg">kSpaceBeg</a> % <a class="member" href="#__sanitizer::SizeClassAllocator64::kSpaceSize" title='__sanitizer::SizeClassAllocator64::kSpaceSize' data-ref="__sanitizer::SizeClassAllocator64::kSpaceSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kSpaceSize">kSpaceSize</a>) == <var>0</var>)</td></tr>
<tr><th id="182">182</th><td>      <b>return</b> ((<b>reinterpret_cast</b>&lt;<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a>&gt;(<a class="local col4 ref" href="#1044p" title='p' data-ref="1044p" data-ref-filename="1044p">p</a>)) / <a class="member" href="#__sanitizer::SizeClassAllocator64::kRegionSize" title='__sanitizer::SizeClassAllocator64::kRegionSize' data-ref="__sanitizer::SizeClassAllocator64::kRegionSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kRegionSize">kRegionSize</a>) % <a class="member" href="#__sanitizer::SizeClassAllocator64::kNumClassesRounded" title='__sanitizer::SizeClassAllocator64::kNumClassesRounded' data-ref="__sanitizer::SizeClassAllocator64::kNumClassesRounded" data-ref-filename="__sanitizer..SizeClassAllocator64..kNumClassesRounded">kNumClassesRounded</a>;</td></tr>
<tr><th id="183">183</th><td>    <b>return</b> ((<b>reinterpret_cast</b>&lt;<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a>&gt;(<a class="local col4 ref" href="#1044p" title='p' data-ref="1044p" data-ref-filename="1044p">p</a>) - <a class="member fn" href="#__sanitizer::SizeClassAllocator64::SpaceBeg" title='__sanitizer::SizeClassAllocator64::SpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::SpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..SpaceBeg">SpaceBeg</a>()) / <a class="member" href="#__sanitizer::SizeClassAllocator64::kRegionSize" title='__sanitizer::SizeClassAllocator64::kRegionSize' data-ref="__sanitizer::SizeClassAllocator64::kRegionSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kRegionSize">kRegionSize</a>) %</td></tr>
<tr><th id="184">184</th><td>           <a class="member" href="#__sanitizer::SizeClassAllocator64::kNumClassesRounded" title='__sanitizer::SizeClassAllocator64::kNumClassesRounded' data-ref="__sanitizer::SizeClassAllocator64::kNumClassesRounded" data-ref-filename="__sanitizer..SizeClassAllocator64..kNumClassesRounded">kNumClassesRounded</a>;</td></tr>
<tr><th id="185">185</th><td>  }</td></tr>
<tr><th id="186">186</th><td></td></tr>
<tr><th id="187">187</th><td>  <em>void</em> *<dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::GetBlockBegin" title='__sanitizer::SizeClassAllocator64::GetBlockBegin' data-ref="__sanitizer::SizeClassAllocator64::GetBlockBegin" data-ref-filename="__sanitizer..SizeClassAllocator64..GetBlockBegin">GetBlockBegin</dfn>(<em>const</em> <em>void</em> *<dfn class="local col5 decl" id="1045p" title='p' data-type='const void *' data-ref="1045p" data-ref-filename="1045p">p</dfn>) {</td></tr>
<tr><th id="188">188</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col6 decl" id="1046class_id" title='class_id' data-type='__sanitizer::uptr' data-ref="1046class_id" data-ref-filename="1046class_id">class_id</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetSizeClass" title='__sanitizer::SizeClassAllocator64::GetSizeClass' data-ref="__sanitizer::SizeClassAllocator64::GetSizeClass" data-ref-filename="__sanitizer..SizeClassAllocator64..GetSizeClass">GetSizeClass</a>(<a class="local col5 ref" href="#1045p" title='p' data-ref="1045p" data-ref-filename="1045p">p</a>);</td></tr>
<tr><th id="189">189</th><td>    <b>if</b> (<a class="local col6 ref" href="#1046class_id" title='class_id' data-ref="1046class_id" data-ref-filename="1046class_id">class_id</a> &gt;= <a class="member" href="#__sanitizer::SizeClassAllocator64::kNumClasses" title='__sanitizer::SizeClassAllocator64::kNumClasses' data-ref="__sanitizer::SizeClassAllocator64::kNumClasses" data-ref-filename="__sanitizer..SizeClassAllocator64..kNumClasses">kNumClasses</a>) <b>return</b> <b>nullptr</b>;</td></tr>
<tr><th id="190">190</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col7 decl" id="1047size" title='size' data-type='__sanitizer::uptr' data-ref="1047size" data-ref-filename="1047size">size</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::ClassIdToSize" title='__sanitizer::SizeClassAllocator64::ClassIdToSize' data-ref="__sanitizer::SizeClassAllocator64::ClassIdToSize" data-ref-filename="__sanitizer..SizeClassAllocator64..ClassIdToSize">ClassIdToSize</a>(<a class="local col6 ref" href="#1046class_id" title='class_id' data-ref="1046class_id" data-ref-filename="1046class_id">class_id</a>);</td></tr>
<tr><th id="191">191</th><td>    <b>if</b> (!<a class="local col7 ref" href="#1047size" title='size' data-ref="1047size" data-ref-filename="1047size">size</a>) <b>return</b> <b>nullptr</b>;</td></tr>
<tr><th id="192">192</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col8 decl" id="1048chunk_idx" title='chunk_idx' data-type='__sanitizer::uptr' data-ref="1048chunk_idx" data-ref-filename="1048chunk_idx">chunk_idx</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetChunkIdx" title='__sanitizer::SizeClassAllocator64::GetChunkIdx' data-ref="__sanitizer::SizeClassAllocator64::GetChunkIdx" data-ref-filename="__sanitizer..SizeClassAllocator64..GetChunkIdx">GetChunkIdx</a>((<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a>)<a class="local col5 ref" href="#1045p" title='p' data-ref="1045p" data-ref-filename="1045p">p</a>, <a class="local col7 ref" href="#1047size" title='size' data-ref="1047size" data-ref-filename="1047size">size</a>);</td></tr>
<tr><th id="193">193</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col9 decl" id="1049reg_beg" title='reg_beg' data-type='__sanitizer::uptr' data-ref="1049reg_beg" data-ref-filename="1049reg_beg">reg_beg</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetRegionBegin" title='__sanitizer::SizeClassAllocator64::GetRegionBegin' data-ref="__sanitizer::SizeClassAllocator64::GetRegionBegin" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionBegin">GetRegionBegin</a>(<a class="local col5 ref" href="#1045p" title='p' data-ref="1045p" data-ref-filename="1045p">p</a>);</td></tr>
<tr><th id="194">194</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col0 decl" id="1050beg" title='beg' data-type='__sanitizer::uptr' data-ref="1050beg" data-ref-filename="1050beg">beg</dfn> = <a class="local col8 ref" href="#1048chunk_idx" title='chunk_idx' data-ref="1048chunk_idx" data-ref-filename="1048chunk_idx">chunk_idx</a> * <a class="local col7 ref" href="#1047size" title='size' data-ref="1047size" data-ref-filename="1047size">size</a>;</td></tr>
<tr><th id="195">195</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col1 decl" id="1051next_beg" title='next_beg' data-type='__sanitizer::uptr' data-ref="1051next_beg" data-ref-filename="1051next_beg">next_beg</dfn> = <a class="local col0 ref" href="#1050beg" title='beg' data-ref="1050beg" data-ref-filename="1050beg">beg</a> + <a class="local col7 ref" href="#1047size" title='size' data-ref="1047size" data-ref-filename="1047size">size</a>;</td></tr>
<tr><th id="196">196</th><td>    <em>const</em> <a class="type" href="#__sanitizer::SizeClassAllocator64::RegionInfo" title='__sanitizer::SizeClassAllocator64::RegionInfo' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo">RegionInfo</a> *<dfn class="local col2 decl" id="1052region" title='region' data-type='const __sanitizer::SizeClassAllocator64::RegionInfo *' data-ref="1052region" data-ref-filename="1052region">region</dfn> = <a class="typedef" href="#__sanitizer::SizeClassAllocator64::AddressSpaceView" title='__sanitizer::SizeClassAllocator64::AddressSpaceView' data-type='typename Params::AddressSpaceView' data-ref="__sanitizer::SizeClassAllocator64::AddressSpaceView" data-ref-filename="__sanitizer..SizeClassAllocator64..AddressSpaceView">AddressSpaceView</a>::Load(<a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetRegionInfo" title='__sanitizer::SizeClassAllocator64::GetRegionInfo' data-ref="__sanitizer::SizeClassAllocator64::GetRegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionInfo">GetRegionInfo</a>(<a class="local col6 ref" href="#1046class_id" title='class_id' data-ref="1046class_id" data-ref-filename="1046class_id">class_id</a>));</td></tr>
<tr><th id="197">197</th><td>    <b>if</b> (<a class="local col2 ref" href="#1052region" title='region' data-ref="1052region" data-ref-filename="1052region">region</a>-&gt;mapped_user &gt;= <a class="local col1 ref" href="#1051next_beg" title='next_beg' data-ref="1051next_beg" data-ref-filename="1051next_beg">next_beg</a>)</td></tr>
<tr><th id="198">198</th><td>      <b>return</b> <b>reinterpret_cast</b>&lt;<em>void</em>*&gt;(<a class="local col9 ref" href="#1049reg_beg" title='reg_beg' data-ref="1049reg_beg" data-ref-filename="1049reg_beg">reg_beg</a> + <a class="local col0 ref" href="#1050beg" title='beg' data-ref="1050beg" data-ref-filename="1050beg">beg</a>);</td></tr>
<tr><th id="199">199</th><td>    <b>return</b> <b>nullptr</b>;</td></tr>
<tr><th id="200">200</th><td>  }</td></tr>
<tr><th id="201">201</th><td></td></tr>
<tr><th id="202">202</th><td>  <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::GetActuallyAllocatedSize" title='__sanitizer::SizeClassAllocator64::GetActuallyAllocatedSize' data-ref="__sanitizer::SizeClassAllocator64::GetActuallyAllocatedSize" data-ref-filename="__sanitizer..SizeClassAllocator64..GetActuallyAllocatedSize">GetActuallyAllocatedSize</dfn>(<em>void</em> *<dfn class="local col3 decl" id="1053p" title='p' data-type='void *' data-ref="1053p" data-ref-filename="1053p">p</dfn>) {</td></tr>
<tr><th id="203">203</th><td>    <a class="macro" href="sanitizer_internal_defs.h.html#299" title="do { __sanitizer::u64 v1 = (__sanitizer::u64)((PointerIsMine(p))); __sanitizer::u64 v2 = (__sanitizer::u64)(0); if (__builtin_expect(!!(!(v1 != v2)), 0)) __sanitizer::CheckFailed(&quot;/fast/tmp/llvm-proj-12/compiler-rt/lib/asan/../sanitizer_common/sanitizer_allocator_primary64.h&quot;, 203, &quot;(&quot; &quot;(PointerIsMine(p))&quot; &quot;) &quot; &quot;!=&quot; &quot; (&quot; &quot;0&quot; &quot;)&quot;, v1, v2); } while (false)" data-ref="_M/CHECK">CHECK</a>(<a class="member fn" href="#__sanitizer::SizeClassAllocator64::PointerIsMine" title='__sanitizer::SizeClassAllocator64::PointerIsMine' data-ref="__sanitizer::SizeClassAllocator64::PointerIsMine" data-ref-filename="__sanitizer..SizeClassAllocator64..PointerIsMine">PointerIsMine</a>(<a class="local col3 ref" href="#1053p" title='p' data-ref="1053p" data-ref-filename="1053p">p</a>));</td></tr>
<tr><th id="204">204</th><td>    <b>return</b> <a class="member fn" href="#__sanitizer::SizeClassAllocator64::ClassIdToSize" title='__sanitizer::SizeClassAllocator64::ClassIdToSize' data-ref="__sanitizer::SizeClassAllocator64::ClassIdToSize" data-ref-filename="__sanitizer..SizeClassAllocator64..ClassIdToSize">ClassIdToSize</a>(<a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetSizeClass" title='__sanitizer::SizeClassAllocator64::GetSizeClass' data-ref="__sanitizer::SizeClassAllocator64::GetSizeClass" data-ref-filename="__sanitizer..SizeClassAllocator64..GetSizeClass">GetSizeClass</a>(<a class="local col3 ref" href="#1053p" title='p' data-ref="1053p" data-ref-filename="1053p">p</a>));</td></tr>
<tr><th id="205">205</th><td>  }</td></tr>
<tr><th id="206">206</th><td></td></tr>
<tr><th id="207">207</th><td>  <em>static</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::ClassID" title='__sanitizer::SizeClassAllocator64::ClassID' data-ref="__sanitizer::SizeClassAllocator64::ClassID" data-ref-filename="__sanitizer..SizeClassAllocator64..ClassID">ClassID</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col4 decl" id="1054size" title='size' data-type='__sanitizer::uptr' data-ref="1054size" data-ref-filename="1054size">size</dfn>) { <b>return</b> <a class="typedef" href="#__sanitizer::SizeClassAllocator64::SizeClassMap" title='__sanitizer::SizeClassAllocator64::SizeClassMap' data-type='typename Params::SizeClassMap' data-ref="__sanitizer::SizeClassAllocator64::SizeClassMap" data-ref-filename="__sanitizer..SizeClassAllocator64..SizeClassMap">SizeClassMap</a>::ClassID(<a class="local col4 ref" href="#1054size" title='size' data-ref="1054size" data-ref-filename="1054size">size</a>); }</td></tr>
<tr><th id="208">208</th><td></td></tr>
<tr><th id="209">209</th><td>  <em>void</em> *<dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::GetMetaData" title='__sanitizer::SizeClassAllocator64::GetMetaData' data-ref="__sanitizer::SizeClassAllocator64::GetMetaData" data-ref-filename="__sanitizer..SizeClassAllocator64..GetMetaData">GetMetaData</dfn>(<em>const</em> <em>void</em> *<dfn class="local col5 decl" id="1055p" title='p' data-type='const void *' data-ref="1055p" data-ref-filename="1055p">p</dfn>) {</td></tr>
<tr><th id="210">210</th><td>    <a class="macro" href="sanitizer_internal_defs.h.html#299" title="do { __sanitizer::u64 v1 = (__sanitizer::u64)((kMetadataSize)); __sanitizer::u64 v2 = (__sanitizer::u64)(0); if (__builtin_expect(!!(!(v1 != v2)), 0)) __sanitizer::CheckFailed(&quot;/fast/tmp/llvm-proj-12/compiler-rt/lib/asan/../sanitizer_common/sanitizer_allocator_primary64.h&quot;, 210, &quot;(&quot; &quot;(kMetadataSize)&quot; &quot;) &quot; &quot;!=&quot; &quot; (&quot; &quot;0&quot; &quot;)&quot;, v1, v2); } while (false)" data-ref="_M/CHECK">CHECK</a>(<a class="member" href="#__sanitizer::SizeClassAllocator64::kMetadataSize" title='__sanitizer::SizeClassAllocator64::kMetadataSize' data-ref="__sanitizer::SizeClassAllocator64::kMetadataSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kMetadataSize">kMetadataSize</a>);</td></tr>
<tr><th id="211">211</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col6 decl" id="1056class_id" title='class_id' data-type='__sanitizer::uptr' data-ref="1056class_id" data-ref-filename="1056class_id">class_id</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetSizeClass" title='__sanitizer::SizeClassAllocator64::GetSizeClass' data-ref="__sanitizer::SizeClassAllocator64::GetSizeClass" data-ref-filename="__sanitizer..SizeClassAllocator64..GetSizeClass">GetSizeClass</a>(<a class="local col5 ref" href="#1055p" title='p' data-ref="1055p" data-ref-filename="1055p">p</a>);</td></tr>
<tr><th id="212">212</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col7 decl" id="1057size" title='size' data-type='__sanitizer::uptr' data-ref="1057size" data-ref-filename="1057size">size</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::ClassIdToSize" title='__sanitizer::SizeClassAllocator64::ClassIdToSize' data-ref="__sanitizer::SizeClassAllocator64::ClassIdToSize" data-ref-filename="__sanitizer..SizeClassAllocator64..ClassIdToSize">ClassIdToSize</a>(<a class="local col6 ref" href="#1056class_id" title='class_id' data-ref="1056class_id" data-ref-filename="1056class_id">class_id</a>);</td></tr>
<tr><th id="213">213</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col8 decl" id="1058chunk_idx" title='chunk_idx' data-type='__sanitizer::uptr' data-ref="1058chunk_idx" data-ref-filename="1058chunk_idx">chunk_idx</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetChunkIdx" title='__sanitizer::SizeClassAllocator64::GetChunkIdx' data-ref="__sanitizer::SizeClassAllocator64::GetChunkIdx" data-ref-filename="__sanitizer..SizeClassAllocator64..GetChunkIdx">GetChunkIdx</a>(<b>reinterpret_cast</b>&lt;<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a>&gt;(<a class="local col5 ref" href="#1055p" title='p' data-ref="1055p" data-ref-filename="1055p">p</a>), <a class="local col7 ref" href="#1057size" title='size' data-ref="1057size" data-ref-filename="1057size">size</a>);</td></tr>
<tr><th id="214">214</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col9 decl" id="1059region_beg" title='region_beg' data-type='__sanitizer::uptr' data-ref="1059region_beg" data-ref-filename="1059region_beg">region_beg</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetRegionBeginBySizeClass" title='__sanitizer::SizeClassAllocator64::GetRegionBeginBySizeClass' data-ref="__sanitizer::SizeClassAllocator64::GetRegionBeginBySizeClass" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionBeginBySizeClass">GetRegionBeginBySizeClass</a>(<a class="local col6 ref" href="#1056class_id" title='class_id' data-ref="1056class_id" data-ref-filename="1056class_id">class_id</a>);</td></tr>
<tr><th id="215">215</th><td>    <b>return</b> <b>reinterpret_cast</b>&lt;<em>void</em> *&gt;(<a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetMetadataEnd" title='__sanitizer::SizeClassAllocator64::GetMetadataEnd' data-ref="__sanitizer::SizeClassAllocator64::GetMetadataEnd" data-ref-filename="__sanitizer..SizeClassAllocator64..GetMetadataEnd">GetMetadataEnd</a>(<a class="local col9 ref" href="#1059region_beg" title='region_beg' data-ref="1059region_beg" data-ref-filename="1059region_beg">region_beg</a>) -</td></tr>
<tr><th id="216">216</th><td>                                    (<var>1</var> + <a class="local col8 ref" href="#1058chunk_idx" title='chunk_idx' data-ref="1058chunk_idx" data-ref-filename="1058chunk_idx">chunk_idx</a>) * <a class="member" href="#__sanitizer::SizeClassAllocator64::kMetadataSize" title='__sanitizer::SizeClassAllocator64::kMetadataSize' data-ref="__sanitizer::SizeClassAllocator64::kMetadataSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kMetadataSize">kMetadataSize</a>);</td></tr>
<tr><th id="217">217</th><td>  }</td></tr>
<tr><th id="218">218</th><td></td></tr>
<tr><th id="219">219</th><td>  <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::TotalMemoryUsed" title='__sanitizer::SizeClassAllocator64::TotalMemoryUsed' data-ref="__sanitizer::SizeClassAllocator64::TotalMemoryUsed" data-ref-filename="__sanitizer..SizeClassAllocator64..TotalMemoryUsed">TotalMemoryUsed</dfn>() {</td></tr>
<tr><th id="220">220</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col0 decl" id="1060res" title='res' data-type='__sanitizer::uptr' data-ref="1060res" data-ref-filename="1060res">res</dfn> = <var>0</var>;</td></tr>
<tr><th id="221">221</th><td>    <b>for</b> (<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col1 decl" id="1061i" title='i' data-type='__sanitizer::uptr' data-ref="1061i" data-ref-filename="1061i">i</dfn> = <var>0</var>; <a class="local col1 ref" href="#1061i" title='i' data-ref="1061i" data-ref-filename="1061i">i</a> &lt; <a class="member" href="#__sanitizer::SizeClassAllocator64::kNumClasses" title='__sanitizer::SizeClassAllocator64::kNumClasses' data-ref="__sanitizer::SizeClassAllocator64::kNumClasses" data-ref-filename="__sanitizer..SizeClassAllocator64..kNumClasses">kNumClasses</a>; <a class="local col1 ref" href="#1061i" title='i' data-ref="1061i" data-ref-filename="1061i">i</a>++)</td></tr>
<tr><th id="222">222</th><td>      <a class="local col0 ref" href="#1060res" title='res' data-ref="1060res" data-ref-filename="1060res">res</a> += <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetRegionInfo" title='__sanitizer::SizeClassAllocator64::GetRegionInfo' data-ref="__sanitizer::SizeClassAllocator64::GetRegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionInfo">GetRegionInfo</a>(<a class="local col1 ref" href="#1061i" title='i' data-ref="1061i" data-ref-filename="1061i">i</a>)-&gt;allocated_user;</td></tr>
<tr><th id="223">223</th><td>    <b>return</b> <a class="local col0 ref" href="#1060res" title='res' data-ref="1060res" data-ref-filename="1060res">res</a>;</td></tr>
<tr><th id="224">224</th><td>  }</td></tr>
<tr><th id="225">225</th><td></td></tr>
<tr><th id="226">226</th><td>  <i>// Test-only.</i></td></tr>
<tr><th id="227">227</th><td>  <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::TestOnlyUnmap" title='__sanitizer::SizeClassAllocator64::TestOnlyUnmap' data-ref="__sanitizer::SizeClassAllocator64::TestOnlyUnmap" data-ref-filename="__sanitizer..SizeClassAllocator64..TestOnlyUnmap">TestOnlyUnmap</dfn>() {</td></tr>
<tr><th id="228">228</th><td>    <a class="member fn" href="#__sanitizer::SizeClassAllocator64::UnmapWithCallbackOrDie" title='__sanitizer::SizeClassAllocator64::UnmapWithCallbackOrDie' data-ref="__sanitizer::SizeClassAllocator64::UnmapWithCallbackOrDie" data-ref-filename="__sanitizer..SizeClassAllocator64..UnmapWithCallbackOrDie">UnmapWithCallbackOrDie</a>((<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a>)<a class="member field" href="#__sanitizer::SizeClassAllocator64::address_range" title='__sanitizer::SizeClassAllocator64::address_range' data-ref="__sanitizer::SizeClassAllocator64::address_range" data-ref-filename="__sanitizer..SizeClassAllocator64..address_range">address_range</a>.<a class="ref fn" href="sanitizer_common.h.html#__sanitizer::ReservedAddressRange::base" title='__sanitizer::ReservedAddressRange::base' data-ref="__sanitizer::ReservedAddressRange::base" data-ref-filename="__sanitizer..ReservedAddressRange..base">base</a>(), <a class="member field" href="#__sanitizer::SizeClassAllocator64::address_range" title='__sanitizer::SizeClassAllocator64::address_range' data-ref="__sanitizer::SizeClassAllocator64::address_range" data-ref-filename="__sanitizer..SizeClassAllocator64..address_range">address_range</a>.<a class="ref fn" href="sanitizer_common.h.html#__sanitizer::ReservedAddressRange::size" title='__sanitizer::ReservedAddressRange::size' data-ref="__sanitizer::ReservedAddressRange::size" data-ref-filename="__sanitizer..ReservedAddressRange..size">size</a>());</td></tr>
<tr><th id="229">229</th><td>  }</td></tr>
<tr><th id="230">230</th><td></td></tr>
<tr><th id="231">231</th><td>  <em>static</em> <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::FillMemoryProfile" title='__sanitizer::SizeClassAllocator64::FillMemoryProfile' data-ref="__sanitizer::SizeClassAllocator64::FillMemoryProfile" data-ref-filename="__sanitizer..SizeClassAllocator64..FillMemoryProfile">FillMemoryProfile</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col2 decl" id="1062start" title='start' data-type='__sanitizer::uptr' data-ref="1062start" data-ref-filename="1062start">start</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col3 decl" id="1063rss" title='rss' data-type='__sanitizer::uptr' data-ref="1063rss" data-ref-filename="1063rss">rss</dfn>, <em>bool</em> <dfn class="local col4 decl" id="1064file" title='file' data-type='bool' data-ref="1064file" data-ref-filename="1064file">file</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> *<dfn class="local col5 decl" id="1065stats" title='stats' data-type='__sanitizer::uptr *' data-ref="1065stats" data-ref-filename="1065stats">stats</dfn>,</td></tr>
<tr><th id="232">232</th><td>                           <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col6 decl" id="1066stats_size" title='stats_size' data-type='__sanitizer::uptr' data-ref="1066stats_size" data-ref-filename="1066stats_size">stats_size</dfn>) {</td></tr>
<tr><th id="233">233</th><td>    <b>for</b> (<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col7 decl" id="1067class_id" title='class_id' data-type='__sanitizer::uptr' data-ref="1067class_id" data-ref-filename="1067class_id">class_id</dfn> = <var>0</var>; <a class="local col7 ref" href="#1067class_id" title='class_id' data-ref="1067class_id" data-ref-filename="1067class_id">class_id</a> &lt; <a class="local col6 ref" href="#1066stats_size" title='stats_size' data-ref="1066stats_size" data-ref-filename="1066stats_size">stats_size</a>; <a class="local col7 ref" href="#1067class_id" title='class_id' data-ref="1067class_id" data-ref-filename="1067class_id">class_id</a>++)</td></tr>
<tr><th id="234">234</th><td>      <b>if</b> (<a class="local col5 ref" href="#1065stats" title='stats' data-ref="1065stats" data-ref-filename="1065stats">stats</a>[<a class="local col7 ref" href="#1067class_id" title='class_id' data-ref="1067class_id" data-ref-filename="1067class_id">class_id</a>] == <a class="local col2 ref" href="#1062start" title='start' data-ref="1062start" data-ref-filename="1062start">start</a>)</td></tr>
<tr><th id="235">235</th><td>        <a class="local col5 ref" href="#1065stats" title='stats' data-ref="1065stats" data-ref-filename="1065stats">stats</a>[<a class="local col7 ref" href="#1067class_id" title='class_id' data-ref="1067class_id" data-ref-filename="1067class_id">class_id</a>] = <a class="local col3 ref" href="#1063rss" title='rss' data-ref="1063rss" data-ref-filename="1063rss">rss</a>;</td></tr>
<tr><th id="236">236</th><td>  }</td></tr>
<tr><th id="237">237</th><td></td></tr>
<tr><th id="238">238</th><td>  <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::PrintStats" title='__sanitizer::SizeClassAllocator64::PrintStats' data-ref="__sanitizer::SizeClassAllocator64::PrintStats" data-ref-filename="__sanitizer..SizeClassAllocator64..PrintStats">PrintStats</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col8 decl" id="1068class_id" title='class_id' data-type='__sanitizer::uptr' data-ref="1068class_id" data-ref-filename="1068class_id">class_id</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col9 decl" id="1069rss" title='rss' data-type='__sanitizer::uptr' data-ref="1069rss" data-ref-filename="1069rss">rss</dfn>) {</td></tr>
<tr><th id="239">239</th><td>    <a class="type" href="#__sanitizer::SizeClassAllocator64::RegionInfo" title='__sanitizer::SizeClassAllocator64::RegionInfo' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo">RegionInfo</a> *<dfn class="local col0 decl" id="1070region" title='region' data-type='__sanitizer::SizeClassAllocator64::RegionInfo *' data-ref="1070region" data-ref-filename="1070region">region</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetRegionInfo" title='__sanitizer::SizeClassAllocator64::GetRegionInfo' data-ref="__sanitizer::SizeClassAllocator64::GetRegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionInfo">GetRegionInfo</a>(<a class="local col8 ref" href="#1068class_id" title='class_id' data-ref="1068class_id" data-ref-filename="1068class_id">class_id</a>);</td></tr>
<tr><th id="240">240</th><td>    <b>if</b> (<a class="local col0 ref" href="#1070region" title='region' data-ref="1070region" data-ref-filename="1070region">region</a>-&gt;mapped_user == <var>0</var>) <b>return</b>;</td></tr>
<tr><th id="241">241</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col1 decl" id="1071in_use" title='in_use' data-type='__sanitizer::uptr' data-ref="1071in_use" data-ref-filename="1071in_use">in_use</dfn> = <a class="local col0 ref" href="#1070region" title='region' data-ref="1070region" data-ref-filename="1070region">region</a>-&gt;stats.n_allocated - <a class="local col0 ref" href="#1070region" title='region' data-ref="1070region" data-ref-filename="1070region">region</a>-&gt;stats.n_freed;</td></tr>
<tr><th id="242">242</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col2 decl" id="1072avail_chunks" title='avail_chunks' data-type='__sanitizer::uptr' data-ref="1072avail_chunks" data-ref-filename="1072avail_chunks">avail_chunks</dfn> = <a class="local col0 ref" href="#1070region" title='region' data-ref="1070region" data-ref-filename="1070region">region</a>-&gt;allocated_user / <a class="member fn" href="#__sanitizer::SizeClassAllocator64::ClassIdToSize" title='__sanitizer::SizeClassAllocator64::ClassIdToSize' data-ref="__sanitizer::SizeClassAllocator64::ClassIdToSize" data-ref-filename="__sanitizer..SizeClassAllocator64..ClassIdToSize">ClassIdToSize</a>(<a class="local col8 ref" href="#1068class_id" title='class_id' data-ref="1068class_id" data-ref-filename="1068class_id">class_id</a>);</td></tr>
<tr><th id="243">243</th><td>    Printf(</td></tr>
<tr><th id="244">244</th><td>        <q>"%s %02zd (%6zd): mapped: %6zdK allocs: %7zd frees: %7zd inuse: %6zd "</q></td></tr>
<tr><th id="245">245</th><td>        <q>"num_freed_chunks %7zd avail: %6zd rss: %6zdK releases: %6zd "</q></td></tr>
<tr><th id="246">246</th><td>        <q>"last released: %6zdK region: 0x%zx\n"</q>,</td></tr>
<tr><th id="247">247</th><td>        <a class="local col0 ref" href="#1070region" title='region' data-ref="1070region" data-ref-filename="1070region">region</a>-&gt;exhausted ? <q>"F"</q> : <q>" "</q>, <a class="local col8 ref" href="#1068class_id" title='class_id' data-ref="1068class_id" data-ref-filename="1068class_id">class_id</a>, <a class="member fn" href="#__sanitizer::SizeClassAllocator64::ClassIdToSize" title='__sanitizer::SizeClassAllocator64::ClassIdToSize' data-ref="__sanitizer::SizeClassAllocator64::ClassIdToSize" data-ref-filename="__sanitizer..SizeClassAllocator64..ClassIdToSize">ClassIdToSize</a>(<a class="local col8 ref" href="#1068class_id" title='class_id' data-ref="1068class_id" data-ref-filename="1068class_id">class_id</a>),</td></tr>
<tr><th id="248">248</th><td>        <a class="local col0 ref" href="#1070region" title='region' data-ref="1070region" data-ref-filename="1070region">region</a>-&gt;mapped_user &gt;&gt; <var>10</var>, <a class="local col0 ref" href="#1070region" title='region' data-ref="1070region" data-ref-filename="1070region">region</a>-&gt;stats.n_allocated,</td></tr>
<tr><th id="249">249</th><td>        <a class="local col0 ref" href="#1070region" title='region' data-ref="1070region" data-ref-filename="1070region">region</a>-&gt;stats.n_freed, <a class="local col1 ref" href="#1071in_use" title='in_use' data-ref="1071in_use" data-ref-filename="1071in_use">in_use</a>, <a class="local col0 ref" href="#1070region" title='region' data-ref="1070region" data-ref-filename="1070region">region</a>-&gt;num_freed_chunks, <a class="local col2 ref" href="#1072avail_chunks" title='avail_chunks' data-ref="1072avail_chunks" data-ref-filename="1072avail_chunks">avail_chunks</a>,</td></tr>
<tr><th id="250">250</th><td>        <a class="local col9 ref" href="#1069rss" title='rss' data-ref="1069rss" data-ref-filename="1069rss">rss</a> &gt;&gt; <var>10</var>, <a class="local col0 ref" href="#1070region" title='region' data-ref="1070region" data-ref-filename="1070region">region</a>-&gt;rtoi.num_releases,</td></tr>
<tr><th id="251">251</th><td>        <a class="local col0 ref" href="#1070region" title='region' data-ref="1070region" data-ref-filename="1070region">region</a>-&gt;rtoi.last_released_bytes &gt;&gt; <var>10</var>,</td></tr>
<tr><th id="252">252</th><td>        <a class="member fn" href="#__sanitizer::SizeClassAllocator64::SpaceBeg" title='__sanitizer::SizeClassAllocator64::SpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::SpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..SpaceBeg">SpaceBeg</a>() + <a class="member" href="#__sanitizer::SizeClassAllocator64::kRegionSize" title='__sanitizer::SizeClassAllocator64::kRegionSize' data-ref="__sanitizer::SizeClassAllocator64::kRegionSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kRegionSize">kRegionSize</a> * <a class="local col8 ref" href="#1068class_id" title='class_id' data-ref="1068class_id" data-ref-filename="1068class_id">class_id</a>);</td></tr>
<tr><th id="253">253</th><td>  }</td></tr>
<tr><th id="254">254</th><td></td></tr>
<tr><th id="255">255</th><td>  <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::PrintStats" title='__sanitizer::SizeClassAllocator64::PrintStats' data-ref="__sanitizer::SizeClassAllocator64::PrintStats" data-ref-filename="__sanitizer..SizeClassAllocator64..PrintStats">PrintStats</dfn>() {</td></tr>
<tr><th id="256">256</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col3 decl" id="1073rss_stats" title='rss_stats' data-type='__sanitizer::uptr [kNumClasses]' data-ref="1073rss_stats" data-ref-filename="1073rss_stats">rss_stats</dfn>[<a class="member" href="#__sanitizer::SizeClassAllocator64::kNumClasses" title='__sanitizer::SizeClassAllocator64::kNumClasses' data-ref="__sanitizer::SizeClassAllocator64::kNumClasses" data-ref-filename="__sanitizer..SizeClassAllocator64..kNumClasses">kNumClasses</a>];</td></tr>
<tr><th id="257">257</th><td>    <b>for</b> (<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col4 decl" id="1074class_id" title='class_id' data-type='__sanitizer::uptr' data-ref="1074class_id" data-ref-filename="1074class_id">class_id</dfn> = <var>0</var>; <a class="local col4 ref" href="#1074class_id" title='class_id' data-ref="1074class_id" data-ref-filename="1074class_id">class_id</a> &lt; <a class="member" href="#__sanitizer::SizeClassAllocator64::kNumClasses" title='__sanitizer::SizeClassAllocator64::kNumClasses' data-ref="__sanitizer::SizeClassAllocator64::kNumClasses" data-ref-filename="__sanitizer..SizeClassAllocator64..kNumClasses">kNumClasses</a>; <a class="local col4 ref" href="#1074class_id" title='class_id' data-ref="1074class_id" data-ref-filename="1074class_id">class_id</a>++)</td></tr>
<tr><th id="258">258</th><td>      <a class="local col3 ref" href="#1073rss_stats" title='rss_stats' data-ref="1073rss_stats" data-ref-filename="1073rss_stats">rss_stats</a>[<a class="local col4 ref" href="#1074class_id" title='class_id' data-ref="1074class_id" data-ref-filename="1074class_id">class_id</a>] = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::SpaceBeg" title='__sanitizer::SizeClassAllocator64::SpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::SpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..SpaceBeg">SpaceBeg</a>() + <a class="member" href="#__sanitizer::SizeClassAllocator64::kRegionSize" title='__sanitizer::SizeClassAllocator64::kRegionSize' data-ref="__sanitizer::SizeClassAllocator64::kRegionSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kRegionSize">kRegionSize</a> * <a class="local col4 ref" href="#1074class_id" title='class_id' data-ref="1074class_id" data-ref-filename="1074class_id">class_id</a>;</td></tr>
<tr><th id="259">259</th><td>    GetMemoryProfile(<a class="member fn" href="#__sanitizer::SizeClassAllocator64::FillMemoryProfile" title='__sanitizer::SizeClassAllocator64::FillMemoryProfile' data-ref="__sanitizer::SizeClassAllocator64::FillMemoryProfile" data-ref-filename="__sanitizer..SizeClassAllocator64..FillMemoryProfile">FillMemoryProfile</a>, <a class="local col3 ref" href="#1073rss_stats" title='rss_stats' data-ref="1073rss_stats" data-ref-filename="1073rss_stats">rss_stats</a>, <a class="member" href="#__sanitizer::SizeClassAllocator64::kNumClasses" title='__sanitizer::SizeClassAllocator64::kNumClasses' data-ref="__sanitizer::SizeClassAllocator64::kNumClasses" data-ref-filename="__sanitizer..SizeClassAllocator64..kNumClasses">kNumClasses</a>);</td></tr>
<tr><th id="260">260</th><td></td></tr>
<tr><th id="261">261</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col5 decl" id="1075total_mapped" title='total_mapped' data-type='__sanitizer::uptr' data-ref="1075total_mapped" data-ref-filename="1075total_mapped">total_mapped</dfn> = <var>0</var>;</td></tr>
<tr><th id="262">262</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col6 decl" id="1076total_rss" title='total_rss' data-type='__sanitizer::uptr' data-ref="1076total_rss" data-ref-filename="1076total_rss">total_rss</dfn> = <var>0</var>;</td></tr>
<tr><th id="263">263</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col7 decl" id="1077n_allocated" title='n_allocated' data-type='__sanitizer::uptr' data-ref="1077n_allocated" data-ref-filename="1077n_allocated">n_allocated</dfn> = <var>0</var>;</td></tr>
<tr><th id="264">264</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col8 decl" id="1078n_freed" title='n_freed' data-type='__sanitizer::uptr' data-ref="1078n_freed" data-ref-filename="1078n_freed">n_freed</dfn> = <var>0</var>;</td></tr>
<tr><th id="265">265</th><td>    <b>for</b> (<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col9 decl" id="1079class_id" title='class_id' data-type='__sanitizer::uptr' data-ref="1079class_id" data-ref-filename="1079class_id">class_id</dfn> = <var>1</var>; <a class="local col9 ref" href="#1079class_id" title='class_id' data-ref="1079class_id" data-ref-filename="1079class_id">class_id</a> &lt; <a class="member" href="#__sanitizer::SizeClassAllocator64::kNumClasses" title='__sanitizer::SizeClassAllocator64::kNumClasses' data-ref="__sanitizer::SizeClassAllocator64::kNumClasses" data-ref-filename="__sanitizer..SizeClassAllocator64..kNumClasses">kNumClasses</a>; <a class="local col9 ref" href="#1079class_id" title='class_id' data-ref="1079class_id" data-ref-filename="1079class_id">class_id</a>++) {</td></tr>
<tr><th id="266">266</th><td>      <a class="type" href="#__sanitizer::SizeClassAllocator64::RegionInfo" title='__sanitizer::SizeClassAllocator64::RegionInfo' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo">RegionInfo</a> *<dfn class="local col0 decl" id="1080region" title='region' data-type='__sanitizer::SizeClassAllocator64::RegionInfo *' data-ref="1080region" data-ref-filename="1080region">region</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetRegionInfo" title='__sanitizer::SizeClassAllocator64::GetRegionInfo' data-ref="__sanitizer::SizeClassAllocator64::GetRegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionInfo">GetRegionInfo</a>(<a class="local col9 ref" href="#1079class_id" title='class_id' data-ref="1079class_id" data-ref-filename="1079class_id">class_id</a>);</td></tr>
<tr><th id="267">267</th><td>      <b>if</b> (<a class="local col0 ref" href="#1080region" title='region' data-ref="1080region" data-ref-filename="1080region">region</a>-&gt;mapped_user != <var>0</var>) {</td></tr>
<tr><th id="268">268</th><td>        <a class="local col5 ref" href="#1075total_mapped" title='total_mapped' data-ref="1075total_mapped" data-ref-filename="1075total_mapped">total_mapped</a> += <a class="local col0 ref" href="#1080region" title='region' data-ref="1080region" data-ref-filename="1080region">region</a>-&gt;mapped_user;</td></tr>
<tr><th id="269">269</th><td>        <a class="local col6 ref" href="#1076total_rss" title='total_rss' data-ref="1076total_rss" data-ref-filename="1076total_rss">total_rss</a> += <a class="local col3 ref" href="#1073rss_stats" title='rss_stats' data-ref="1073rss_stats" data-ref-filename="1073rss_stats">rss_stats</a>[<a class="local col9 ref" href="#1079class_id" title='class_id' data-ref="1079class_id" data-ref-filename="1079class_id">class_id</a>];</td></tr>
<tr><th id="270">270</th><td>      }</td></tr>
<tr><th id="271">271</th><td>      <a class="local col7 ref" href="#1077n_allocated" title='n_allocated' data-ref="1077n_allocated" data-ref-filename="1077n_allocated">n_allocated</a> += <a class="local col0 ref" href="#1080region" title='region' data-ref="1080region" data-ref-filename="1080region">region</a>-&gt;stats.n_allocated;</td></tr>
<tr><th id="272">272</th><td>      <a class="local col8 ref" href="#1078n_freed" title='n_freed' data-ref="1078n_freed" data-ref-filename="1078n_freed">n_freed</a> += <a class="local col0 ref" href="#1080region" title='region' data-ref="1080region" data-ref-filename="1080region">region</a>-&gt;stats.n_freed;</td></tr>
<tr><th id="273">273</th><td>    }</td></tr>
<tr><th id="274">274</th><td></td></tr>
<tr><th id="275">275</th><td>    <a class="ref fn" href="sanitizer_common.h.html#__sanitizer::Printf" title='__sanitizer::Printf' data-ref="__sanitizer::Printf" data-ref-filename="__sanitizer..Printf">Printf</a>(<q>"Stats: SizeClassAllocator64: %zdM mapped (%zdM rss) in "</q></td></tr>
<tr><th id="276">276</th><td>           <q>"%zd allocations; remains %zd\n"</q>, <a class="local col5 ref" href="#1075total_mapped" title='total_mapped' data-ref="1075total_mapped" data-ref-filename="1075total_mapped">total_mapped</a> &gt;&gt; <var>20</var>,</td></tr>
<tr><th id="277">277</th><td>           <a class="local col6 ref" href="#1076total_rss" title='total_rss' data-ref="1076total_rss" data-ref-filename="1076total_rss">total_rss</a> &gt;&gt; <var>20</var>, <a class="local col7 ref" href="#1077n_allocated" title='n_allocated' data-ref="1077n_allocated" data-ref-filename="1077n_allocated">n_allocated</a>, <a class="local col7 ref" href="#1077n_allocated" title='n_allocated' data-ref="1077n_allocated" data-ref-filename="1077n_allocated">n_allocated</a> - <a class="local col8 ref" href="#1078n_freed" title='n_freed' data-ref="1078n_freed" data-ref-filename="1078n_freed">n_freed</a>);</td></tr>
<tr><th id="278">278</th><td>    <b>for</b> (<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col1 decl" id="1081class_id" title='class_id' data-type='__sanitizer::uptr' data-ref="1081class_id" data-ref-filename="1081class_id">class_id</dfn> = <var>1</var>; <a class="local col1 ref" href="#1081class_id" title='class_id' data-ref="1081class_id" data-ref-filename="1081class_id">class_id</a> &lt; <a class="member" href="#__sanitizer::SizeClassAllocator64::kNumClasses" title='__sanitizer::SizeClassAllocator64::kNumClasses' data-ref="__sanitizer::SizeClassAllocator64::kNumClasses" data-ref-filename="__sanitizer..SizeClassAllocator64..kNumClasses">kNumClasses</a>; <a class="local col1 ref" href="#1081class_id" title='class_id' data-ref="1081class_id" data-ref-filename="1081class_id">class_id</a>++)</td></tr>
<tr><th id="279">279</th><td>      PrintStats(<a class="local col1 ref" href="#1081class_id" title='class_id' data-ref="1081class_id" data-ref-filename="1081class_id">class_id</a>, <a class="local col3 ref" href="#1073rss_stats" title='rss_stats' data-ref="1073rss_stats" data-ref-filename="1073rss_stats">rss_stats</a>[<a class="local col1 ref" href="#1081class_id" title='class_id' data-ref="1081class_id" data-ref-filename="1081class_id">class_id</a>]);</td></tr>
<tr><th id="280">280</th><td>  }</td></tr>
<tr><th id="281">281</th><td></td></tr>
<tr><th id="282">282</th><td>  <i>// ForceLock() and ForceUnlock() are needed to implement Darwin malloc zone</i></td></tr>
<tr><th id="283">283</th><td><i>  // introspection API.</i></td></tr>
<tr><th id="284">284</th><td>  <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::ForceLock" title='__sanitizer::SizeClassAllocator64::ForceLock' data-ref="__sanitizer::SizeClassAllocator64::ForceLock" data-ref-filename="__sanitizer..SizeClassAllocator64..ForceLock">ForceLock</dfn>() {</td></tr>
<tr><th id="285">285</th><td>    <b>for</b> (<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col2 decl" id="1082i" title='i' data-type='__sanitizer::uptr' data-ref="1082i" data-ref-filename="1082i">i</dfn> = <var>0</var>; <a class="local col2 ref" href="#1082i" title='i' data-ref="1082i" data-ref-filename="1082i">i</a> &lt; <a class="member" href="#__sanitizer::SizeClassAllocator64::kNumClasses" title='__sanitizer::SizeClassAllocator64::kNumClasses' data-ref="__sanitizer::SizeClassAllocator64::kNumClasses" data-ref-filename="__sanitizer..SizeClassAllocator64..kNumClasses">kNumClasses</a>; <a class="local col2 ref" href="#1082i" title='i' data-ref="1082i" data-ref-filename="1082i">i</a>++) {</td></tr>
<tr><th id="286">286</th><td>      <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetRegionInfo" title='__sanitizer::SizeClassAllocator64::GetRegionInfo' data-ref="__sanitizer::SizeClassAllocator64::GetRegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionInfo">GetRegionInfo</a>(<a class="local col2 ref" href="#1082i" title='i' data-ref="1082i" data-ref-filename="1082i">i</a>)-&gt;mutex.Lock();</td></tr>
<tr><th id="287">287</th><td>    }</td></tr>
<tr><th id="288">288</th><td>  }</td></tr>
<tr><th id="289">289</th><td></td></tr>
<tr><th id="290">290</th><td>  <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::ForceUnlock" title='__sanitizer::SizeClassAllocator64::ForceUnlock' data-ref="__sanitizer::SizeClassAllocator64::ForceUnlock" data-ref-filename="__sanitizer..SizeClassAllocator64..ForceUnlock">ForceUnlock</dfn>() {</td></tr>
<tr><th id="291">291</th><td>    <b>for</b> (<em>int</em> <dfn class="local col3 decl" id="1083i" title='i' data-type='int' data-ref="1083i" data-ref-filename="1083i">i</dfn> = (<em>int</em>)<a class="member" href="#__sanitizer::SizeClassAllocator64::kNumClasses" title='__sanitizer::SizeClassAllocator64::kNumClasses' data-ref="__sanitizer::SizeClassAllocator64::kNumClasses" data-ref-filename="__sanitizer..SizeClassAllocator64..kNumClasses">kNumClasses</a> - <var>1</var>; <a class="local col3 ref" href="#1083i" title='i' data-ref="1083i" data-ref-filename="1083i">i</a> &gt;= <var>0</var>; <a class="local col3 ref" href="#1083i" title='i' data-ref="1083i" data-ref-filename="1083i">i</a>--) {</td></tr>
<tr><th id="292">292</th><td>      <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetRegionInfo" title='__sanitizer::SizeClassAllocator64::GetRegionInfo' data-ref="__sanitizer::SizeClassAllocator64::GetRegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionInfo">GetRegionInfo</a>(<a class="local col3 ref" href="#1083i" title='i' data-ref="1083i" data-ref-filename="1083i">i</a>)-&gt;mutex.Unlock();</td></tr>
<tr><th id="293">293</th><td>    }</td></tr>
<tr><th id="294">294</th><td>  }</td></tr>
<tr><th id="295">295</th><td></td></tr>
<tr><th id="296">296</th><td>  <i>// Iterate over all existing chunks.</i></td></tr>
<tr><th id="297">297</th><td><i>  // The allocator must be locked when calling this function.</i></td></tr>
<tr><th id="298">298</th><td>  <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::ForEachChunk" title='__sanitizer::SizeClassAllocator64::ForEachChunk' data-ref="__sanitizer::SizeClassAllocator64::ForEachChunk" data-ref-filename="__sanitizer..SizeClassAllocator64..ForEachChunk">ForEachChunk</dfn>(<a class="typedef" href="sanitizer_allocator.h.html#__sanitizer::ForEachChunkCallback" title='__sanitizer::ForEachChunkCallback' data-type='void (*)(__sanitizer::uptr, void *)' data-ref="__sanitizer::ForEachChunkCallback" data-ref-filename="__sanitizer..ForEachChunkCallback">ForEachChunkCallback</a> <dfn class="local col4 decl" id="1084callback" title='callback' data-type='__sanitizer::ForEachChunkCallback' data-ref="1084callback" data-ref-filename="1084callback">callback</dfn>, <em>void</em> *<dfn class="local col5 decl" id="1085arg" title='arg' data-type='void *' data-ref="1085arg" data-ref-filename="1085arg">arg</dfn>) {</td></tr>
<tr><th id="299">299</th><td>    <b>for</b> (<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col6 decl" id="1086class_id" title='class_id' data-type='__sanitizer::uptr' data-ref="1086class_id" data-ref-filename="1086class_id">class_id</dfn> = <var>1</var>; <a class="local col6 ref" href="#1086class_id" title='class_id' data-ref="1086class_id" data-ref-filename="1086class_id">class_id</a> &lt; <a class="member" href="#__sanitizer::SizeClassAllocator64::kNumClasses" title='__sanitizer::SizeClassAllocator64::kNumClasses' data-ref="__sanitizer::SizeClassAllocator64::kNumClasses" data-ref-filename="__sanitizer..SizeClassAllocator64..kNumClasses">kNumClasses</a>; <a class="local col6 ref" href="#1086class_id" title='class_id' data-ref="1086class_id" data-ref-filename="1086class_id">class_id</a>++) {</td></tr>
<tr><th id="300">300</th><td>      <a class="type" href="#__sanitizer::SizeClassAllocator64::RegionInfo" title='__sanitizer::SizeClassAllocator64::RegionInfo' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo">RegionInfo</a> *<dfn class="local col7 decl" id="1087region" title='region' data-type='__sanitizer::SizeClassAllocator64::RegionInfo *' data-ref="1087region" data-ref-filename="1087region">region</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetRegionInfo" title='__sanitizer::SizeClassAllocator64::GetRegionInfo' data-ref="__sanitizer::SizeClassAllocator64::GetRegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionInfo">GetRegionInfo</a>(<a class="local col6 ref" href="#1086class_id" title='class_id' data-ref="1086class_id" data-ref-filename="1086class_id">class_id</a>);</td></tr>
<tr><th id="301">301</th><td>      <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col8 decl" id="1088chunk_size" title='chunk_size' data-type='__sanitizer::uptr' data-ref="1088chunk_size" data-ref-filename="1088chunk_size">chunk_size</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::ClassIdToSize" title='__sanitizer::SizeClassAllocator64::ClassIdToSize' data-ref="__sanitizer::SizeClassAllocator64::ClassIdToSize" data-ref-filename="__sanitizer..SizeClassAllocator64..ClassIdToSize">ClassIdToSize</a>(<a class="local col6 ref" href="#1086class_id" title='class_id' data-ref="1086class_id" data-ref-filename="1086class_id">class_id</a>);</td></tr>
<tr><th id="302">302</th><td>      <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col9 decl" id="1089region_beg" title='region_beg' data-type='__sanitizer::uptr' data-ref="1089region_beg" data-ref-filename="1089region_beg">region_beg</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::SpaceBeg" title='__sanitizer::SizeClassAllocator64::SpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::SpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..SpaceBeg">SpaceBeg</a>() + <a class="local col6 ref" href="#1086class_id" title='class_id' data-ref="1086class_id" data-ref-filename="1086class_id">class_id</a> * <a class="member" href="#__sanitizer::SizeClassAllocator64::kRegionSize" title='__sanitizer::SizeClassAllocator64::kRegionSize' data-ref="__sanitizer::SizeClassAllocator64::kRegionSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kRegionSize">kRegionSize</a>;</td></tr>
<tr><th id="303">303</th><td>      <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col0 decl" id="1090region_allocated_user_size" title='region_allocated_user_size' data-type='__sanitizer::uptr' data-ref="1090region_allocated_user_size" data-ref-filename="1090region_allocated_user_size">region_allocated_user_size</dfn> =</td></tr>
<tr><th id="304">304</th><td>          <a class="typedef" href="#__sanitizer::SizeClassAllocator64::AddressSpaceView" title='__sanitizer::SizeClassAllocator64::AddressSpaceView' data-type='typename Params::AddressSpaceView' data-ref="__sanitizer::SizeClassAllocator64::AddressSpaceView" data-ref-filename="__sanitizer..SizeClassAllocator64..AddressSpaceView">AddressSpaceView</a>::Load(<a class="local col7 ref" href="#1087region" title='region' data-ref="1087region" data-ref-filename="1087region">region</a>)-&gt;allocated_user;</td></tr>
<tr><th id="305">305</th><td>      <b>for</b> (<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col1 decl" id="1091chunk" title='chunk' data-type='__sanitizer::uptr' data-ref="1091chunk" data-ref-filename="1091chunk">chunk</dfn> = <a class="local col9 ref" href="#1089region_beg" title='region_beg' data-ref="1089region_beg" data-ref-filename="1089region_beg">region_beg</a>;</td></tr>
<tr><th id="306">306</th><td>           <a class="local col1 ref" href="#1091chunk" title='chunk' data-ref="1091chunk" data-ref-filename="1091chunk">chunk</a> &lt; <a class="local col9 ref" href="#1089region_beg" title='region_beg' data-ref="1089region_beg" data-ref-filename="1089region_beg">region_beg</a> + <a class="local col0 ref" href="#1090region_allocated_user_size" title='region_allocated_user_size' data-ref="1090region_allocated_user_size" data-ref-filename="1090region_allocated_user_size">region_allocated_user_size</a>;</td></tr>
<tr><th id="307">307</th><td>           <a class="local col1 ref" href="#1091chunk" title='chunk' data-ref="1091chunk" data-ref-filename="1091chunk">chunk</a> += <a class="local col8 ref" href="#1088chunk_size" title='chunk_size' data-ref="1088chunk_size" data-ref-filename="1088chunk_size">chunk_size</a>) {</td></tr>
<tr><th id="308">308</th><td>        <i>// Too slow: CHECK_EQ((void *)chunk, GetBlockBegin((void *)chunk));</i></td></tr>
<tr><th id="309">309</th><td>        <a class="local col4 ref" href="#1084callback" title='callback' data-ref="1084callback" data-ref-filename="1084callback">callback</a>(<a class="local col1 ref" href="#1091chunk" title='chunk' data-ref="1091chunk" data-ref-filename="1091chunk">chunk</a>, <a class="local col5 ref" href="#1085arg" title='arg' data-ref="1085arg" data-ref-filename="1085arg">arg</a>);</td></tr>
<tr><th id="310">310</th><td>      }</td></tr>
<tr><th id="311">311</th><td>    }</td></tr>
<tr><th id="312">312</th><td>  }</td></tr>
<tr><th id="313">313</th><td></td></tr>
<tr><th id="314">314</th><td>  <em>static</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::ClassIdToSize" title='__sanitizer::SizeClassAllocator64::ClassIdToSize' data-ref="__sanitizer::SizeClassAllocator64::ClassIdToSize" data-ref-filename="__sanitizer..SizeClassAllocator64..ClassIdToSize">ClassIdToSize</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col2 decl" id="1092class_id" title='class_id' data-type='__sanitizer::uptr' data-ref="1092class_id" data-ref-filename="1092class_id">class_id</dfn>) {</td></tr>
<tr><th id="315">315</th><td>    <b>return</b> <a class="typedef" href="#__sanitizer::SizeClassAllocator64::SizeClassMap" title='__sanitizer::SizeClassAllocator64::SizeClassMap' data-type='typename Params::SizeClassMap' data-ref="__sanitizer::SizeClassAllocator64::SizeClassMap" data-ref-filename="__sanitizer..SizeClassAllocator64..SizeClassMap">SizeClassMap</a>::Size(<a class="local col2 ref" href="#1092class_id" title='class_id' data-ref="1092class_id" data-ref-filename="1092class_id">class_id</a>);</td></tr>
<tr><th id="316">316</th><td>  }</td></tr>
<tr><th id="317">317</th><td></td></tr>
<tr><th id="318">318</th><td>  <em>static</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::AdditionalSize" title='__sanitizer::SizeClassAllocator64::AdditionalSize' data-ref="__sanitizer::SizeClassAllocator64::AdditionalSize" data-ref-filename="__sanitizer..SizeClassAllocator64..AdditionalSize">AdditionalSize</dfn>() {</td></tr>
<tr><th id="319">319</th><td>    <b>return</b> <a class="ref fn" href="sanitizer_common.h.html#__sanitizer::RoundUpTo" title='__sanitizer::RoundUpTo' data-ref="__sanitizer::RoundUpTo" data-ref-filename="__sanitizer..RoundUpTo">RoundUpTo</a>(<b>sizeof</b>(<a class="type" href="#__sanitizer::SizeClassAllocator64::RegionInfo" title='__sanitizer::SizeClassAllocator64::RegionInfo' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo">RegionInfo</a>) * <a class="member" href="#__sanitizer::SizeClassAllocator64::kNumClassesRounded" title='__sanitizer::SizeClassAllocator64::kNumClassesRounded' data-ref="__sanitizer::SizeClassAllocator64::kNumClassesRounded" data-ref-filename="__sanitizer..SizeClassAllocator64..kNumClassesRounded">kNumClassesRounded</a>,</td></tr>
<tr><th id="320">320</th><td>                     <a class="ref fn" href="sanitizer_common.h.html#__sanitizer::GetPageSizeCached" title='__sanitizer::GetPageSizeCached' data-ref="__sanitizer::GetPageSizeCached" data-ref-filename="__sanitizer..GetPageSizeCached">GetPageSizeCached</a>());</td></tr>
<tr><th id="321">321</th><td>  }</td></tr>
<tr><th id="322">322</th><td></td></tr>
<tr><th id="323">323</th><td>  <b>typedef</b> <a class="typedef" href="#__sanitizer::SizeClassAllocator64::SizeClassMap" title='__sanitizer::SizeClassAllocator64::SizeClassMap' data-type='typename Params::SizeClassMap' data-ref="__sanitizer::SizeClassAllocator64::SizeClassMap" data-ref-filename="__sanitizer..SizeClassAllocator64..SizeClassMap">SizeClassMap</a> <dfn class="typedef" id="__sanitizer::SizeClassAllocator64::SizeClassMapT" title='__sanitizer::SizeClassAllocator64::SizeClassMapT' data-type='__sanitizer::SizeClassAllocator64::SizeClassMap' data-ref="__sanitizer::SizeClassAllocator64::SizeClassMapT" data-ref-filename="__sanitizer..SizeClassAllocator64..SizeClassMapT">SizeClassMapT</dfn>;</td></tr>
<tr><th id="324">324</th><td>  <em>static</em> <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl" id="__sanitizer::SizeClassAllocator64::kNumClasses" title='__sanitizer::SizeClassAllocator64::kNumClasses' data-ref="__sanitizer::SizeClassAllocator64::kNumClasses" data-ref-filename="__sanitizer..SizeClassAllocator64..kNumClasses">kNumClasses</dfn> = <a class="typedef" href="#__sanitizer::SizeClassAllocator64::SizeClassMap" title='__sanitizer::SizeClassAllocator64::SizeClassMap' data-type='typename Params::SizeClassMap' data-ref="__sanitizer::SizeClassAllocator64::SizeClassMap" data-ref-filename="__sanitizer..SizeClassAllocator64..SizeClassMap">SizeClassMap</a>::kNumClasses;</td></tr>
<tr><th id="325">325</th><td>  <em>static</em> <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl" id="__sanitizer::SizeClassAllocator64::kNumClassesRounded" title='__sanitizer::SizeClassAllocator64::kNumClassesRounded' data-ref="__sanitizer::SizeClassAllocator64::kNumClassesRounded" data-ref-filename="__sanitizer..SizeClassAllocator64..kNumClassesRounded">kNumClassesRounded</dfn> = <a class="typedef" href="#__sanitizer::SizeClassAllocator64::SizeClassMap" title='__sanitizer::SizeClassAllocator64::SizeClassMap' data-type='typename Params::SizeClassMap' data-ref="__sanitizer::SizeClassAllocator64::SizeClassMap" data-ref-filename="__sanitizer..SizeClassAllocator64..SizeClassMap">SizeClassMap</a>::kNumClassesRounded;</td></tr>
<tr><th id="326">326</th><td></td></tr>
<tr><th id="327">327</th><td>  <i>// A packed array of counters. Each counter occupies 2^n bits, enough to store</i></td></tr>
<tr><th id="328">328</th><td><i>  // counter's max_value. Ctor will try to allocate the required buffer via</i></td></tr>
<tr><th id="329">329</th><td><i>  // mapper-&gt;MapPackedCounterArrayBuffer and the caller is expected to check</i></td></tr>
<tr><th id="330">330</th><td><i>  // whether the initialization was successful by checking IsAllocated() result.</i></td></tr>
<tr><th id="331">331</th><td><i>  // For the performance sake, none of the accessors check the validity of the</i></td></tr>
<tr><th id="332">332</th><td><i>  // arguments, it is assumed that index is always in [0, n) range and the value</i></td></tr>
<tr><th id="333">333</th><td><i>  // is not incremented past max_value.</i></td></tr>
<tr><th id="334">334</th><td>  <b>template</b>&lt;<b>class</b> MemoryMapperT&gt;</td></tr>
<tr><th id="335">335</th><td>  <b>class</b> <dfn class="type def" id="__sanitizer::SizeClassAllocator64::PackedCounterArray" title='__sanitizer::SizeClassAllocator64::PackedCounterArray' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray">PackedCounterArray</dfn> {</td></tr>
<tr><th id="336">336</th><td>   <b>public</b>:</td></tr>
<tr><th id="337">337</th><td>    <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::PackedCounterArray::PackedCounterArray{MemoryMapperT}" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::PackedCounterArray&lt;MemoryMapperT&gt;' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::PackedCounterArray{MemoryMapperT}" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..PackedCounterArray{MemoryMapperT}">PackedCounterArray</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::u64" title='__sanitizer::u64' data-type='unsigned long long' data-ref="__sanitizer::u64" data-ref-filename="__sanitizer..u64">u64</a> <dfn class="local col3 decl" id="1093num_counters" title='num_counters' data-type='__sanitizer::u64' data-ref="1093num_counters" data-ref-filename="1093num_counters">num_counters</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::u64" title='__sanitizer::u64' data-type='unsigned long long' data-ref="__sanitizer::u64" data-ref-filename="__sanitizer..u64">u64</a> <dfn class="local col4 decl" id="1094max_value" title='max_value' data-type='__sanitizer::u64' data-ref="1094max_value" data-ref-filename="1094max_value">max_value</dfn>, MemoryMapperT *<dfn class="local col5 decl" id="1095mapper" title='mapper' data-type='MemoryMapperT *' data-ref="1095mapper" data-ref-filename="1095mapper">mapper</dfn>)</td></tr>
<tr><th id="338">338</th><td>        : <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::n" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::n' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::n" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..n">n</a>(<a class="local col3 ref" href="#1093num_counters" title='num_counters' data-ref="1093num_counters" data-ref-filename="1093num_counters">num_counters</a>), <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::memory_mapper" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::memory_mapper' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::memory_mapper" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..memory_mapper">memory_mapper</a>(<a class="local col5 ref" href="#1095mapper" title='mapper' data-ref="1095mapper" data-ref-filename="1095mapper">mapper</a>) {</td></tr>
<tr><th id="339">339</th><td>      <a class="macro" href="sanitizer_internal_defs.h.html#304" title="do { __sanitizer::u64 v1 = (__sanitizer::u64)((num_counters)); __sanitizer::u64 v2 = (__sanitizer::u64)((0)); if (__builtin_expect(!!(!(v1 &gt; v2)), 0)) __sanitizer::CheckFailed(&quot;/fast/tmp/llvm-proj-12/compiler-rt/lib/asan/../sanitizer_common/sanitizer_allocator_primary64.h&quot;, 339, &quot;(&quot; &quot;(num_counters)&quot; &quot;) &quot; &quot;&gt;&quot; &quot; (&quot; &quot;(0)&quot; &quot;)&quot;, v1, v2); } while (false)" data-ref="_M/CHECK_GT">CHECK_GT</a>(<a class="local col3 ref" href="#1093num_counters" title='num_counters' data-ref="1093num_counters" data-ref-filename="1093num_counters">num_counters</a>, <var>0</var>);</td></tr>
<tr><th id="340">340</th><td>      <a class="macro" href="sanitizer_internal_defs.h.html#304" title="do { __sanitizer::u64 v1 = (__sanitizer::u64)((max_value)); __sanitizer::u64 v2 = (__sanitizer::u64)((0)); if (__builtin_expect(!!(!(v1 &gt; v2)), 0)) __sanitizer::CheckFailed(&quot;/fast/tmp/llvm-proj-12/compiler-rt/lib/asan/../sanitizer_common/sanitizer_allocator_primary64.h&quot;, 340, &quot;(&quot; &quot;(max_value)&quot; &quot;) &quot; &quot;&gt;&quot; &quot; (&quot; &quot;(0)&quot; &quot;)&quot;, v1, v2); } while (false)" data-ref="_M/CHECK_GT">CHECK_GT</a>(<a class="local col4 ref" href="#1094max_value" title='max_value' data-ref="1094max_value" data-ref-filename="1094max_value">max_value</a>, <var>0</var>);</td></tr>
<tr><th id="341">341</th><td>      <b>constexpr</b> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::u64" title='__sanitizer::u64' data-type='unsigned long long' data-ref="__sanitizer::u64" data-ref-filename="__sanitizer..u64">u64</a> <dfn class="local col6 decl" id="1096kMaxCounterBits" title='kMaxCounterBits' data-type='const __sanitizer::u64' data-ref="1096kMaxCounterBits" data-ref-filename="1096kMaxCounterBits">kMaxCounterBits</dfn> = <b>sizeof</b>(*<a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..buffer">buffer</a>) * <var>8ULL</var>;</td></tr>
<tr><th id="342">342</th><td>      <i>// Rounding counter storage size up to the power of two allows for using</i></td></tr>
<tr><th id="343">343</th><td><i>      // bit shifts calculating particular counter's index and offset.</i></td></tr>
<tr><th id="344">344</th><td>      <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col7 decl" id="1097counter_size_bits" title='counter_size_bits' data-type='__sanitizer::uptr' data-ref="1097counter_size_bits" data-ref-filename="1097counter_size_bits">counter_size_bits</dfn> =</td></tr>
<tr><th id="345">345</th><td>          <a class="ref fn" href="sanitizer_common.h.html#__sanitizer::RoundUpToPowerOfTwo" title='__sanitizer::RoundUpToPowerOfTwo' data-ref="__sanitizer::RoundUpToPowerOfTwo" data-ref-filename="__sanitizer..RoundUpToPowerOfTwo">RoundUpToPowerOfTwo</a>(<a class="ref fn" href="sanitizer_common.h.html#__sanitizer::MostSignificantSetBitIndex" title='__sanitizer::MostSignificantSetBitIndex' data-ref="__sanitizer::MostSignificantSetBitIndex" data-ref-filename="__sanitizer..MostSignificantSetBitIndex">MostSignificantSetBitIndex</a>(<a class="local col4 ref" href="#1094max_value" title='max_value' data-ref="1094max_value" data-ref-filename="1094max_value">max_value</a>) + <var>1</var>);</td></tr>
<tr><th id="346">346</th><td>      <a class="macro" href="sanitizer_internal_defs.h.html#303" title="do { __sanitizer::u64 v1 = (__sanitizer::u64)((counter_size_bits)); __sanitizer::u64 v2 = (__sanitizer::u64)((kMaxCounterBits)); if (__builtin_expect(!!(!(v1 &lt;= v2)), 0)) __sanitizer::CheckFailed(&quot;/fast/tmp/llvm-proj-12/compiler-rt/lib/asan/../sanitizer_common/sanitizer_allocator_primary64.h&quot;, 346, &quot;(&quot; &quot;(counter_size_bits)&quot; &quot;) &quot; &quot;&lt;=&quot; &quot; (&quot; &quot;(kMaxCounterBits)&quot; &quot;)&quot;, v1, v2); } while (false)" data-ref="_M/CHECK_LE">CHECK_LE</a>(<a class="local col7 ref" href="#1097counter_size_bits" title='counter_size_bits' data-ref="1097counter_size_bits" data-ref-filename="1097counter_size_bits">counter_size_bits</a>, <a class="local col6 ref" href="#1096kMaxCounterBits" title='kMaxCounterBits' data-ref="1096kMaxCounterBits" data-ref-filename="1096kMaxCounterBits">kMaxCounterBits</a>);</td></tr>
<tr><th id="347">347</th><td>      <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_size_bits_log" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_size_bits_log' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_size_bits_log" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..counter_size_bits_log">counter_size_bits_log</a> = <a class="ref fn" href="sanitizer_common.h.html#__sanitizer::Log2" title='__sanitizer::Log2' data-ref="__sanitizer::Log2" data-ref-filename="__sanitizer..Log2">Log2</a>(<a class="local col7 ref" href="#1097counter_size_bits" title='counter_size_bits' data-ref="1097counter_size_bits" data-ref-filename="1097counter_size_bits">counter_size_bits</a>);</td></tr>
<tr><th id="348">348</th><td>      <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_mask" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_mask' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_mask" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..counter_mask">counter_mask</a> = ~<var>0ULL</var> &gt;&gt; (<a class="local col6 ref" href="#1096kMaxCounterBits" title='kMaxCounterBits' data-ref="1096kMaxCounterBits" data-ref-filename="1096kMaxCounterBits">kMaxCounterBits</a> - <a class="local col7 ref" href="#1097counter_size_bits" title='counter_size_bits' data-ref="1097counter_size_bits" data-ref-filename="1097counter_size_bits">counter_size_bits</a>);</td></tr>
<tr><th id="349">349</th><td></td></tr>
<tr><th id="350">350</th><td>      <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col8 decl" id="1098packing_ratio" title='packing_ratio' data-type='__sanitizer::uptr' data-ref="1098packing_ratio" data-ref-filename="1098packing_ratio">packing_ratio</dfn> = <a class="local col6 ref" href="#1096kMaxCounterBits" title='kMaxCounterBits' data-ref="1096kMaxCounterBits" data-ref-filename="1096kMaxCounterBits">kMaxCounterBits</a> &gt;&gt; <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_size_bits_log" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_size_bits_log' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_size_bits_log" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..counter_size_bits_log">counter_size_bits_log</a>;</td></tr>
<tr><th id="351">351</th><td>      <a class="macro" href="sanitizer_internal_defs.h.html#304" title="do { __sanitizer::u64 v1 = (__sanitizer::u64)((packing_ratio)); __sanitizer::u64 v2 = (__sanitizer::u64)((0)); if (__builtin_expect(!!(!(v1 &gt; v2)), 0)) __sanitizer::CheckFailed(&quot;/fast/tmp/llvm-proj-12/compiler-rt/lib/asan/../sanitizer_common/sanitizer_allocator_primary64.h&quot;, 351, &quot;(&quot; &quot;(packing_ratio)&quot; &quot;) &quot; &quot;&gt;&quot; &quot; (&quot; &quot;(0)&quot; &quot;)&quot;, v1, v2); } while (false)" data-ref="_M/CHECK_GT">CHECK_GT</a>(<a class="local col8 ref" href="#1098packing_ratio" title='packing_ratio' data-ref="1098packing_ratio" data-ref-filename="1098packing_ratio">packing_ratio</a>, <var>0</var>);</td></tr>
<tr><th id="352">352</th><td>      <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::packing_ratio_log" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::packing_ratio_log' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::packing_ratio_log" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..packing_ratio_log">packing_ratio_log</a> = <a class="ref fn" href="sanitizer_common.h.html#__sanitizer::Log2" title='__sanitizer::Log2' data-ref="__sanitizer::Log2" data-ref-filename="__sanitizer..Log2">Log2</a>(<a class="local col8 ref" href="#1098packing_ratio" title='packing_ratio' data-ref="1098packing_ratio" data-ref-filename="1098packing_ratio">packing_ratio</a>);</td></tr>
<tr><th id="353">353</th><td>      <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::bit_offset_mask" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::bit_offset_mask' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::bit_offset_mask" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..bit_offset_mask">bit_offset_mask</a> = <a class="local col8 ref" href="#1098packing_ratio" title='packing_ratio' data-ref="1098packing_ratio" data-ref-filename="1098packing_ratio">packing_ratio</a> - <var>1</var>;</td></tr>
<tr><th id="354">354</th><td></td></tr>
<tr><th id="355">355</th><td>      <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer_size" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer_size' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer_size" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..buffer_size">buffer_size</a> =</td></tr>
<tr><th id="356">356</th><td>          (<a class="ref fn" href="sanitizer_common.h.html#__sanitizer::RoundUpTo" title='__sanitizer::RoundUpTo' data-ref="__sanitizer::RoundUpTo" data-ref-filename="__sanitizer..RoundUpTo">RoundUpTo</a>(<a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::n" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::n' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::n" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..n">n</a>, <var>1ULL</var> &lt;&lt; <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::packing_ratio_log" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::packing_ratio_log' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::packing_ratio_log" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..packing_ratio_log">packing_ratio_log</a>) &gt;&gt; <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::packing_ratio_log" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::packing_ratio_log' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::packing_ratio_log" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..packing_ratio_log">packing_ratio_log</a>) *</td></tr>
<tr><th id="357">357</th><td>          <b>sizeof</b>(*<a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..buffer">buffer</a>);</td></tr>
<tr><th id="358">358</th><td>      <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..buffer">buffer</a> = <b>reinterpret_cast</b>&lt;<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::u64" title='__sanitizer::u64' data-type='unsigned long long' data-ref="__sanitizer::u64" data-ref-filename="__sanitizer..u64">u64</a>*&gt;(</td></tr>
<tr><th id="359">359</th><td>          <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::memory_mapper" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::memory_mapper' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::memory_mapper" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..memory_mapper">memory_mapper</a>-&gt;MapPackedCounterArrayBuffer(<a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer_size" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer_size' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer_size" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..buffer_size">buffer_size</a>));</td></tr>
<tr><th id="360">360</th><td>    }</td></tr>
<tr><th id="361">361</th><td>    <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::PackedCounterArray::~PackedCounterArray{MemoryMapperT}" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::~PackedCounterArray&lt;MemoryMapperT&gt;' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::~PackedCounterArray{MemoryMapperT}" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..~PackedCounterArray{MemoryMapperT}">~PackedCounterArray</dfn>() {</td></tr>
<tr><th id="362">362</th><td>      <b>if</b> (<a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..buffer">buffer</a>) {</td></tr>
<tr><th id="363">363</th><td>        <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::memory_mapper" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::memory_mapper' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::memory_mapper" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..memory_mapper">memory_mapper</a>-&gt;UnmapPackedCounterArrayBuffer(</td></tr>
<tr><th id="364">364</th><td>            <b>reinterpret_cast</b>&lt;<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a>&gt;(<a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..buffer">buffer</a>), <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer_size" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer_size' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer_size" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..buffer_size">buffer_size</a>);</td></tr>
<tr><th id="365">365</th><td>      }</td></tr>
<tr><th id="366">366</th><td>    }</td></tr>
<tr><th id="367">367</th><td></td></tr>
<tr><th id="368">368</th><td>    <em>bool</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::PackedCounterArray::IsAllocated" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::IsAllocated' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::IsAllocated" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..IsAllocated">IsAllocated</dfn>() <em>const</em> {</td></tr>
<tr><th id="369">369</th><td>      <b>return</b> !!<a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..buffer">buffer</a>;</td></tr>
<tr><th id="370">370</th><td>    }</td></tr>
<tr><th id="371">371</th><td></td></tr>
<tr><th id="372">372</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::u64" title='__sanitizer::u64' data-type='unsigned long long' data-ref="__sanitizer::u64" data-ref-filename="__sanitizer..u64">u64</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::PackedCounterArray::GetCount" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::GetCount' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::GetCount" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..GetCount">GetCount</dfn>() <em>const</em> {</td></tr>
<tr><th id="373">373</th><td>      <b>return</b> <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::n" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::n' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::n" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..n">n</a>;</td></tr>
<tr><th id="374">374</th><td>    }</td></tr>
<tr><th id="375">375</th><td></td></tr>
<tr><th id="376">376</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::PackedCounterArray::Get" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::Get' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::Get" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..Get">Get</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col9 decl" id="1099i" title='i' data-type='__sanitizer::uptr' data-ref="1099i" data-ref-filename="1099i">i</dfn>) <em>const</em> {</td></tr>
<tr><th id="377">377</th><td>      <a class="macro" href="sanitizer_internal_defs.h.html#319" title="" data-ref="_M/DCHECK_LT">DCHECK_LT</a>(i, n);</td></tr>
<tr><th id="378">378</th><td>      <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col0 decl" id="1100index" title='index' data-type='__sanitizer::uptr' data-ref="1100index" data-ref-filename="1100index">index</dfn> = <a class="local col9 ref" href="#1099i" title='i' data-ref="1099i" data-ref-filename="1099i">i</a> &gt;&gt; <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::packing_ratio_log" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::packing_ratio_log' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::packing_ratio_log" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..packing_ratio_log">packing_ratio_log</a>;</td></tr>
<tr><th id="379">379</th><td>      <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col1 decl" id="1101bit_offset" title='bit_offset' data-type='__sanitizer::uptr' data-ref="1101bit_offset" data-ref-filename="1101bit_offset">bit_offset</dfn> = (<a class="local col9 ref" href="#1099i" title='i' data-ref="1099i" data-ref-filename="1099i">i</a> &amp; <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::bit_offset_mask" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::bit_offset_mask' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::bit_offset_mask" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..bit_offset_mask">bit_offset_mask</a>) &lt;&lt; <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_size_bits_log" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_size_bits_log' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_size_bits_log" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..counter_size_bits_log">counter_size_bits_log</a>;</td></tr>
<tr><th id="380">380</th><td>      <b>return</b> (<a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..buffer">buffer</a>[<a class="local col0 ref" href="#1100index" title='index' data-ref="1100index" data-ref-filename="1100index">index</a>] &gt;&gt; <a class="local col1 ref" href="#1101bit_offset" title='bit_offset' data-ref="1101bit_offset" data-ref-filename="1101bit_offset">bit_offset</a>) &amp; <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_mask" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_mask' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_mask" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..counter_mask">counter_mask</a>;</td></tr>
<tr><th id="381">381</th><td>    }</td></tr>
<tr><th id="382">382</th><td></td></tr>
<tr><th id="383">383</th><td>    <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::PackedCounterArray::Inc" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::Inc' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::Inc" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..Inc">Inc</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col2 decl" id="1102i" title='i' data-type='__sanitizer::uptr' data-ref="1102i" data-ref-filename="1102i">i</dfn>) <em>const</em> {</td></tr>
<tr><th id="384">384</th><td>      <a class="macro" href="sanitizer_internal_defs.h.html#319" title="" data-ref="_M/DCHECK_LT">DCHECK_LT</a>(Get(i), counter_mask);</td></tr>
<tr><th id="385">385</th><td>      <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col3 decl" id="1103index" title='index' data-type='__sanitizer::uptr' data-ref="1103index" data-ref-filename="1103index">index</dfn> = <a class="local col2 ref" href="#1102i" title='i' data-ref="1102i" data-ref-filename="1102i">i</a> &gt;&gt; <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::packing_ratio_log" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::packing_ratio_log' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::packing_ratio_log" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..packing_ratio_log">packing_ratio_log</a>;</td></tr>
<tr><th id="386">386</th><td>      <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col4 decl" id="1104bit_offset" title='bit_offset' data-type='__sanitizer::uptr' data-ref="1104bit_offset" data-ref-filename="1104bit_offset">bit_offset</dfn> = (<a class="local col2 ref" href="#1102i" title='i' data-ref="1102i" data-ref-filename="1102i">i</a> &amp; <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::bit_offset_mask" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::bit_offset_mask' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::bit_offset_mask" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..bit_offset_mask">bit_offset_mask</a>) &lt;&lt; <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_size_bits_log" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_size_bits_log' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_size_bits_log" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..counter_size_bits_log">counter_size_bits_log</a>;</td></tr>
<tr><th id="387">387</th><td>      <a class="member field" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..buffer">buffer</a>[<a class="local col3 ref" href="#1103index" title='index' data-ref="1103index" data-ref-filename="1103index">index</a>] += <var>1ULL</var> &lt;&lt; <a class="local col4 ref" href="#1104bit_offset" title='bit_offset' data-ref="1104bit_offset" data-ref-filename="1104bit_offset">bit_offset</a>;</td></tr>
<tr><th id="388">388</th><td>    }</td></tr>
<tr><th id="389">389</th><td></td></tr>
<tr><th id="390">390</th><td>    <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::PackedCounterArray::IncRange" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::IncRange' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::IncRange" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..IncRange">IncRange</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col5 decl" id="1105from" title='from' data-type='__sanitizer::uptr' data-ref="1105from" data-ref-filename="1105from">from</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col6 decl" id="1106to" title='to' data-type='__sanitizer::uptr' data-ref="1106to" data-ref-filename="1106to">to</dfn>) <em>const</em> {</td></tr>
<tr><th id="391">391</th><td>      <a class="macro" href="sanitizer_internal_defs.h.html#320" title="" data-ref="_M/DCHECK_LE">DCHECK_LE</a>(from, to);</td></tr>
<tr><th id="392">392</th><td>      <b>for</b> (<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col7 decl" id="1107i" title='i' data-type='__sanitizer::uptr' data-ref="1107i" data-ref-filename="1107i">i</dfn> = <a class="local col5 ref" href="#1105from" title='from' data-ref="1105from" data-ref-filename="1105from">from</a>; <a class="local col7 ref" href="#1107i" title='i' data-ref="1107i" data-ref-filename="1107i">i</a> &lt;= <a class="local col6 ref" href="#1106to" title='to' data-ref="1106to" data-ref-filename="1106to">to</a>; <a class="local col7 ref" href="#1107i" title='i' data-ref="1107i" data-ref-filename="1107i">i</a>++)</td></tr>
<tr><th id="393">393</th><td>        <a class="member fn" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray::Inc" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::Inc' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::Inc" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..Inc">Inc</a>(<a class="local col7 ref" href="#1107i" title='i' data-ref="1107i" data-ref-filename="1107i">i</a>);</td></tr>
<tr><th id="394">394</th><td>    }</td></tr>
<tr><th id="395">395</th><td></td></tr>
<tr><th id="396">396</th><td>   <b>private</b>:</td></tr>
<tr><th id="397">397</th><td>    <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::u64" title='__sanitizer::u64' data-type='unsigned long long' data-ref="__sanitizer::u64" data-ref-filename="__sanitizer..u64">u64</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::PackedCounterArray::n" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::n' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::n" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..n">n</dfn>;</td></tr>
<tr><th id="398">398</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::u64" title='__sanitizer::u64' data-type='unsigned long long' data-ref="__sanitizer::u64" data-ref-filename="__sanitizer..u64">u64</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_size_bits_log" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_size_bits_log' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_size_bits_log" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..counter_size_bits_log">counter_size_bits_log</dfn>;</td></tr>
<tr><th id="399">399</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::u64" title='__sanitizer::u64' data-type='unsigned long long' data-ref="__sanitizer::u64" data-ref-filename="__sanitizer..u64">u64</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_mask" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_mask' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::counter_mask" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..counter_mask">counter_mask</dfn>;</td></tr>
<tr><th id="400">400</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::u64" title='__sanitizer::u64' data-type='unsigned long long' data-ref="__sanitizer::u64" data-ref-filename="__sanitizer..u64">u64</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::PackedCounterArray::packing_ratio_log" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::packing_ratio_log' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::packing_ratio_log" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..packing_ratio_log">packing_ratio_log</dfn>;</td></tr>
<tr><th id="401">401</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::u64" title='__sanitizer::u64' data-type='unsigned long long' data-ref="__sanitizer::u64" data-ref-filename="__sanitizer..u64">u64</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::PackedCounterArray::bit_offset_mask" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::bit_offset_mask' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::bit_offset_mask" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..bit_offset_mask">bit_offset_mask</dfn>;</td></tr>
<tr><th id="402">402</th><td></td></tr>
<tr><th id="403">403</th><td>    MemoryMapperT* <em>const</em> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::PackedCounterArray::memory_mapper" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::memory_mapper' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::memory_mapper" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..memory_mapper">memory_mapper</dfn>;</td></tr>
<tr><th id="404">404</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::u64" title='__sanitizer::u64' data-type='unsigned long long' data-ref="__sanitizer::u64" data-ref-filename="__sanitizer..u64">u64</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer_size" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer_size' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer_size" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..buffer_size">buffer_size</dfn>;</td></tr>
<tr><th id="405">405</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::u64" title='__sanitizer::u64' data-type='unsigned long long' data-ref="__sanitizer::u64" data-ref-filename="__sanitizer..u64">u64</a>* <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer" title='__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray::buffer" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray..buffer">buffer</dfn>;</td></tr>
<tr><th id="406">406</th><td>  };</td></tr>
<tr><th id="407">407</th><td></td></tr>
<tr><th id="408">408</th><td>  <b>template</b>&lt;<b>class</b> MemoryMapperT&gt;</td></tr>
<tr><th id="409">409</th><td>  <b>class</b> <dfn class="type def" id="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker">FreePagesRangeTracker</dfn> {</td></tr>
<tr><th id="410">410</th><td>   <b>public</b>:</td></tr>
<tr><th id="411">411</th><td>    <b>explicit</b> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::FreePagesRangeTracker{MemoryMapperT}" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::FreePagesRangeTracker&lt;MemoryMapperT&gt;' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::FreePagesRangeTracker{MemoryMapperT}" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..FreePagesRangeTracker{MemoryMapperT}">FreePagesRangeTracker</dfn>(MemoryMapperT* <dfn class="local col8 decl" id="1108mapper" title='mapper' data-type='MemoryMapperT *' data-ref="1108mapper" data-ref-filename="1108mapper">mapper</dfn>)</td></tr>
<tr><th id="412">412</th><td>        : <a class="member field" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::memory_mapper" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::memory_mapper' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::memory_mapper" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..memory_mapper">memory_mapper</a>(<a class="local col8 ref" href="#1108mapper" title='mapper' data-ref="1108mapper" data-ref-filename="1108mapper">mapper</a>),</td></tr>
<tr><th id="413">413</th><td>          <a class="member field" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::page_size_scaled_log" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::page_size_scaled_log' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::page_size_scaled_log" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..page_size_scaled_log">page_size_scaled_log</a>(<a class="ref fn" href="sanitizer_common.h.html#__sanitizer::Log2" title='__sanitizer::Log2' data-ref="__sanitizer::Log2" data-ref-filename="__sanitizer..Log2">Log2</a>(<a class="ref fn" href="sanitizer_common.h.html#__sanitizer::GetPageSizeCached" title='__sanitizer::GetPageSizeCached' data-ref="__sanitizer::GetPageSizeCached" data-ref-filename="__sanitizer..GetPageSizeCached">GetPageSizeCached</a>() &gt;&gt; <a class="ref" href="#__sanitizer::SizeClassAllocator64::kCompactPtrScale" title='__sanitizer::SizeClassAllocator64::kCompactPtrScale' data-ref="__sanitizer::SizeClassAllocator64::kCompactPtrScale" data-ref-filename="__sanitizer..SizeClassAllocator64..kCompactPtrScale">kCompactPtrScale</a>)),</td></tr>
<tr><th id="414">414</th><td>          <a class="member field" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::in_the_range" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::in_the_range' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::in_the_range" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..in_the_range">in_the_range</a>(<b>false</b>), <a class="member field" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_page" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_page' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_page" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..current_page">current_page</a>(<var>0</var>), <a class="member field" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_range_start_page" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_range_start_page' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_range_start_page" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..current_range_start_page">current_range_start_page</a>(<var>0</var>) {}</td></tr>
<tr><th id="415">415</th><td></td></tr>
<tr><th id="416">416</th><td>    <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::NextPage" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::NextPage' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::NextPage" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..NextPage">NextPage</dfn>(<em>bool</em> <dfn class="local col9 decl" id="1109freed" title='freed' data-type='bool' data-ref="1109freed" data-ref-filename="1109freed">freed</dfn>) {</td></tr>
<tr><th id="417">417</th><td>      <b>if</b> (<a class="local col9 ref" href="#1109freed" title='freed' data-ref="1109freed" data-ref-filename="1109freed">freed</a>) {</td></tr>
<tr><th id="418">418</th><td>        <b>if</b> (!<a class="member field" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::in_the_range" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::in_the_range' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::in_the_range" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..in_the_range">in_the_range</a>) {</td></tr>
<tr><th id="419">419</th><td>          <a class="member field" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_range_start_page" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_range_start_page' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_range_start_page" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..current_range_start_page">current_range_start_page</a> = <a class="member field" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_page" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_page' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_page" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..current_page">current_page</a>;</td></tr>
<tr><th id="420">420</th><td>          <a class="member field" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::in_the_range" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::in_the_range' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::in_the_range" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..in_the_range">in_the_range</a> = <b>true</b>;</td></tr>
<tr><th id="421">421</th><td>        }</td></tr>
<tr><th id="422">422</th><td>      } <b>else</b> {</td></tr>
<tr><th id="423">423</th><td>        <a class="member fn" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::CloseOpenedRange" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::CloseOpenedRange' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::CloseOpenedRange" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..CloseOpenedRange">CloseOpenedRange</a>();</td></tr>
<tr><th id="424">424</th><td>      }</td></tr>
<tr><th id="425">425</th><td>      <a class="member field" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_page" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_page' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_page" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..current_page">current_page</a>++;</td></tr>
<tr><th id="426">426</th><td>    }</td></tr>
<tr><th id="427">427</th><td></td></tr>
<tr><th id="428">428</th><td>    <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::Done" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::Done' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::Done" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..Done">Done</dfn>() {</td></tr>
<tr><th id="429">429</th><td>      <a class="member fn" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::CloseOpenedRange" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::CloseOpenedRange' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::CloseOpenedRange" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..CloseOpenedRange">CloseOpenedRange</a>();</td></tr>
<tr><th id="430">430</th><td>    }</td></tr>
<tr><th id="431">431</th><td></td></tr>
<tr><th id="432">432</th><td>   <b>private</b>:</td></tr>
<tr><th id="433">433</th><td>    <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::CloseOpenedRange" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::CloseOpenedRange' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::CloseOpenedRange" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..CloseOpenedRange">CloseOpenedRange</dfn>() {</td></tr>
<tr><th id="434">434</th><td>      <b>if</b> (<a class="member field" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::in_the_range" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::in_the_range' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::in_the_range" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..in_the_range">in_the_range</a>) {</td></tr>
<tr><th id="435">435</th><td>        <a class="member field" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::memory_mapper" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::memory_mapper' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::memory_mapper" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..memory_mapper">memory_mapper</a>-&gt;ReleasePageRangeToOS(</td></tr>
<tr><th id="436">436</th><td>            <a class="member field" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_range_start_page" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_range_start_page' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_range_start_page" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..current_range_start_page">current_range_start_page</a> &lt;&lt; <a class="member field" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::page_size_scaled_log" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::page_size_scaled_log' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::page_size_scaled_log" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..page_size_scaled_log">page_size_scaled_log</a>,</td></tr>
<tr><th id="437">437</th><td>            <a class="member field" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_page" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_page' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_page" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..current_page">current_page</a> &lt;&lt; <a class="member field" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::page_size_scaled_log" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::page_size_scaled_log' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::page_size_scaled_log" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..page_size_scaled_log">page_size_scaled_log</a>);</td></tr>
<tr><th id="438">438</th><td>        <a class="member field" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::in_the_range" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::in_the_range' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::in_the_range" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..in_the_range">in_the_range</a> = <b>false</b>;</td></tr>
<tr><th id="439">439</th><td>      }</td></tr>
<tr><th id="440">440</th><td>    }</td></tr>
<tr><th id="441">441</th><td></td></tr>
<tr><th id="442">442</th><td>    MemoryMapperT* <em>const</em> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::memory_mapper" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::memory_mapper' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::memory_mapper" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..memory_mapper">memory_mapper</dfn>;</td></tr>
<tr><th id="443">443</th><td>    <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::page_size_scaled_log" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::page_size_scaled_log' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::page_size_scaled_log" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..page_size_scaled_log">page_size_scaled_log</dfn>;</td></tr>
<tr><th id="444">444</th><td>    <em>bool</em> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::in_the_range" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::in_the_range' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::in_the_range" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..in_the_range">in_the_range</dfn>;</td></tr>
<tr><th id="445">445</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_page" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_page' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_page" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..current_page">current_page</dfn>;</td></tr>
<tr><th id="446">446</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_range_start_page" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_range_start_page' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker::current_range_start_page" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker..current_range_start_page">current_range_start_page</dfn>;</td></tr>
<tr><th id="447">447</th><td>  };</td></tr>
<tr><th id="448">448</th><td></td></tr>
<tr><th id="449">449</th><td>  <i>// Iterates over the free_array to identify memory pages containing freed</i></td></tr>
<tr><th id="450">450</th><td><i>  // chunks only and returns these pages back to OS.</i></td></tr>
<tr><th id="451">451</th><td><i>  // allocated_pages_count is the total number of pages allocated for the</i></td></tr>
<tr><th id="452">452</th><td><i>  // current bucket.</i></td></tr>
<tr><th id="453">453</th><td>  <b>template</b>&lt;<b>class</b> MemoryMapperT&gt;</td></tr>
<tr><th id="454">454</th><td>  <em>static</em> <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::ReleaseFreeMemoryToOS" title='__sanitizer::SizeClassAllocator64::ReleaseFreeMemoryToOS' data-ref="__sanitizer::SizeClassAllocator64::ReleaseFreeMemoryToOS" data-ref-filename="__sanitizer..SizeClassAllocator64..ReleaseFreeMemoryToOS">ReleaseFreeMemoryToOS</dfn>(<a class="typedef" href="#__sanitizer::SizeClassAllocator64::CompactPtrT" title='__sanitizer::SizeClassAllocator64::CompactPtrT' data-type='__sanitizer::u32' data-ref="__sanitizer::SizeClassAllocator64::CompactPtrT" data-ref-filename="__sanitizer..SizeClassAllocator64..CompactPtrT">CompactPtrT</a> *<dfn class="local col0 decl" id="1110free_array" title='free_array' data-type='__sanitizer::SizeClassAllocator64::CompactPtrT *' data-ref="1110free_array" data-ref-filename="1110free_array">free_array</dfn>,</td></tr>
<tr><th id="455">455</th><td>                                    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col1 decl" id="1111free_array_count" title='free_array_count' data-type='__sanitizer::uptr' data-ref="1111free_array_count" data-ref-filename="1111free_array_count">free_array_count</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col2 decl" id="1112chunk_size" title='chunk_size' data-type='__sanitizer::uptr' data-ref="1112chunk_size" data-ref-filename="1112chunk_size">chunk_size</dfn>,</td></tr>
<tr><th id="456">456</th><td>                                    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col3 decl" id="1113allocated_pages_count" title='allocated_pages_count' data-type='__sanitizer::uptr' data-ref="1113allocated_pages_count" data-ref-filename="1113allocated_pages_count">allocated_pages_count</dfn>,</td></tr>
<tr><th id="457">457</th><td>                                    MemoryMapperT *<dfn class="local col4 decl" id="1114memory_mapper" title='memory_mapper' data-type='MemoryMapperT *' data-ref="1114memory_mapper" data-ref-filename="1114memory_mapper">memory_mapper</dfn>) {</td></tr>
<tr><th id="458">458</th><td>    <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col5 decl" id="1115page_size" title='page_size' data-type='const __sanitizer::uptr' data-ref="1115page_size" data-ref-filename="1115page_size">page_size</dfn> = <a class="ref fn" href="sanitizer_common.h.html#__sanitizer::GetPageSizeCached" title='__sanitizer::GetPageSizeCached' data-ref="__sanitizer::GetPageSizeCached" data-ref-filename="__sanitizer..GetPageSizeCached">GetPageSizeCached</a>();</td></tr>
<tr><th id="459">459</th><td></td></tr>
<tr><th id="460">460</th><td>    <i>// Figure out the number of chunks per page and whether we can take a fast</i></td></tr>
<tr><th id="461">461</th><td><i>    // path (the number of chunks per page is the same for all pages).</i></td></tr>
<tr><th id="462">462</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col6 decl" id="1116full_pages_chunk_count_max" title='full_pages_chunk_count_max' data-type='__sanitizer::uptr' data-ref="1116full_pages_chunk_count_max" data-ref-filename="1116full_pages_chunk_count_max">full_pages_chunk_count_max</dfn>;</td></tr>
<tr><th id="463">463</th><td>    <em>bool</em> <dfn class="local col7 decl" id="1117same_chunk_count_per_page" title='same_chunk_count_per_page' data-type='bool' data-ref="1117same_chunk_count_per_page" data-ref-filename="1117same_chunk_count_per_page">same_chunk_count_per_page</dfn>;</td></tr>
<tr><th id="464">464</th><td>    <b>if</b> (<a class="local col2 ref" href="#1112chunk_size" title='chunk_size' data-ref="1112chunk_size" data-ref-filename="1112chunk_size">chunk_size</a> &lt;= <a class="local col5 ref" href="#1115page_size" title='page_size' data-ref="1115page_size" data-ref-filename="1115page_size">page_size</a> &amp;&amp; <a class="local col5 ref" href="#1115page_size" title='page_size' data-ref="1115page_size" data-ref-filename="1115page_size">page_size</a> % <a class="local col2 ref" href="#1112chunk_size" title='chunk_size' data-ref="1112chunk_size" data-ref-filename="1112chunk_size">chunk_size</a> == <var>0</var>) {</td></tr>
<tr><th id="465">465</th><td>      <i>// Same number of chunks per page, no cross overs.</i></td></tr>
<tr><th id="466">466</th><td>      <a class="local col6 ref" href="#1116full_pages_chunk_count_max" title='full_pages_chunk_count_max' data-ref="1116full_pages_chunk_count_max" data-ref-filename="1116full_pages_chunk_count_max">full_pages_chunk_count_max</a> = <a class="local col5 ref" href="#1115page_size" title='page_size' data-ref="1115page_size" data-ref-filename="1115page_size">page_size</a> / <a class="local col2 ref" href="#1112chunk_size" title='chunk_size' data-ref="1112chunk_size" data-ref-filename="1112chunk_size">chunk_size</a>;</td></tr>
<tr><th id="467">467</th><td>      <a class="local col7 ref" href="#1117same_chunk_count_per_page" title='same_chunk_count_per_page' data-ref="1117same_chunk_count_per_page" data-ref-filename="1117same_chunk_count_per_page">same_chunk_count_per_page</a> = <b>true</b>;</td></tr>
<tr><th id="468">468</th><td>    } <b>else</b> <b>if</b> (<a class="local col2 ref" href="#1112chunk_size" title='chunk_size' data-ref="1112chunk_size" data-ref-filename="1112chunk_size">chunk_size</a> &lt;= <a class="local col5 ref" href="#1115page_size" title='page_size' data-ref="1115page_size" data-ref-filename="1115page_size">page_size</a> &amp;&amp; <a class="local col5 ref" href="#1115page_size" title='page_size' data-ref="1115page_size" data-ref-filename="1115page_size">page_size</a> % <a class="local col2 ref" href="#1112chunk_size" title='chunk_size' data-ref="1112chunk_size" data-ref-filename="1112chunk_size">chunk_size</a> != <var>0</var> &amp;&amp;</td></tr>
<tr><th id="469">469</th><td>        <a class="local col2 ref" href="#1112chunk_size" title='chunk_size' data-ref="1112chunk_size" data-ref-filename="1112chunk_size">chunk_size</a> % (<a class="local col5 ref" href="#1115page_size" title='page_size' data-ref="1115page_size" data-ref-filename="1115page_size">page_size</a> % <a class="local col2 ref" href="#1112chunk_size" title='chunk_size' data-ref="1112chunk_size" data-ref-filename="1112chunk_size">chunk_size</a>) == <var>0</var>) {</td></tr>
<tr><th id="470">470</th><td>      <i>// Some chunks are crossing page boundaries, which means that the page</i></td></tr>
<tr><th id="471">471</th><td><i>      // contains one or two partial chunks, but all pages contain the same</i></td></tr>
<tr><th id="472">472</th><td><i>      // number of chunks.</i></td></tr>
<tr><th id="473">473</th><td>      <a class="local col6 ref" href="#1116full_pages_chunk_count_max" title='full_pages_chunk_count_max' data-ref="1116full_pages_chunk_count_max" data-ref-filename="1116full_pages_chunk_count_max">full_pages_chunk_count_max</a> = <a class="local col5 ref" href="#1115page_size" title='page_size' data-ref="1115page_size" data-ref-filename="1115page_size">page_size</a> / <a class="local col2 ref" href="#1112chunk_size" title='chunk_size' data-ref="1112chunk_size" data-ref-filename="1112chunk_size">chunk_size</a> + <var>1</var>;</td></tr>
<tr><th id="474">474</th><td>      <a class="local col7 ref" href="#1117same_chunk_count_per_page" title='same_chunk_count_per_page' data-ref="1117same_chunk_count_per_page" data-ref-filename="1117same_chunk_count_per_page">same_chunk_count_per_page</a> = <b>true</b>;</td></tr>
<tr><th id="475">475</th><td>    } <b>else</b> <b>if</b> (<a class="local col2 ref" href="#1112chunk_size" title='chunk_size' data-ref="1112chunk_size" data-ref-filename="1112chunk_size">chunk_size</a> &lt;= <a class="local col5 ref" href="#1115page_size" title='page_size' data-ref="1115page_size" data-ref-filename="1115page_size">page_size</a>) {</td></tr>
<tr><th id="476">476</th><td>      <i>// Some chunks are crossing page boundaries, which means that the page</i></td></tr>
<tr><th id="477">477</th><td><i>      // contains one or two partial chunks.</i></td></tr>
<tr><th id="478">478</th><td>      <a class="local col6 ref" href="#1116full_pages_chunk_count_max" title='full_pages_chunk_count_max' data-ref="1116full_pages_chunk_count_max" data-ref-filename="1116full_pages_chunk_count_max">full_pages_chunk_count_max</a> = <a class="local col5 ref" href="#1115page_size" title='page_size' data-ref="1115page_size" data-ref-filename="1115page_size">page_size</a> / <a class="local col2 ref" href="#1112chunk_size" title='chunk_size' data-ref="1112chunk_size" data-ref-filename="1112chunk_size">chunk_size</a> + <var>2</var>;</td></tr>
<tr><th id="479">479</th><td>      <a class="local col7 ref" href="#1117same_chunk_count_per_page" title='same_chunk_count_per_page' data-ref="1117same_chunk_count_per_page" data-ref-filename="1117same_chunk_count_per_page">same_chunk_count_per_page</a> = <b>false</b>;</td></tr>
<tr><th id="480">480</th><td>    } <b>else</b> <b>if</b> (<a class="local col2 ref" href="#1112chunk_size" title='chunk_size' data-ref="1112chunk_size" data-ref-filename="1112chunk_size">chunk_size</a> &gt; <a class="local col5 ref" href="#1115page_size" title='page_size' data-ref="1115page_size" data-ref-filename="1115page_size">page_size</a> &amp;&amp; <a class="local col2 ref" href="#1112chunk_size" title='chunk_size' data-ref="1112chunk_size" data-ref-filename="1112chunk_size">chunk_size</a> % <a class="local col5 ref" href="#1115page_size" title='page_size' data-ref="1115page_size" data-ref-filename="1115page_size">page_size</a> == <var>0</var>) {</td></tr>
<tr><th id="481">481</th><td>      <i>// One chunk covers multiple pages, no cross overs.</i></td></tr>
<tr><th id="482">482</th><td>      <a class="local col6 ref" href="#1116full_pages_chunk_count_max" title='full_pages_chunk_count_max' data-ref="1116full_pages_chunk_count_max" data-ref-filename="1116full_pages_chunk_count_max">full_pages_chunk_count_max</a> = <var>1</var>;</td></tr>
<tr><th id="483">483</th><td>      <a class="local col7 ref" href="#1117same_chunk_count_per_page" title='same_chunk_count_per_page' data-ref="1117same_chunk_count_per_page" data-ref-filename="1117same_chunk_count_per_page">same_chunk_count_per_page</a> = <b>true</b>;</td></tr>
<tr><th id="484">484</th><td>    } <b>else</b> <b>if</b> (<a class="local col2 ref" href="#1112chunk_size" title='chunk_size' data-ref="1112chunk_size" data-ref-filename="1112chunk_size">chunk_size</a> &gt; <a class="local col5 ref" href="#1115page_size" title='page_size' data-ref="1115page_size" data-ref-filename="1115page_size">page_size</a>) {</td></tr>
<tr><th id="485">485</th><td>      <i>// One chunk covers multiple pages, Some chunks are crossing page</i></td></tr>
<tr><th id="486">486</th><td><i>      // boundaries. Some pages contain one chunk, some contain two.</i></td></tr>
<tr><th id="487">487</th><td>      <a class="local col6 ref" href="#1116full_pages_chunk_count_max" title='full_pages_chunk_count_max' data-ref="1116full_pages_chunk_count_max" data-ref-filename="1116full_pages_chunk_count_max">full_pages_chunk_count_max</a> = <var>2</var>;</td></tr>
<tr><th id="488">488</th><td>      <a class="local col7 ref" href="#1117same_chunk_count_per_page" title='same_chunk_count_per_page' data-ref="1117same_chunk_count_per_page" data-ref-filename="1117same_chunk_count_per_page">same_chunk_count_per_page</a> = <b>false</b>;</td></tr>
<tr><th id="489">489</th><td>    } <b>else</b> {</td></tr>
<tr><th id="490">490</th><td>      <a class="macro" href="sanitizer_internal_defs.h.html#325" title="do { do { __sanitizer::u64 v1 = (__sanitizer::u64)((0 &amp;&amp; &quot;All chunk_size/page_size ratios must be handled.&quot;)); __sanitizer::u64 v2 = (__sanitizer::u64)(0); if (__builtin_expect(!!(!(v1 != v2)), 0)) __sanitizer::CheckFailed(&quot;/fast/tmp/llvm-proj-12/compiler-rt/lib/asan/../sanitizer_common/sanitizer_allocator_primary64.h&quot;, 490, &quot;(&quot; &quot;(0 &amp;&amp; \&quot;All chunk_size/page_size ratios must be handled.\&quot;)&quot; &quot;) &quot; &quot;!=&quot; &quot; (&quot; &quot;0&quot; &quot;)&quot;, v1, v2); } while (false); Die(); } while (0)" data-ref="_M/UNREACHABLE">UNREACHABLE</a>(<q>"All chunk_size/page_size ratios must be handled."</q>);</td></tr>
<tr><th id="491">491</th><td>    }</td></tr>
<tr><th id="492">492</th><td></td></tr>
<tr><th id="493">493</th><td>    <a class="type" href="#__sanitizer::SizeClassAllocator64::PackedCounterArray" title='__sanitizer::SizeClassAllocator64::PackedCounterArray' data-ref="__sanitizer::SizeClassAllocator64::PackedCounterArray" data-ref-filename="__sanitizer..SizeClassAllocator64..PackedCounterArray">PackedCounterArray</a>&lt;MemoryMapperT&gt; <dfn class="local col8 decl" id="1118counters" title='counters' data-type='PackedCounterArray&lt;MemoryMapperT&gt;' data-ref="1118counters" data-ref-filename="1118counters">counters</dfn>(<a class="local col3 ref" href="#1113allocated_pages_count" title='allocated_pages_count' data-ref="1113allocated_pages_count" data-ref-filename="1113allocated_pages_count">allocated_pages_count</a>,</td></tr>
<tr><th id="494">494</th><td>                                               <a class="local col6 ref" href="#1116full_pages_chunk_count_max" title='full_pages_chunk_count_max' data-ref="1116full_pages_chunk_count_max" data-ref-filename="1116full_pages_chunk_count_max">full_pages_chunk_count_max</a>,</td></tr>
<tr><th id="495">495</th><td>                                               <a class="local col4 ref" href="#1114memory_mapper" title='memory_mapper' data-ref="1114memory_mapper" data-ref-filename="1114memory_mapper">memory_mapper</a>);</td></tr>
<tr><th id="496">496</th><td>    <b>if</b> (!<a class="local col8 ref" href="#1118counters" title='counters' data-ref="1118counters" data-ref-filename="1118counters">counters</a>.IsAllocated())</td></tr>
<tr><th id="497">497</th><td>      <b>return</b>;</td></tr>
<tr><th id="498">498</th><td></td></tr>
<tr><th id="499">499</th><td>    <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col9 decl" id="1119chunk_size_scaled" title='chunk_size_scaled' data-type='const __sanitizer::uptr' data-ref="1119chunk_size_scaled" data-ref-filename="1119chunk_size_scaled">chunk_size_scaled</dfn> = <a class="local col2 ref" href="#1112chunk_size" title='chunk_size' data-ref="1112chunk_size" data-ref-filename="1112chunk_size">chunk_size</a> &gt;&gt; <a class="member" href="#__sanitizer::SizeClassAllocator64::kCompactPtrScale" title='__sanitizer::SizeClassAllocator64::kCompactPtrScale' data-ref="__sanitizer::SizeClassAllocator64::kCompactPtrScale" data-ref-filename="__sanitizer..SizeClassAllocator64..kCompactPtrScale">kCompactPtrScale</a>;</td></tr>
<tr><th id="500">500</th><td>    <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col0 decl" id="1120page_size_scaled" title='page_size_scaled' data-type='const __sanitizer::uptr' data-ref="1120page_size_scaled" data-ref-filename="1120page_size_scaled">page_size_scaled</dfn> = <a class="local col5 ref" href="#1115page_size" title='page_size' data-ref="1115page_size" data-ref-filename="1115page_size">page_size</a> &gt;&gt; <a class="member" href="#__sanitizer::SizeClassAllocator64::kCompactPtrScale" title='__sanitizer::SizeClassAllocator64::kCompactPtrScale' data-ref="__sanitizer::SizeClassAllocator64::kCompactPtrScale" data-ref-filename="__sanitizer..SizeClassAllocator64..kCompactPtrScale">kCompactPtrScale</a>;</td></tr>
<tr><th id="501">501</th><td>    <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col1 decl" id="1121page_size_scaled_log" title='page_size_scaled_log' data-type='const __sanitizer::uptr' data-ref="1121page_size_scaled_log" data-ref-filename="1121page_size_scaled_log">page_size_scaled_log</dfn> = <a class="ref fn" href="sanitizer_common.h.html#__sanitizer::Log2" title='__sanitizer::Log2' data-ref="__sanitizer::Log2" data-ref-filename="__sanitizer..Log2">Log2</a>(<a class="local col0 ref" href="#1120page_size_scaled" title='page_size_scaled' data-ref="1120page_size_scaled" data-ref-filename="1120page_size_scaled">page_size_scaled</a>);</td></tr>
<tr><th id="502">502</th><td></td></tr>
<tr><th id="503">503</th><td>    <i>// Iterate over free chunks and count how many free chunks affect each</i></td></tr>
<tr><th id="504">504</th><td><i>    // allocated page.</i></td></tr>
<tr><th id="505">505</th><td>    <b>if</b> (<a class="local col2 ref" href="#1112chunk_size" title='chunk_size' data-ref="1112chunk_size" data-ref-filename="1112chunk_size">chunk_size</a> &lt;= <a class="local col5 ref" href="#1115page_size" title='page_size' data-ref="1115page_size" data-ref-filename="1115page_size">page_size</a> &amp;&amp; <a class="local col5 ref" href="#1115page_size" title='page_size' data-ref="1115page_size" data-ref-filename="1115page_size">page_size</a> % <a class="local col2 ref" href="#1112chunk_size" title='chunk_size' data-ref="1112chunk_size" data-ref-filename="1112chunk_size">chunk_size</a> == <var>0</var>) {</td></tr>
<tr><th id="506">506</th><td>      <i>// Each chunk affects one page only.</i></td></tr>
<tr><th id="507">507</th><td>      <b>for</b> (<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col2 decl" id="1122i" title='i' data-type='__sanitizer::uptr' data-ref="1122i" data-ref-filename="1122i">i</dfn> = <var>0</var>; <a class="local col2 ref" href="#1122i" title='i' data-ref="1122i" data-ref-filename="1122i">i</a> &lt; <a class="local col1 ref" href="#1111free_array_count" title='free_array_count' data-ref="1111free_array_count" data-ref-filename="1111free_array_count">free_array_count</a>; <a class="local col2 ref" href="#1122i" title='i' data-ref="1122i" data-ref-filename="1122i">i</a>++)</td></tr>
<tr><th id="508">508</th><td>        <a class="local col8 ref" href="#1118counters" title='counters' data-ref="1118counters" data-ref-filename="1118counters">counters</a>.Inc(<a class="local col0 ref" href="#1110free_array" title='free_array' data-ref="1110free_array" data-ref-filename="1110free_array">free_array</a>[<a class="local col2 ref" href="#1122i" title='i' data-ref="1122i" data-ref-filename="1122i">i</a>] &gt;&gt; <a class="local col1 ref" href="#1121page_size_scaled_log" title='page_size_scaled_log' data-ref="1121page_size_scaled_log" data-ref-filename="1121page_size_scaled_log">page_size_scaled_log</a>);</td></tr>
<tr><th id="509">509</th><td>    } <b>else</b> {</td></tr>
<tr><th id="510">510</th><td>      <i>// In all other cases chunks might affect more than one page.</i></td></tr>
<tr><th id="511">511</th><td>      <b>for</b> (<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col3 decl" id="1123i" title='i' data-type='__sanitizer::uptr' data-ref="1123i" data-ref-filename="1123i">i</dfn> = <var>0</var>; <a class="local col3 ref" href="#1123i" title='i' data-ref="1123i" data-ref-filename="1123i">i</a> &lt; <a class="local col1 ref" href="#1111free_array_count" title='free_array_count' data-ref="1111free_array_count" data-ref-filename="1111free_array_count">free_array_count</a>; <a class="local col3 ref" href="#1123i" title='i' data-ref="1123i" data-ref-filename="1123i">i</a>++) {</td></tr>
<tr><th id="512">512</th><td>        <a class="local col8 ref" href="#1118counters" title='counters' data-ref="1118counters" data-ref-filename="1118counters">counters</a>.IncRange(</td></tr>
<tr><th id="513">513</th><td>            <a class="local col0 ref" href="#1110free_array" title='free_array' data-ref="1110free_array" data-ref-filename="1110free_array">free_array</a>[<a class="local col3 ref" href="#1123i" title='i' data-ref="1123i" data-ref-filename="1123i">i</a>] &gt;&gt; <a class="local col1 ref" href="#1121page_size_scaled_log" title='page_size_scaled_log' data-ref="1121page_size_scaled_log" data-ref-filename="1121page_size_scaled_log">page_size_scaled_log</a>,</td></tr>
<tr><th id="514">514</th><td>            (<a class="local col0 ref" href="#1110free_array" title='free_array' data-ref="1110free_array" data-ref-filename="1110free_array">free_array</a>[<a class="local col3 ref" href="#1123i" title='i' data-ref="1123i" data-ref-filename="1123i">i</a>] + <a class="local col9 ref" href="#1119chunk_size_scaled" title='chunk_size_scaled' data-ref="1119chunk_size_scaled" data-ref-filename="1119chunk_size_scaled">chunk_size_scaled</a> - <var>1</var>) &gt;&gt; <a class="local col1 ref" href="#1121page_size_scaled_log" title='page_size_scaled_log' data-ref="1121page_size_scaled_log" data-ref-filename="1121page_size_scaled_log">page_size_scaled_log</a>);</td></tr>
<tr><th id="515">515</th><td>      }</td></tr>
<tr><th id="516">516</th><td>    }</td></tr>
<tr><th id="517">517</th><td></td></tr>
<tr><th id="518">518</th><td>    <i>// Iterate over pages detecting ranges of pages with chunk counters equal</i></td></tr>
<tr><th id="519">519</th><td><i>    // to the expected number of chunks for the particular page.</i></td></tr>
<tr><th id="520">520</th><td>    <a class="type" href="#__sanitizer::SizeClassAllocator64::FreePagesRangeTracker" title='__sanitizer::SizeClassAllocator64::FreePagesRangeTracker' data-ref="__sanitizer::SizeClassAllocator64::FreePagesRangeTracker" data-ref-filename="__sanitizer..SizeClassAllocator64..FreePagesRangeTracker">FreePagesRangeTracker</a>&lt;MemoryMapperT&gt; <dfn class="local col4 decl" id="1124range_tracker" title='range_tracker' data-type='FreePagesRangeTracker&lt;MemoryMapperT&gt;' data-ref="1124range_tracker" data-ref-filename="1124range_tracker">range_tracker</dfn>(<a class="local col4 ref" href="#1114memory_mapper" title='memory_mapper' data-ref="1114memory_mapper" data-ref-filename="1114memory_mapper">memory_mapper</a>);</td></tr>
<tr><th id="521">521</th><td>    <b>if</b> (<a class="local col7 ref" href="#1117same_chunk_count_per_page" title='same_chunk_count_per_page' data-ref="1117same_chunk_count_per_page" data-ref-filename="1117same_chunk_count_per_page">same_chunk_count_per_page</a>) {</td></tr>
<tr><th id="522">522</th><td>      <i>// Fast path, every page has the same number of chunks affecting it.</i></td></tr>
<tr><th id="523">523</th><td>      <b>for</b> (<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col5 decl" id="1125i" title='i' data-type='__sanitizer::uptr' data-ref="1125i" data-ref-filename="1125i">i</dfn> = <var>0</var>; <a class="local col5 ref" href="#1125i" title='i' data-ref="1125i" data-ref-filename="1125i">i</a> &lt; <a class="local col8 ref" href="#1118counters" title='counters' data-ref="1118counters" data-ref-filename="1118counters">counters</a>.GetCount(); <a class="local col5 ref" href="#1125i" title='i' data-ref="1125i" data-ref-filename="1125i">i</a>++)</td></tr>
<tr><th id="524">524</th><td>        <a class="local col4 ref" href="#1124range_tracker" title='range_tracker' data-ref="1124range_tracker" data-ref-filename="1124range_tracker">range_tracker</a>.NextPage(<a class="local col8 ref" href="#1118counters" title='counters' data-ref="1118counters" data-ref-filename="1118counters">counters</a>.Get(<a class="local col5 ref" href="#1125i" title='i' data-ref="1125i" data-ref-filename="1125i">i</a>) == <a class="local col6 ref" href="#1116full_pages_chunk_count_max" title='full_pages_chunk_count_max' data-ref="1116full_pages_chunk_count_max" data-ref-filename="1116full_pages_chunk_count_max">full_pages_chunk_count_max</a>);</td></tr>
<tr><th id="525">525</th><td>    } <b>else</b> {</td></tr>
<tr><th id="526">526</th><td>      <i>// Show path, go through the pages keeping count how many chunks affect</i></td></tr>
<tr><th id="527">527</th><td><i>      // each page.</i></td></tr>
<tr><th id="528">528</th><td>      <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col6 decl" id="1126pn" title='pn' data-type='const __sanitizer::uptr' data-ref="1126pn" data-ref-filename="1126pn">pn</dfn> =</td></tr>
<tr><th id="529">529</th><td>          <a class="local col2 ref" href="#1112chunk_size" title='chunk_size' data-ref="1112chunk_size" data-ref-filename="1112chunk_size">chunk_size</a> &lt; <a class="local col5 ref" href="#1115page_size" title='page_size' data-ref="1115page_size" data-ref-filename="1115page_size">page_size</a> ? <a class="local col0 ref" href="#1120page_size_scaled" title='page_size_scaled' data-ref="1120page_size_scaled" data-ref-filename="1120page_size_scaled">page_size_scaled</a> / <a class="local col9 ref" href="#1119chunk_size_scaled" title='chunk_size_scaled' data-ref="1119chunk_size_scaled" data-ref-filename="1119chunk_size_scaled">chunk_size_scaled</a> : <var>1</var>;</td></tr>
<tr><th id="530">530</th><td>      <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col7 decl" id="1127pnc" title='pnc' data-type='const __sanitizer::uptr' data-ref="1127pnc" data-ref-filename="1127pnc">pnc</dfn> = <a class="local col6 ref" href="#1126pn" title='pn' data-ref="1126pn" data-ref-filename="1126pn">pn</a> * <a class="local col9 ref" href="#1119chunk_size_scaled" title='chunk_size_scaled' data-ref="1119chunk_size_scaled" data-ref-filename="1119chunk_size_scaled">chunk_size_scaled</a>;</td></tr>
<tr><th id="531">531</th><td>      <i>// The idea is to increment the current page pointer by the first chunk</i></td></tr>
<tr><th id="532">532</th><td><i>      // size, middle portion size (the portion of the page covered by chunks</i></td></tr>
<tr><th id="533">533</th><td><i>      // except the first and the last one) and then the last chunk size, adding</i></td></tr>
<tr><th id="534">534</th><td><i>      // up the number of chunks on the current page and checking on every step</i></td></tr>
<tr><th id="535">535</th><td><i>      // whether the page boundary was crossed.</i></td></tr>
<tr><th id="536">536</th><td>      <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col8 decl" id="1128prev_page_boundary" title='prev_page_boundary' data-type='__sanitizer::uptr' data-ref="1128prev_page_boundary" data-ref-filename="1128prev_page_boundary">prev_page_boundary</dfn> = <var>0</var>;</td></tr>
<tr><th id="537">537</th><td>      <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col9 decl" id="1129current_boundary" title='current_boundary' data-type='__sanitizer::uptr' data-ref="1129current_boundary" data-ref-filename="1129current_boundary">current_boundary</dfn> = <var>0</var>;</td></tr>
<tr><th id="538">538</th><td>      <b>for</b> (<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col0 decl" id="1130i" title='i' data-type='__sanitizer::uptr' data-ref="1130i" data-ref-filename="1130i">i</dfn> = <var>0</var>; <a class="local col0 ref" href="#1130i" title='i' data-ref="1130i" data-ref-filename="1130i">i</a> &lt; <a class="local col8 ref" href="#1118counters" title='counters' data-ref="1118counters" data-ref-filename="1118counters">counters</a>.GetCount(); <a class="local col0 ref" href="#1130i" title='i' data-ref="1130i" data-ref-filename="1130i">i</a>++) {</td></tr>
<tr><th id="539">539</th><td>        <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col1 decl" id="1131page_boundary" title='page_boundary' data-type='__sanitizer::uptr' data-ref="1131page_boundary" data-ref-filename="1131page_boundary">page_boundary</dfn> = <a class="local col8 ref" href="#1128prev_page_boundary" title='prev_page_boundary' data-ref="1128prev_page_boundary" data-ref-filename="1128prev_page_boundary">prev_page_boundary</a> + <a class="local col0 ref" href="#1120page_size_scaled" title='page_size_scaled' data-ref="1120page_size_scaled" data-ref-filename="1120page_size_scaled">page_size_scaled</a>;</td></tr>
<tr><th id="540">540</th><td>        <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col2 decl" id="1132chunks_per_page" title='chunks_per_page' data-type='__sanitizer::uptr' data-ref="1132chunks_per_page" data-ref-filename="1132chunks_per_page">chunks_per_page</dfn> = <a class="local col6 ref" href="#1126pn" title='pn' data-ref="1126pn" data-ref-filename="1126pn">pn</a>;</td></tr>
<tr><th id="541">541</th><td>        <b>if</b> (<a class="local col9 ref" href="#1129current_boundary" title='current_boundary' data-ref="1129current_boundary" data-ref-filename="1129current_boundary">current_boundary</a> &lt; <a class="local col1 ref" href="#1131page_boundary" title='page_boundary' data-ref="1131page_boundary" data-ref-filename="1131page_boundary">page_boundary</a>) {</td></tr>
<tr><th id="542">542</th><td>          <b>if</b> (<a class="local col9 ref" href="#1129current_boundary" title='current_boundary' data-ref="1129current_boundary" data-ref-filename="1129current_boundary">current_boundary</a> &gt; <a class="local col8 ref" href="#1128prev_page_boundary" title='prev_page_boundary' data-ref="1128prev_page_boundary" data-ref-filename="1128prev_page_boundary">prev_page_boundary</a>)</td></tr>
<tr><th id="543">543</th><td>            <a class="local col2 ref" href="#1132chunks_per_page" title='chunks_per_page' data-ref="1132chunks_per_page" data-ref-filename="1132chunks_per_page">chunks_per_page</a>++;</td></tr>
<tr><th id="544">544</th><td>          <a class="local col9 ref" href="#1129current_boundary" title='current_boundary' data-ref="1129current_boundary" data-ref-filename="1129current_boundary">current_boundary</a> += <a class="local col7 ref" href="#1127pnc" title='pnc' data-ref="1127pnc" data-ref-filename="1127pnc">pnc</a>;</td></tr>
<tr><th id="545">545</th><td>          <b>if</b> (<a class="local col9 ref" href="#1129current_boundary" title='current_boundary' data-ref="1129current_boundary" data-ref-filename="1129current_boundary">current_boundary</a> &lt; <a class="local col1 ref" href="#1131page_boundary" title='page_boundary' data-ref="1131page_boundary" data-ref-filename="1131page_boundary">page_boundary</a>) {</td></tr>
<tr><th id="546">546</th><td>            <a class="local col2 ref" href="#1132chunks_per_page" title='chunks_per_page' data-ref="1132chunks_per_page" data-ref-filename="1132chunks_per_page">chunks_per_page</a>++;</td></tr>
<tr><th id="547">547</th><td>            <a class="local col9 ref" href="#1129current_boundary" title='current_boundary' data-ref="1129current_boundary" data-ref-filename="1129current_boundary">current_boundary</a> += <a class="local col9 ref" href="#1119chunk_size_scaled" title='chunk_size_scaled' data-ref="1119chunk_size_scaled" data-ref-filename="1119chunk_size_scaled">chunk_size_scaled</a>;</td></tr>
<tr><th id="548">548</th><td>          }</td></tr>
<tr><th id="549">549</th><td>        }</td></tr>
<tr><th id="550">550</th><td>        <a class="local col8 ref" href="#1128prev_page_boundary" title='prev_page_boundary' data-ref="1128prev_page_boundary" data-ref-filename="1128prev_page_boundary">prev_page_boundary</a> = <a class="local col1 ref" href="#1131page_boundary" title='page_boundary' data-ref="1131page_boundary" data-ref-filename="1131page_boundary">page_boundary</a>;</td></tr>
<tr><th id="551">551</th><td></td></tr>
<tr><th id="552">552</th><td>        <a class="local col4 ref" href="#1124range_tracker" title='range_tracker' data-ref="1124range_tracker" data-ref-filename="1124range_tracker">range_tracker</a>.NextPage(<a class="local col8 ref" href="#1118counters" title='counters' data-ref="1118counters" data-ref-filename="1118counters">counters</a>.Get(<a class="local col0 ref" href="#1130i" title='i' data-ref="1130i" data-ref-filename="1130i">i</a>) == <a class="local col2 ref" href="#1132chunks_per_page" title='chunks_per_page' data-ref="1132chunks_per_page" data-ref-filename="1132chunks_per_page">chunks_per_page</a>);</td></tr>
<tr><th id="553">553</th><td>      }</td></tr>
<tr><th id="554">554</th><td>    }</td></tr>
<tr><th id="555">555</th><td>    <a class="local col4 ref" href="#1124range_tracker" title='range_tracker' data-ref="1124range_tracker" data-ref-filename="1124range_tracker">range_tracker</a>.Done();</td></tr>
<tr><th id="556">556</th><td>  }</td></tr>
<tr><th id="557">557</th><td></td></tr>
<tr><th id="558">558</th><td> <b>private</b>:</td></tr>
<tr><th id="559">559</th><td>  <b>friend</b> <b>class</b> <a class="type" href="#__sanitizer::MemoryMapper" title='__sanitizer::MemoryMapper' data-ref="__sanitizer::MemoryMapper" data-ref-filename="__sanitizer..MemoryMapper">MemoryMapper</a>;</td></tr>
<tr><th id="560">560</th><td></td></tr>
<tr><th id="561">561</th><td>  <a class="type" href="sanitizer_common.h.html#__sanitizer::ReservedAddressRange" title='__sanitizer::ReservedAddressRange' data-ref="__sanitizer::ReservedAddressRange" data-ref-filename="__sanitizer..ReservedAddressRange">ReservedAddressRange</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::address_range" title='__sanitizer::SizeClassAllocator64::address_range' data-ref="__sanitizer::SizeClassAllocator64::address_range" data-ref-filename="__sanitizer..SizeClassAllocator64..address_range">address_range</dfn>;</td></tr>
<tr><th id="562">562</th><td></td></tr>
<tr><th id="563">563</th><td>  <em>static</em> <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl" id="__sanitizer::SizeClassAllocator64::kRegionSize" title='__sanitizer::SizeClassAllocator64::kRegionSize' data-ref="__sanitizer::SizeClassAllocator64::kRegionSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kRegionSize">kRegionSize</dfn> = <a class="ref" href="#__sanitizer::SizeClassAllocator64::kSpaceSize" title='__sanitizer::SizeClassAllocator64::kSpaceSize' data-ref="__sanitizer::SizeClassAllocator64::kSpaceSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kSpaceSize">kSpaceSize</a> / <a class="ref" href="#__sanitizer::SizeClassAllocator64::kNumClassesRounded" title='__sanitizer::SizeClassAllocator64::kNumClassesRounded' data-ref="__sanitizer::SizeClassAllocator64::kNumClassesRounded" data-ref-filename="__sanitizer..SizeClassAllocator64..kNumClassesRounded">kNumClassesRounded</a>;</td></tr>
<tr><th id="564">564</th><td>  <i>// FreeArray is the array of free-d chunks (stored as 4-byte offsets).</i></td></tr>
<tr><th id="565">565</th><td><i>  // In the worst case it may reguire kRegionSize/SizeClassMap::kMinSize</i></td></tr>
<tr><th id="566">566</th><td><i>  // elements, but in reality this will not happen. For simplicity we</i></td></tr>
<tr><th id="567">567</th><td><i>  // dedicate 1/8 of the region's virtual space to FreeArray.</i></td></tr>
<tr><th id="568">568</th><td>  <em>static</em> <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl" id="__sanitizer::SizeClassAllocator64::kFreeArraySize" title='__sanitizer::SizeClassAllocator64::kFreeArraySize' data-ref="__sanitizer::SizeClassAllocator64::kFreeArraySize" data-ref-filename="__sanitizer..SizeClassAllocator64..kFreeArraySize">kFreeArraySize</dfn> = <a class="ref" href="#__sanitizer::SizeClassAllocator64::kRegionSize" title='__sanitizer::SizeClassAllocator64::kRegionSize' data-ref="__sanitizer::SizeClassAllocator64::kRegionSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kRegionSize">kRegionSize</a> / <var>8</var>;</td></tr>
<tr><th id="569">569</th><td></td></tr>
<tr><th id="570">570</th><td>  <em>static</em> <em>const</em> <em>bool</em> <dfn class="decl" id="__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg" title='__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..kUsingConstantSpaceBeg">kUsingConstantSpaceBeg</dfn> = <a class="ref" href="#__sanitizer::SizeClassAllocator64::kSpaceBeg" title='__sanitizer::SizeClassAllocator64::kSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::kSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..kSpaceBeg">kSpaceBeg</a> != ~(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a>)<var>0</var>;</td></tr>
<tr><th id="571">571</th><td>  <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::NonConstSpaceBeg" title='__sanitizer::SizeClassAllocator64::NonConstSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::NonConstSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..NonConstSpaceBeg">NonConstSpaceBeg</dfn>;</td></tr>
<tr><th id="572">572</th><td>  <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::SpaceBeg" title='__sanitizer::SizeClassAllocator64::SpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::SpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..SpaceBeg">SpaceBeg</dfn>() <em>const</em> {</td></tr>
<tr><th id="573">573</th><td>    <b>return</b> <a class="member" href="#__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg" title='__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..kUsingConstantSpaceBeg">kUsingConstantSpaceBeg</a> ? <a class="member" href="#__sanitizer::SizeClassAllocator64::kSpaceBeg" title='__sanitizer::SizeClassAllocator64::kSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::kSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..kSpaceBeg">kSpaceBeg</a> : <a class="member field" href="#__sanitizer::SizeClassAllocator64::NonConstSpaceBeg" title='__sanitizer::SizeClassAllocator64::NonConstSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::NonConstSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..NonConstSpaceBeg">NonConstSpaceBeg</a>;</td></tr>
<tr><th id="574">574</th><td>  }</td></tr>
<tr><th id="575">575</th><td>  <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::SpaceEnd" title='__sanitizer::SizeClassAllocator64::SpaceEnd' data-ref="__sanitizer::SizeClassAllocator64::SpaceEnd" data-ref-filename="__sanitizer..SizeClassAllocator64..SpaceEnd">SpaceEnd</dfn>() <em>const</em> { <b>return</b>  <a class="member fn" href="#__sanitizer::SizeClassAllocator64::SpaceBeg" title='__sanitizer::SizeClassAllocator64::SpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::SpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..SpaceBeg">SpaceBeg</a>() + <a class="member" href="#__sanitizer::SizeClassAllocator64::kSpaceSize" title='__sanitizer::SizeClassAllocator64::kSpaceSize' data-ref="__sanitizer::SizeClassAllocator64::kSpaceSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kSpaceSize">kSpaceSize</a>; }</td></tr>
<tr><th id="576">576</th><td>  <i>// kRegionSize must be &gt;= 2^32.</i></td></tr>
<tr><th id="577">577</th><td>  <a class="macro" href="sanitizer_internal_defs.h.html#332" title="static_assert((kRegionSize) &gt;= (1ULL &lt;&lt; (64 / 2)), &quot;&quot;)" data-ref="_M/COMPILER_CHECK">COMPILER_CHECK</a>((<a class="ref" href="#__sanitizer::SizeClassAllocator64::kRegionSize" title='__sanitizer::SizeClassAllocator64::kRegionSize' data-ref="__sanitizer::SizeClassAllocator64::kRegionSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kRegionSize">kRegionSize</a>) &gt;= (<var>1ULL</var> &lt;&lt; (<a class="macro" href="sanitizer_platform.h.html#125" title="64" data-ref="_M/SANITIZER_WORDSIZE">SANITIZER_WORDSIZE</a> / <var>2</var>)));</td></tr>
<tr><th id="578">578</th><td>  <i>// kRegionSize must be &lt;= 2^36, see CompactPtrT.</i></td></tr>
<tr><th id="579">579</th><td>  <a class="macro" href="sanitizer_internal_defs.h.html#332" title="static_assert((kRegionSize) &lt;= (1ULL &lt;&lt; (64 / 2 + 4)), &quot;&quot;)" data-ref="_M/COMPILER_CHECK">COMPILER_CHECK</a>((<a class="ref" href="#__sanitizer::SizeClassAllocator64::kRegionSize" title='__sanitizer::SizeClassAllocator64::kRegionSize' data-ref="__sanitizer::SizeClassAllocator64::kRegionSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kRegionSize">kRegionSize</a>) &lt;= (<var>1ULL</var> &lt;&lt; (<a class="macro" href="sanitizer_platform.h.html#125" title="64" data-ref="_M/SANITIZER_WORDSIZE">SANITIZER_WORDSIZE</a> / <var>2</var> + <var>4</var>)));</td></tr>
<tr><th id="580">580</th><td>  <i>// Call mmap for user memory with at least this size.</i></td></tr>
<tr><th id="581">581</th><td>  <em>static</em> <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl" id="__sanitizer::SizeClassAllocator64::kUserMapSize" title='__sanitizer::SizeClassAllocator64::kUserMapSize' data-ref="__sanitizer::SizeClassAllocator64::kUserMapSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kUserMapSize">kUserMapSize</dfn> = <var>1</var> &lt;&lt; <var>16</var>;</td></tr>
<tr><th id="582">582</th><td>  <i>// Call mmap for metadata memory with at least this size.</i></td></tr>
<tr><th id="583">583</th><td>  <em>static</em> <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl" id="__sanitizer::SizeClassAllocator64::kMetaMapSize" title='__sanitizer::SizeClassAllocator64::kMetaMapSize' data-ref="__sanitizer::SizeClassAllocator64::kMetaMapSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kMetaMapSize">kMetaMapSize</dfn> = <var>1</var> &lt;&lt; <var>16</var>;</td></tr>
<tr><th id="584">584</th><td>  <i>// Call mmap for free array memory with at least this size.</i></td></tr>
<tr><th id="585">585</th><td>  <em>static</em> <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl" id="__sanitizer::SizeClassAllocator64::kFreeArrayMapSize" title='__sanitizer::SizeClassAllocator64::kFreeArrayMapSize' data-ref="__sanitizer::SizeClassAllocator64::kFreeArrayMapSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kFreeArrayMapSize">kFreeArrayMapSize</dfn> = <var>1</var> &lt;&lt; <var>16</var>;</td></tr>
<tr><th id="586">586</th><td></td></tr>
<tr><th id="587">587</th><td>  <a class="type" href="sanitizer_atomic.h.html#__sanitizer::atomic_sint32_t" title='__sanitizer::atomic_sint32_t' data-ref="__sanitizer::atomic_sint32_t" data-ref-filename="__sanitizer..atomic_sint32_t">atomic_sint32_t</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::release_to_os_interval_ms_" title='__sanitizer::SizeClassAllocator64::release_to_os_interval_ms_' data-ref="__sanitizer::SizeClassAllocator64::release_to_os_interval_ms_" data-ref-filename="__sanitizer..SizeClassAllocator64..release_to_os_interval_ms_">release_to_os_interval_ms_</dfn>;</td></tr>
<tr><th id="588">588</th><td></td></tr>
<tr><th id="589">589</th><td>  <b>struct</b> <dfn class="type def" id="__sanitizer::SizeClassAllocator64::Stats" title='__sanitizer::SizeClassAllocator64::Stats' data-ref="__sanitizer::SizeClassAllocator64::Stats" data-ref-filename="__sanitizer..SizeClassAllocator64..Stats">Stats</dfn> {</td></tr>
<tr><th id="590">590</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::Stats::n_allocated" title='__sanitizer::SizeClassAllocator64::Stats::n_allocated' data-ref="__sanitizer::SizeClassAllocator64::Stats::n_allocated" data-ref-filename="__sanitizer..SizeClassAllocator64..Stats..n_allocated">n_allocated</dfn>;</td></tr>
<tr><th id="591">591</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::Stats::n_freed" title='__sanitizer::SizeClassAllocator64::Stats::n_freed' data-ref="__sanitizer::SizeClassAllocator64::Stats::n_freed" data-ref-filename="__sanitizer..SizeClassAllocator64..Stats..n_freed">n_freed</dfn>;</td></tr>
<tr><th id="592">592</th><td>  };</td></tr>
<tr><th id="593">593</th><td></td></tr>
<tr><th id="594">594</th><td>  <b>struct</b> <dfn class="type def" id="__sanitizer::SizeClassAllocator64::ReleaseToOsInfo" title='__sanitizer::SizeClassAllocator64::ReleaseToOsInfo' data-ref="__sanitizer::SizeClassAllocator64::ReleaseToOsInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..ReleaseToOsInfo">ReleaseToOsInfo</dfn> {</td></tr>
<tr><th id="595">595</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::ReleaseToOsInfo::n_freed_at_last_release" title='__sanitizer::SizeClassAllocator64::ReleaseToOsInfo::n_freed_at_last_release' data-ref="__sanitizer::SizeClassAllocator64::ReleaseToOsInfo::n_freed_at_last_release" data-ref-filename="__sanitizer..SizeClassAllocator64..ReleaseToOsInfo..n_freed_at_last_release">n_freed_at_last_release</dfn>;</td></tr>
<tr><th id="596">596</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::ReleaseToOsInfo::num_releases" title='__sanitizer::SizeClassAllocator64::ReleaseToOsInfo::num_releases' data-ref="__sanitizer::SizeClassAllocator64::ReleaseToOsInfo::num_releases" data-ref-filename="__sanitizer..SizeClassAllocator64..ReleaseToOsInfo..num_releases">num_releases</dfn>;</td></tr>
<tr><th id="597">597</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::u64" title='__sanitizer::u64' data-type='unsigned long long' data-ref="__sanitizer::u64" data-ref-filename="__sanitizer..u64">u64</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::ReleaseToOsInfo::last_release_at_ns" title='__sanitizer::SizeClassAllocator64::ReleaseToOsInfo::last_release_at_ns' data-ref="__sanitizer::SizeClassAllocator64::ReleaseToOsInfo::last_release_at_ns" data-ref-filename="__sanitizer..SizeClassAllocator64..ReleaseToOsInfo..last_release_at_ns">last_release_at_ns</dfn>;</td></tr>
<tr><th id="598">598</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::u64" title='__sanitizer::u64' data-type='unsigned long long' data-ref="__sanitizer::u64" data-ref-filename="__sanitizer..u64">u64</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::ReleaseToOsInfo::last_released_bytes" title='__sanitizer::SizeClassAllocator64::ReleaseToOsInfo::last_released_bytes' data-ref="__sanitizer::SizeClassAllocator64::ReleaseToOsInfo::last_released_bytes" data-ref-filename="__sanitizer..SizeClassAllocator64..ReleaseToOsInfo..last_released_bytes">last_released_bytes</dfn>;</td></tr>
<tr><th id="599">599</th><td>  };</td></tr>
<tr><th id="600">600</th><td></td></tr>
<tr><th id="601">601</th><td>  <b>struct</b> <a class="macro" href="sanitizer_internal_defs.h.html#223" title="__attribute__((aligned(64)))" data-ref="_M/ALIGNED">ALIGNED</a>(<a class="macro" href="sanitizer_platform.h.html#364" title="64" data-ref="_M/SANITIZER_CACHE_LINE_SIZE">SANITIZER_CACHE_LINE_SIZE</a>) <dfn class="type def" id="__sanitizer::SizeClassAllocator64::RegionInfo" title='__sanitizer::SizeClassAllocator64::RegionInfo' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo">RegionInfo</dfn> {</td></tr>
<tr><th id="602">602</th><td>    <a class="type" href="sanitizer_mutex.h.html#__sanitizer::BlockingMutex" title='__sanitizer::BlockingMutex' data-ref="__sanitizer::BlockingMutex" data-ref-filename="__sanitizer..BlockingMutex">BlockingMutex</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::RegionInfo::mutex" title='__sanitizer::SizeClassAllocator64::RegionInfo::mutex' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo::mutex" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo..mutex">mutex</dfn>;</td></tr>
<tr><th id="603">603</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::RegionInfo::num_freed_chunks" title='__sanitizer::SizeClassAllocator64::RegionInfo::num_freed_chunks' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo::num_freed_chunks" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo..num_freed_chunks">num_freed_chunks</dfn>;  <i>// Number of elements in the freearray.</i></td></tr>
<tr><th id="604">604</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::RegionInfo::mapped_free_array" title='__sanitizer::SizeClassAllocator64::RegionInfo::mapped_free_array' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo::mapped_free_array" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo..mapped_free_array">mapped_free_array</dfn>;  <i>// Bytes mapped for freearray.</i></td></tr>
<tr><th id="605">605</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::RegionInfo::allocated_user" title='__sanitizer::SizeClassAllocator64::RegionInfo::allocated_user' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo::allocated_user" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo..allocated_user">allocated_user</dfn>;  <i>// Bytes allocated for user memory.</i></td></tr>
<tr><th id="606">606</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::RegionInfo::allocated_meta" title='__sanitizer::SizeClassAllocator64::RegionInfo::allocated_meta' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo::allocated_meta" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo..allocated_meta">allocated_meta</dfn>;  <i>// Bytes allocated for metadata.</i></td></tr>
<tr><th id="607">607</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::RegionInfo::mapped_user" title='__sanitizer::SizeClassAllocator64::RegionInfo::mapped_user' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo::mapped_user" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo..mapped_user">mapped_user</dfn>;  <i>// Bytes mapped for user memory.</i></td></tr>
<tr><th id="608">608</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::RegionInfo::mapped_meta" title='__sanitizer::SizeClassAllocator64::RegionInfo::mapped_meta' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo::mapped_meta" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo..mapped_meta">mapped_meta</dfn>;  <i>// Bytes mapped for metadata.</i></td></tr>
<tr><th id="609">609</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::u32" title='__sanitizer::u32' data-type='unsigned int' data-ref="__sanitizer::u32" data-ref-filename="__sanitizer..u32">u32</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::RegionInfo::rand_state" title='__sanitizer::SizeClassAllocator64::RegionInfo::rand_state' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo::rand_state" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo..rand_state">rand_state</dfn>;  <i>// Seed for random shuffle, used if kRandomShuffleChunks.</i></td></tr>
<tr><th id="610">610</th><td>    <em>bool</em> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::RegionInfo::exhausted" title='__sanitizer::SizeClassAllocator64::RegionInfo::exhausted' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo::exhausted" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo..exhausted">exhausted</dfn>;  <i>// Whether region is out of space for new chunks.</i></td></tr>
<tr><th id="611">611</th><td>    <a class="type" href="#__sanitizer::SizeClassAllocator64::Stats" title='__sanitizer::SizeClassAllocator64::Stats' data-ref="__sanitizer::SizeClassAllocator64::Stats" data-ref-filename="__sanitizer..SizeClassAllocator64..Stats">Stats</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::RegionInfo::stats" title='__sanitizer::SizeClassAllocator64::RegionInfo::stats' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo::stats" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo..stats">stats</dfn>;</td></tr>
<tr><th id="612">612</th><td>    <a class="type" href="#__sanitizer::SizeClassAllocator64::ReleaseToOsInfo" title='__sanitizer::SizeClassAllocator64::ReleaseToOsInfo' data-ref="__sanitizer::SizeClassAllocator64::ReleaseToOsInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..ReleaseToOsInfo">ReleaseToOsInfo</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::RegionInfo::rtoi" title='__sanitizer::SizeClassAllocator64::RegionInfo::rtoi' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo::rtoi" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo..rtoi">rtoi</dfn>;</td></tr>
<tr><th id="613">613</th><td>  };</td></tr>
<tr><th id="614">614</th><td>  <a class="macro" href="sanitizer_internal_defs.h.html#332" title="static_assert(sizeof(RegionInfo) % kCacheLineSize == 0, &quot;&quot;)" data-ref="_M/COMPILER_CHECK">COMPILER_CHECK</a>(<b>sizeof</b>(<a class="type" href="#__sanitizer::SizeClassAllocator64::RegionInfo" title='__sanitizer::SizeClassAllocator64::RegionInfo' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo">RegionInfo</a>) % <a class="ref" href="sanitizer_common.h.html#__sanitizer::kCacheLineSize" title='__sanitizer::kCacheLineSize' data-ref="__sanitizer::kCacheLineSize" data-ref-filename="__sanitizer..kCacheLineSize">kCacheLineSize</a> == <var>0</var>);</td></tr>
<tr><th id="615">615</th><td></td></tr>
<tr><th id="616">616</th><td>  <a class="type" href="#__sanitizer::SizeClassAllocator64::RegionInfo" title='__sanitizer::SizeClassAllocator64::RegionInfo' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo">RegionInfo</a> *<dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::GetRegionInfo" title='__sanitizer::SizeClassAllocator64::GetRegionInfo' data-ref="__sanitizer::SizeClassAllocator64::GetRegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionInfo">GetRegionInfo</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col3 decl" id="1133class_id" title='class_id' data-type='__sanitizer::uptr' data-ref="1133class_id" data-ref-filename="1133class_id">class_id</dfn>) <em>const</em> {</td></tr>
<tr><th id="617">617</th><td>    <a class="macro" href="sanitizer_internal_defs.h.html#319" title="" data-ref="_M/DCHECK_LT">DCHECK_LT</a>(class_id, kNumClasses);</td></tr>
<tr><th id="618">618</th><td>    <a class="type" href="#__sanitizer::SizeClassAllocator64::RegionInfo" title='__sanitizer::SizeClassAllocator64::RegionInfo' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo">RegionInfo</a> *<dfn class="local col4 decl" id="1134regions" title='regions' data-type='__sanitizer::SizeClassAllocator64::RegionInfo *' data-ref="1134regions" data-ref-filename="1134regions">regions</dfn> = <b>reinterpret_cast</b>&lt;<a class="type" href="#__sanitizer::SizeClassAllocator64::RegionInfo" title='__sanitizer::SizeClassAllocator64::RegionInfo' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo">RegionInfo</a> *&gt;(<a class="member fn" href="#__sanitizer::SizeClassAllocator64::SpaceEnd" title='__sanitizer::SizeClassAllocator64::SpaceEnd' data-ref="__sanitizer::SizeClassAllocator64::SpaceEnd" data-ref-filename="__sanitizer..SizeClassAllocator64..SpaceEnd">SpaceEnd</a>());</td></tr>
<tr><th id="619">619</th><td>    <b>return</b> &amp;<a class="local col4 ref" href="#1134regions" title='regions' data-ref="1134regions" data-ref-filename="1134regions">regions</a>[<a class="local col3 ref" href="#1133class_id" title='class_id' data-ref="1133class_id" data-ref-filename="1133class_id">class_id</a>];</td></tr>
<tr><th id="620">620</th><td>  }</td></tr>
<tr><th id="621">621</th><td></td></tr>
<tr><th id="622">622</th><td>  <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::GetMetadataEnd" title='__sanitizer::SizeClassAllocator64::GetMetadataEnd' data-ref="__sanitizer::SizeClassAllocator64::GetMetadataEnd" data-ref-filename="__sanitizer..SizeClassAllocator64..GetMetadataEnd">GetMetadataEnd</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col5 decl" id="1135region_beg" title='region_beg' data-type='__sanitizer::uptr' data-ref="1135region_beg" data-ref-filename="1135region_beg">region_beg</dfn>) <em>const</em> {</td></tr>
<tr><th id="623">623</th><td>    <b>return</b> <a class="local col5 ref" href="#1135region_beg" title='region_beg' data-ref="1135region_beg" data-ref-filename="1135region_beg">region_beg</a> + <a class="member" href="#__sanitizer::SizeClassAllocator64::kRegionSize" title='__sanitizer::SizeClassAllocator64::kRegionSize' data-ref="__sanitizer::SizeClassAllocator64::kRegionSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kRegionSize">kRegionSize</a> - <a class="member" href="#__sanitizer::SizeClassAllocator64::kFreeArraySize" title='__sanitizer::SizeClassAllocator64::kFreeArraySize' data-ref="__sanitizer::SizeClassAllocator64::kFreeArraySize" data-ref-filename="__sanitizer..SizeClassAllocator64..kFreeArraySize">kFreeArraySize</a>;</td></tr>
<tr><th id="624">624</th><td>  }</td></tr>
<tr><th id="625">625</th><td></td></tr>
<tr><th id="626">626</th><td>  <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::GetChunkIdx" title='__sanitizer::SizeClassAllocator64::GetChunkIdx' data-ref="__sanitizer::SizeClassAllocator64::GetChunkIdx" data-ref-filename="__sanitizer..SizeClassAllocator64..GetChunkIdx">GetChunkIdx</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col6 decl" id="1136chunk" title='chunk' data-type='__sanitizer::uptr' data-ref="1136chunk" data-ref-filename="1136chunk">chunk</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col7 decl" id="1137size" title='size' data-type='__sanitizer::uptr' data-ref="1137size" data-ref-filename="1137size">size</dfn>) <em>const</em> {</td></tr>
<tr><th id="627">627</th><td>    <b>if</b> (!<a class="member" href="#__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg" title='__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..kUsingConstantSpaceBeg">kUsingConstantSpaceBeg</a>)</td></tr>
<tr><th id="628">628</th><td>      <a class="local col6 ref" href="#1136chunk" title='chunk' data-ref="1136chunk" data-ref-filename="1136chunk">chunk</a> -= <a class="member fn" href="#__sanitizer::SizeClassAllocator64::SpaceBeg" title='__sanitizer::SizeClassAllocator64::SpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::SpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..SpaceBeg">SpaceBeg</a>();</td></tr>
<tr><th id="629">629</th><td></td></tr>
<tr><th id="630">630</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col8 decl" id="1138offset" title='offset' data-type='__sanitizer::uptr' data-ref="1138offset" data-ref-filename="1138offset">offset</dfn> = <a class="local col6 ref" href="#1136chunk" title='chunk' data-ref="1136chunk" data-ref-filename="1136chunk">chunk</a> % <a class="member" href="#__sanitizer::SizeClassAllocator64::kRegionSize" title='__sanitizer::SizeClassAllocator64::kRegionSize' data-ref="__sanitizer::SizeClassAllocator64::kRegionSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kRegionSize">kRegionSize</a>;</td></tr>
<tr><th id="631">631</th><td>    <i>// Here we divide by a non-constant. This is costly.</i></td></tr>
<tr><th id="632">632</th><td><i>    // size always fits into 32-bits. If the offset fits too, use 32-bit div.</i></td></tr>
<tr><th id="633">633</th><td>    <b>if</b> (<a class="local col8 ref" href="#1138offset" title='offset' data-ref="1138offset" data-ref-filename="1138offset">offset</a> &gt;&gt; (<a class="macro" href="sanitizer_platform.h.html#125" title="64" data-ref="_M/SANITIZER_WORDSIZE">SANITIZER_WORDSIZE</a> / <var>2</var>))</td></tr>
<tr><th id="634">634</th><td>      <b>return</b> <a class="local col8 ref" href="#1138offset" title='offset' data-ref="1138offset" data-ref-filename="1138offset">offset</a> / <a class="local col7 ref" href="#1137size" title='size' data-ref="1137size" data-ref-filename="1137size">size</a>;</td></tr>
<tr><th id="635">635</th><td>    <b>return</b> (<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::u32" title='__sanitizer::u32' data-type='unsigned int' data-ref="__sanitizer::u32" data-ref-filename="__sanitizer..u32">u32</a>)<a class="local col8 ref" href="#1138offset" title='offset' data-ref="1138offset" data-ref-filename="1138offset">offset</a> / (<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::u32" title='__sanitizer::u32' data-type='unsigned int' data-ref="__sanitizer::u32" data-ref-filename="__sanitizer..u32">u32</a>)<a class="local col7 ref" href="#1137size" title='size' data-ref="1137size" data-ref-filename="1137size">size</a>;</td></tr>
<tr><th id="636">636</th><td>  }</td></tr>
<tr><th id="637">637</th><td></td></tr>
<tr><th id="638">638</th><td>  <a class="typedef" href="#__sanitizer::SizeClassAllocator64::CompactPtrT" title='__sanitizer::SizeClassAllocator64::CompactPtrT' data-type='__sanitizer::u32' data-ref="__sanitizer::SizeClassAllocator64::CompactPtrT" data-ref-filename="__sanitizer..SizeClassAllocator64..CompactPtrT">CompactPtrT</a> *<dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::GetFreeArray" title='__sanitizer::SizeClassAllocator64::GetFreeArray' data-ref="__sanitizer::SizeClassAllocator64::GetFreeArray" data-ref-filename="__sanitizer..SizeClassAllocator64..GetFreeArray">GetFreeArray</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col9 decl" id="1139region_beg" title='region_beg' data-type='__sanitizer::uptr' data-ref="1139region_beg" data-ref-filename="1139region_beg">region_beg</dfn>) <em>const</em> {</td></tr>
<tr><th id="639">639</th><td>    <b>return</b> <b>reinterpret_cast</b>&lt;<a class="typedef" href="#__sanitizer::SizeClassAllocator64::CompactPtrT" title='__sanitizer::SizeClassAllocator64::CompactPtrT' data-type='__sanitizer::u32' data-ref="__sanitizer::SizeClassAllocator64::CompactPtrT" data-ref-filename="__sanitizer..SizeClassAllocator64..CompactPtrT">CompactPtrT</a> *&gt;(<a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetMetadataEnd" title='__sanitizer::SizeClassAllocator64::GetMetadataEnd' data-ref="__sanitizer::SizeClassAllocator64::GetMetadataEnd" data-ref-filename="__sanitizer..SizeClassAllocator64..GetMetadataEnd">GetMetadataEnd</a>(<a class="local col9 ref" href="#1139region_beg" title='region_beg' data-ref="1139region_beg" data-ref-filename="1139region_beg">region_beg</a>));</td></tr>
<tr><th id="640">640</th><td>  }</td></tr>
<tr><th id="641">641</th><td></td></tr>
<tr><th id="642">642</th><td>  <em>bool</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::MapWithCallback" title='__sanitizer::SizeClassAllocator64::MapWithCallback' data-ref="__sanitizer::SizeClassAllocator64::MapWithCallback" data-ref-filename="__sanitizer..SizeClassAllocator64..MapWithCallback">MapWithCallback</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col0 decl" id="1140beg" title='beg' data-type='__sanitizer::uptr' data-ref="1140beg" data-ref-filename="1140beg">beg</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col1 decl" id="1141size" title='size' data-type='__sanitizer::uptr' data-ref="1141size" data-ref-filename="1141size">size</dfn>, <em>const</em> <em>char</em> *<dfn class="local col2 decl" id="1142name" title='name' data-type='const char *' data-ref="1142name" data-ref-filename="1142name">name</dfn>) {</td></tr>
<tr><th id="643">643</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col3 decl" id="1143mapped" title='mapped' data-type='__sanitizer::uptr' data-ref="1143mapped" data-ref-filename="1143mapped">mapped</dfn> = <a class="member field" href="#__sanitizer::SizeClassAllocator64::address_range" title='__sanitizer::SizeClassAllocator64::address_range' data-ref="__sanitizer::SizeClassAllocator64::address_range" data-ref-filename="__sanitizer..SizeClassAllocator64..address_range">address_range</a>.<a class="ref fn" href="sanitizer_common.h.html#__sanitizer::ReservedAddressRange::Map" title='__sanitizer::ReservedAddressRange::Map' data-ref="__sanitizer::ReservedAddressRange::Map" data-ref-filename="__sanitizer..ReservedAddressRange..Map">Map</a>(<a class="local col0 ref" href="#1140beg" title='beg' data-ref="1140beg" data-ref-filename="1140beg">beg</a>, <a class="local col1 ref" href="#1141size" title='size' data-ref="1141size" data-ref-filename="1141size">size</a>, <a class="local col2 ref" href="#1142name" title='name' data-ref="1142name" data-ref-filename="1142name">name</a>);</td></tr>
<tr><th id="644">644</th><td>    <b>if</b> (<a class="macro" href="sanitizer_internal_defs.h.html#229" title="__builtin_expect(!!(!mapped), 0)" data-ref="_M/UNLIKELY">UNLIKELY</a>(!<a class="local col3 ref" href="#1143mapped" title='mapped' data-ref="1143mapped" data-ref-filename="1143mapped">mapped</a>))</td></tr>
<tr><th id="645">645</th><td>      <b>return</b> <b>false</b>;</td></tr>
<tr><th id="646">646</th><td>    <a class="macro" href="sanitizer_internal_defs.h.html#300" title="do { __sanitizer::u64 v1 = (__sanitizer::u64)((beg)); __sanitizer::u64 v2 = (__sanitizer::u64)((mapped)); if (__builtin_expect(!!(!(v1 == v2)), 0)) __sanitizer::CheckFailed(&quot;/fast/tmp/llvm-proj-12/compiler-rt/lib/asan/../sanitizer_common/sanitizer_allocator_primary64.h&quot;, 646, &quot;(&quot; &quot;(beg)&quot; &quot;) &quot; &quot;==&quot; &quot; (&quot; &quot;(mapped)&quot; &quot;)&quot;, v1, v2); } while (false)" data-ref="_M/CHECK_EQ">CHECK_EQ</a>(<a class="local col0 ref" href="#1140beg" title='beg' data-ref="1140beg" data-ref-filename="1140beg">beg</a>, <a class="local col3 ref" href="#1143mapped" title='mapped' data-ref="1143mapped" data-ref-filename="1143mapped">mapped</a>);</td></tr>
<tr><th id="647">647</th><td>    <a class="typedef" href="#__sanitizer::SizeClassAllocator64::MapUnmapCallback" title='__sanitizer::SizeClassAllocator64::MapUnmapCallback' data-type='typename Params::MapUnmapCallback' data-ref="__sanitizer::SizeClassAllocator64::MapUnmapCallback" data-ref-filename="__sanitizer..SizeClassAllocator64..MapUnmapCallback">MapUnmapCallback</a>().OnMap(<a class="local col0 ref" href="#1140beg" title='beg' data-ref="1140beg" data-ref-filename="1140beg">beg</a>, <a class="local col1 ref" href="#1141size" title='size' data-ref="1141size" data-ref-filename="1141size">size</a>);</td></tr>
<tr><th id="648">648</th><td>    <b>return</b> <b>true</b>;</td></tr>
<tr><th id="649">649</th><td>  }</td></tr>
<tr><th id="650">650</th><td></td></tr>
<tr><th id="651">651</th><td>  <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::MapWithCallbackOrDie" title='__sanitizer::SizeClassAllocator64::MapWithCallbackOrDie' data-ref="__sanitizer::SizeClassAllocator64::MapWithCallbackOrDie" data-ref-filename="__sanitizer..SizeClassAllocator64..MapWithCallbackOrDie">MapWithCallbackOrDie</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col4 decl" id="1144beg" title='beg' data-type='__sanitizer::uptr' data-ref="1144beg" data-ref-filename="1144beg">beg</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col5 decl" id="1145size" title='size' data-type='__sanitizer::uptr' data-ref="1145size" data-ref-filename="1145size">size</dfn>, <em>const</em> <em>char</em> *<dfn class="local col6 decl" id="1146name" title='name' data-type='const char *' data-ref="1146name" data-ref-filename="1146name">name</dfn>) {</td></tr>
<tr><th id="652">652</th><td>    <a class="macro" href="sanitizer_internal_defs.h.html#300" title="do { __sanitizer::u64 v1 = (__sanitizer::u64)((beg)); __sanitizer::u64 v2 = (__sanitizer::u64)((address_range.MapOrDie(beg, size, name))); if (__builtin_expect(!!(!(v1 == v2)), 0)) __sanitizer::CheckFailed(&quot;/fast/tmp/llvm-proj-12/compiler-rt/lib/asan/../sanitizer_common/sanitizer_allocator_primary64.h&quot;, 652, &quot;(&quot; &quot;(beg)&quot; &quot;) &quot; &quot;==&quot; &quot; (&quot; &quot;(address_range.MapOrDie(beg, size, name))&quot; &quot;)&quot;, v1, v2); } while (false)" data-ref="_M/CHECK_EQ">CHECK_EQ</a>(<a class="local col4 ref" href="#1144beg" title='beg' data-ref="1144beg" data-ref-filename="1144beg">beg</a>, <a class="member field" href="#__sanitizer::SizeClassAllocator64::address_range" title='__sanitizer::SizeClassAllocator64::address_range' data-ref="__sanitizer::SizeClassAllocator64::address_range" data-ref-filename="__sanitizer..SizeClassAllocator64..address_range">address_range</a>.<a class="ref fn" href="sanitizer_common.h.html#__sanitizer::ReservedAddressRange::MapOrDie" title='__sanitizer::ReservedAddressRange::MapOrDie' data-ref="__sanitizer::ReservedAddressRange::MapOrDie" data-ref-filename="__sanitizer..ReservedAddressRange..MapOrDie">MapOrDie</a>(<a class="local col4 ref" href="#1144beg" title='beg' data-ref="1144beg" data-ref-filename="1144beg">beg</a>, <a class="local col5 ref" href="#1145size" title='size' data-ref="1145size" data-ref-filename="1145size">size</a>, <a class="local col6 ref" href="#1146name" title='name' data-ref="1146name" data-ref-filename="1146name">name</a>));</td></tr>
<tr><th id="653">653</th><td>    <a class="typedef" href="#__sanitizer::SizeClassAllocator64::MapUnmapCallback" title='__sanitizer::SizeClassAllocator64::MapUnmapCallback' data-type='typename Params::MapUnmapCallback' data-ref="__sanitizer::SizeClassAllocator64::MapUnmapCallback" data-ref-filename="__sanitizer..SizeClassAllocator64..MapUnmapCallback">MapUnmapCallback</a>().OnMap(<a class="local col4 ref" href="#1144beg" title='beg' data-ref="1144beg" data-ref-filename="1144beg">beg</a>, <a class="local col5 ref" href="#1145size" title='size' data-ref="1145size" data-ref-filename="1145size">size</a>);</td></tr>
<tr><th id="654">654</th><td>  }</td></tr>
<tr><th id="655">655</th><td></td></tr>
<tr><th id="656">656</th><td>  <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::UnmapWithCallbackOrDie" title='__sanitizer::SizeClassAllocator64::UnmapWithCallbackOrDie' data-ref="__sanitizer::SizeClassAllocator64::UnmapWithCallbackOrDie" data-ref-filename="__sanitizer..SizeClassAllocator64..UnmapWithCallbackOrDie">UnmapWithCallbackOrDie</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col7 decl" id="1147beg" title='beg' data-type='__sanitizer::uptr' data-ref="1147beg" data-ref-filename="1147beg">beg</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col8 decl" id="1148size" title='size' data-type='__sanitizer::uptr' data-ref="1148size" data-ref-filename="1148size">size</dfn>) {</td></tr>
<tr><th id="657">657</th><td>    <a class="typedef" href="#__sanitizer::SizeClassAllocator64::MapUnmapCallback" title='__sanitizer::SizeClassAllocator64::MapUnmapCallback' data-type='typename Params::MapUnmapCallback' data-ref="__sanitizer::SizeClassAllocator64::MapUnmapCallback" data-ref-filename="__sanitizer..SizeClassAllocator64..MapUnmapCallback">MapUnmapCallback</a>().OnUnmap(<a class="local col7 ref" href="#1147beg" title='beg' data-ref="1147beg" data-ref-filename="1147beg">beg</a>, <a class="local col8 ref" href="#1148size" title='size' data-ref="1148size" data-ref-filename="1148size">size</a>);</td></tr>
<tr><th id="658">658</th><td>    <a class="member field" href="#__sanitizer::SizeClassAllocator64::address_range" title='__sanitizer::SizeClassAllocator64::address_range' data-ref="__sanitizer::SizeClassAllocator64::address_range" data-ref-filename="__sanitizer..SizeClassAllocator64..address_range">address_range</a>.<a class="ref fn" href="sanitizer_common.h.html#__sanitizer::ReservedAddressRange::Unmap" title='__sanitizer::ReservedAddressRange::Unmap' data-ref="__sanitizer::ReservedAddressRange::Unmap" data-ref-filename="__sanitizer..ReservedAddressRange..Unmap">Unmap</a>(<a class="local col7 ref" href="#1147beg" title='beg' data-ref="1147beg" data-ref-filename="1147beg">beg</a>, <a class="local col8 ref" href="#1148size" title='size' data-ref="1148size" data-ref-filename="1148size">size</a>);</td></tr>
<tr><th id="659">659</th><td>  }</td></tr>
<tr><th id="660">660</th><td></td></tr>
<tr><th id="661">661</th><td>  <em>bool</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::EnsureFreeArraySpace" title='__sanitizer::SizeClassAllocator64::EnsureFreeArraySpace' data-ref="__sanitizer::SizeClassAllocator64::EnsureFreeArraySpace" data-ref-filename="__sanitizer..SizeClassAllocator64..EnsureFreeArraySpace">EnsureFreeArraySpace</dfn>(<a class="type" href="#__sanitizer::SizeClassAllocator64::RegionInfo" title='__sanitizer::SizeClassAllocator64::RegionInfo' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo">RegionInfo</a> *<dfn class="local col9 decl" id="1149region" title='region' data-type='__sanitizer::SizeClassAllocator64::RegionInfo *' data-ref="1149region" data-ref-filename="1149region">region</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col0 decl" id="1150region_beg" title='region_beg' data-type='__sanitizer::uptr' data-ref="1150region_beg" data-ref-filename="1150region_beg">region_beg</dfn>,</td></tr>
<tr><th id="662">662</th><td>                            <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col1 decl" id="1151num_freed_chunks" title='num_freed_chunks' data-type='__sanitizer::uptr' data-ref="1151num_freed_chunks" data-ref-filename="1151num_freed_chunks">num_freed_chunks</dfn>) {</td></tr>
<tr><th id="663">663</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col2 decl" id="1152needed_space" title='needed_space' data-type='__sanitizer::uptr' data-ref="1152needed_space" data-ref-filename="1152needed_space">needed_space</dfn> = <a class="local col1 ref" href="#1151num_freed_chunks" title='num_freed_chunks' data-ref="1151num_freed_chunks" data-ref-filename="1151num_freed_chunks">num_freed_chunks</a> * <b>sizeof</b>(<a class="typedef" href="#__sanitizer::SizeClassAllocator64::CompactPtrT" title='__sanitizer::SizeClassAllocator64::CompactPtrT' data-type='__sanitizer::u32' data-ref="__sanitizer::SizeClassAllocator64::CompactPtrT" data-ref-filename="__sanitizer..SizeClassAllocator64..CompactPtrT">CompactPtrT</a>);</td></tr>
<tr><th id="664">664</th><td>    <b>if</b> (<a class="local col9 ref" href="#1149region" title='region' data-ref="1149region" data-ref-filename="1149region">region</a>-&gt;mapped_free_array &lt; <a class="local col2 ref" href="#1152needed_space" title='needed_space' data-ref="1152needed_space" data-ref-filename="1152needed_space">needed_space</a>) {</td></tr>
<tr><th id="665">665</th><td>      <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col3 decl" id="1153new_mapped_free_array" title='new_mapped_free_array' data-type='__sanitizer::uptr' data-ref="1153new_mapped_free_array" data-ref-filename="1153new_mapped_free_array">new_mapped_free_array</dfn> = <a class="ref fn" href="sanitizer_common.h.html#__sanitizer::RoundUpTo" title='__sanitizer::RoundUpTo' data-ref="__sanitizer::RoundUpTo" data-ref-filename="__sanitizer..RoundUpTo">RoundUpTo</a>(<a class="local col2 ref" href="#1152needed_space" title='needed_space' data-ref="1152needed_space" data-ref-filename="1152needed_space">needed_space</a>, <a class="member" href="#__sanitizer::SizeClassAllocator64::kFreeArrayMapSize" title='__sanitizer::SizeClassAllocator64::kFreeArrayMapSize' data-ref="__sanitizer::SizeClassAllocator64::kFreeArrayMapSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kFreeArrayMapSize">kFreeArrayMapSize</a>);</td></tr>
<tr><th id="666">666</th><td>      <a class="macro" href="sanitizer_internal_defs.h.html#303" title="do { __sanitizer::u64 v1 = (__sanitizer::u64)((new_mapped_free_array)); __sanitizer::u64 v2 = (__sanitizer::u64)((kFreeArraySize)); if (__builtin_expect(!!(!(v1 &lt;= v2)), 0)) __sanitizer::CheckFailed(&quot;/fast/tmp/llvm-proj-12/compiler-rt/lib/asan/../sanitizer_common/sanitizer_allocator_primary64.h&quot;, 666, &quot;(&quot; &quot;(new_mapped_free_array)&quot; &quot;) &quot; &quot;&lt;=&quot; &quot; (&quot; &quot;(kFreeArraySize)&quot; &quot;)&quot;, v1, v2); } while (false)" data-ref="_M/CHECK_LE">CHECK_LE</a>(<a class="local col3 ref" href="#1153new_mapped_free_array" title='new_mapped_free_array' data-ref="1153new_mapped_free_array" data-ref-filename="1153new_mapped_free_array">new_mapped_free_array</a>, <a class="member" href="#__sanitizer::SizeClassAllocator64::kFreeArraySize" title='__sanitizer::SizeClassAllocator64::kFreeArraySize' data-ref="__sanitizer::SizeClassAllocator64::kFreeArraySize" data-ref-filename="__sanitizer..SizeClassAllocator64..kFreeArraySize">kFreeArraySize</a>);</td></tr>
<tr><th id="667">667</th><td>      <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col4 decl" id="1154current_map_end" title='current_map_end' data-type='__sanitizer::uptr' data-ref="1154current_map_end" data-ref-filename="1154current_map_end">current_map_end</dfn> = <b>reinterpret_cast</b>&lt;<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a>&gt;(<a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetFreeArray" title='__sanitizer::SizeClassAllocator64::GetFreeArray' data-ref="__sanitizer::SizeClassAllocator64::GetFreeArray" data-ref-filename="__sanitizer..SizeClassAllocator64..GetFreeArray">GetFreeArray</a>(<a class="local col0 ref" href="#1150region_beg" title='region_beg' data-ref="1150region_beg" data-ref-filename="1150region_beg">region_beg</a>)) +</td></tr>
<tr><th id="668">668</th><td>                             <a class="local col9 ref" href="#1149region" title='region' data-ref="1149region" data-ref-filename="1149region">region</a>-&gt;mapped_free_array;</td></tr>
<tr><th id="669">669</th><td>      <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col5 decl" id="1155new_map_size" title='new_map_size' data-type='__sanitizer::uptr' data-ref="1155new_map_size" data-ref-filename="1155new_map_size">new_map_size</dfn> = <a class="local col3 ref" href="#1153new_mapped_free_array" title='new_mapped_free_array' data-ref="1153new_mapped_free_array" data-ref-filename="1153new_mapped_free_array">new_mapped_free_array</a> - <a class="local col9 ref" href="#1149region" title='region' data-ref="1149region" data-ref-filename="1149region">region</a>-&gt;mapped_free_array;</td></tr>
<tr><th id="670">670</th><td>      <b>if</b> (<a class="macro" href="sanitizer_internal_defs.h.html#229" title="__builtin_expect(!!(!MapWithCallback(current_map_end, new_map_size, &quot;SizeClassAllocator: freearray&quot;)), 0)" data-ref="_M/UNLIKELY">UNLIKELY</a>(!<a class="member fn" href="#__sanitizer::SizeClassAllocator64::MapWithCallback" title='__sanitizer::SizeClassAllocator64::MapWithCallback' data-ref="__sanitizer::SizeClassAllocator64::MapWithCallback" data-ref-filename="__sanitizer..SizeClassAllocator64..MapWithCallback">MapWithCallback</a>(<a class="local col4 ref" href="#1154current_map_end" title='current_map_end' data-ref="1154current_map_end" data-ref-filename="1154current_map_end">current_map_end</a>, <a class="local col5 ref" href="#1155new_map_size" title='new_map_size' data-ref="1155new_map_size" data-ref-filename="1155new_map_size">new_map_size</a>,</td></tr>
<tr><th id="671">671</th><td>                                    <q>"SizeClassAllocator: freearray"</q>)))</td></tr>
<tr><th id="672">672</th><td>        <b>return</b> <b>false</b>;</td></tr>
<tr><th id="673">673</th><td>      <a class="local col9 ref" href="#1149region" title='region' data-ref="1149region" data-ref-filename="1149region">region</a>-&gt;mapped_free_array = <a class="local col3 ref" href="#1153new_mapped_free_array" title='new_mapped_free_array' data-ref="1153new_mapped_free_array" data-ref-filename="1153new_mapped_free_array">new_mapped_free_array</a>;</td></tr>
<tr><th id="674">674</th><td>    }</td></tr>
<tr><th id="675">675</th><td>    <b>return</b> <b>true</b>;</td></tr>
<tr><th id="676">676</th><td>  }</td></tr>
<tr><th id="677">677</th><td></td></tr>
<tr><th id="678">678</th><td>  <i>// Check whether this size class is exhausted.</i></td></tr>
<tr><th id="679">679</th><td>  <em>bool</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::IsRegionExhausted" title='__sanitizer::SizeClassAllocator64::IsRegionExhausted' data-ref="__sanitizer::SizeClassAllocator64::IsRegionExhausted" data-ref-filename="__sanitizer..SizeClassAllocator64..IsRegionExhausted">IsRegionExhausted</dfn>(<a class="type" href="#__sanitizer::SizeClassAllocator64::RegionInfo" title='__sanitizer::SizeClassAllocator64::RegionInfo' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo">RegionInfo</a> *<dfn class="local col6 decl" id="1156region" title='region' data-type='__sanitizer::SizeClassAllocator64::RegionInfo *' data-ref="1156region" data-ref-filename="1156region">region</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col7 decl" id="1157class_id" title='class_id' data-type='__sanitizer::uptr' data-ref="1157class_id" data-ref-filename="1157class_id">class_id</dfn>,</td></tr>
<tr><th id="680">680</th><td>                         <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col8 decl" id="1158additional_map_size" title='additional_map_size' data-type='__sanitizer::uptr' data-ref="1158additional_map_size" data-ref-filename="1158additional_map_size">additional_map_size</dfn>) {</td></tr>
<tr><th id="681">681</th><td>    <b>if</b> (<a class="macro" href="sanitizer_internal_defs.h.html#228" title="__builtin_expect(!!(region-&gt;mapped_user + region-&gt;mapped_meta + additional_map_size &lt;= kRegionSize - kFreeArraySize), 1)" data-ref="_M/LIKELY">LIKELY</a>(<a class="local col6 ref" href="#1156region" title='region' data-ref="1156region" data-ref-filename="1156region">region</a>-&gt;mapped_user + <a class="local col6 ref" href="#1156region" title='region' data-ref="1156region" data-ref-filename="1156region">region</a>-&gt;mapped_meta +</td></tr>
<tr><th id="682">682</th><td>               <a class="local col8 ref" href="#1158additional_map_size" title='additional_map_size' data-ref="1158additional_map_size" data-ref-filename="1158additional_map_size">additional_map_size</a> &lt;= <a class="member" href="#__sanitizer::SizeClassAllocator64::kRegionSize" title='__sanitizer::SizeClassAllocator64::kRegionSize' data-ref="__sanitizer::SizeClassAllocator64::kRegionSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kRegionSize">kRegionSize</a> - <a class="member" href="#__sanitizer::SizeClassAllocator64::kFreeArraySize" title='__sanitizer::SizeClassAllocator64::kFreeArraySize' data-ref="__sanitizer::SizeClassAllocator64::kFreeArraySize" data-ref-filename="__sanitizer..SizeClassAllocator64..kFreeArraySize">kFreeArraySize</a>))</td></tr>
<tr><th id="683">683</th><td>      <b>return</b> <b>false</b>;</td></tr>
<tr><th id="684">684</th><td>    <b>if</b> (!<a class="local col6 ref" href="#1156region" title='region' data-ref="1156region" data-ref-filename="1156region">region</a>-&gt;exhausted) {</td></tr>
<tr><th id="685">685</th><td>      <a class="local col6 ref" href="#1156region" title='region' data-ref="1156region" data-ref-filename="1156region">region</a>-&gt;exhausted = <b>true</b>;</td></tr>
<tr><th id="686">686</th><td>      <a class="ref fn" href="sanitizer_common.h.html#__sanitizer::Printf" title='__sanitizer::Printf' data-ref="__sanitizer::Printf" data-ref-filename="__sanitizer..Printf">Printf</a>(<q>"%s: Out of memory. "</q>, <a class="ref" href="sanitizer_common.h.html#__sanitizer::SanitizerToolName" title='__sanitizer::SanitizerToolName' data-ref="__sanitizer::SanitizerToolName" data-ref-filename="__sanitizer..SanitizerToolName">SanitizerToolName</a>);</td></tr>
<tr><th id="687">687</th><td>      <a class="ref fn" href="sanitizer_common.h.html#__sanitizer::Printf" title='__sanitizer::Printf' data-ref="__sanitizer::Printf" data-ref-filename="__sanitizer..Printf">Printf</a>(<q>"The process has exhausted %zuMB for size class %zu.\n"</q>,</td></tr>
<tr><th id="688">688</th><td>             <a class="member" href="#__sanitizer::SizeClassAllocator64::kRegionSize" title='__sanitizer::SizeClassAllocator64::kRegionSize' data-ref="__sanitizer::SizeClassAllocator64::kRegionSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kRegionSize">kRegionSize</a> &gt;&gt; <var>20</var>, <a class="member fn" href="#__sanitizer::SizeClassAllocator64::ClassIdToSize" title='__sanitizer::SizeClassAllocator64::ClassIdToSize' data-ref="__sanitizer::SizeClassAllocator64::ClassIdToSize" data-ref-filename="__sanitizer..SizeClassAllocator64..ClassIdToSize">ClassIdToSize</a>(<a class="local col7 ref" href="#1157class_id" title='class_id' data-ref="1157class_id" data-ref-filename="1157class_id">class_id</a>));</td></tr>
<tr><th id="689">689</th><td>    }</td></tr>
<tr><th id="690">690</th><td>    <b>return</b> <b>true</b>;</td></tr>
<tr><th id="691">691</th><td>  }</td></tr>
<tr><th id="692">692</th><td></td></tr>
<tr><th id="693">693</th><td>  <a class="macro" href="sanitizer_internal_defs.h.html#225" title="__attribute__((noinline))" data-ref="_M/NOINLINE">NOINLINE</a> <em>bool</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::PopulateFreeArray" title='__sanitizer::SizeClassAllocator64::PopulateFreeArray' data-ref="__sanitizer::SizeClassAllocator64::PopulateFreeArray" data-ref-filename="__sanitizer..SizeClassAllocator64..PopulateFreeArray">PopulateFreeArray</dfn>(<a class="type" href="sanitizer_allocator_stats.h.html#__sanitizer::AllocatorStats" title='__sanitizer::AllocatorStats' data-ref="__sanitizer::AllocatorStats" data-ref-filename="__sanitizer..AllocatorStats">AllocatorStats</a> *<dfn class="local col9 decl" id="1159stat" title='stat' data-type='__sanitizer::AllocatorStats *' data-ref="1159stat" data-ref-filename="1159stat">stat</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col0 decl" id="1160class_id" title='class_id' data-type='__sanitizer::uptr' data-ref="1160class_id" data-ref-filename="1160class_id">class_id</dfn>,</td></tr>
<tr><th id="694">694</th><td>                                  <a class="type" href="#__sanitizer::SizeClassAllocator64::RegionInfo" title='__sanitizer::SizeClassAllocator64::RegionInfo' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo">RegionInfo</a> *<dfn class="local col1 decl" id="1161region" title='region' data-type='__sanitizer::SizeClassAllocator64::RegionInfo *' data-ref="1161region" data-ref-filename="1161region">region</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col2 decl" id="1162requested_count" title='requested_count' data-type='__sanitizer::uptr' data-ref="1162requested_count" data-ref-filename="1162requested_count">requested_count</dfn>) {</td></tr>
<tr><th id="695">695</th><td>    <i>// region-&gt;mutex is held.</i></td></tr>
<tr><th id="696">696</th><td>    <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col3 decl" id="1163region_beg" title='region_beg' data-type='const __sanitizer::uptr' data-ref="1163region_beg" data-ref-filename="1163region_beg">region_beg</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetRegionBeginBySizeClass" title='__sanitizer::SizeClassAllocator64::GetRegionBeginBySizeClass' data-ref="__sanitizer::SizeClassAllocator64::GetRegionBeginBySizeClass" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionBeginBySizeClass">GetRegionBeginBySizeClass</a>(<a class="local col0 ref" href="#1160class_id" title='class_id' data-ref="1160class_id" data-ref-filename="1160class_id">class_id</a>);</td></tr>
<tr><th id="697">697</th><td>    <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col4 decl" id="1164size" title='size' data-type='const __sanitizer::uptr' data-ref="1164size" data-ref-filename="1164size">size</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::ClassIdToSize" title='__sanitizer::SizeClassAllocator64::ClassIdToSize' data-ref="__sanitizer::SizeClassAllocator64::ClassIdToSize" data-ref-filename="__sanitizer..SizeClassAllocator64..ClassIdToSize">ClassIdToSize</a>(<a class="local col0 ref" href="#1160class_id" title='class_id' data-ref="1160class_id" data-ref-filename="1160class_id">class_id</a>);</td></tr>
<tr><th id="698">698</th><td></td></tr>
<tr><th id="699">699</th><td>    <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col5 decl" id="1165total_user_bytes" title='total_user_bytes' data-type='const __sanitizer::uptr' data-ref="1165total_user_bytes" data-ref-filename="1165total_user_bytes">total_user_bytes</dfn> =</td></tr>
<tr><th id="700">700</th><td>        <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;allocated_user + <a class="local col2 ref" href="#1162requested_count" title='requested_count' data-ref="1162requested_count" data-ref-filename="1162requested_count">requested_count</a> * <a class="local col4 ref" href="#1164size" title='size' data-ref="1164size" data-ref-filename="1164size">size</a>;</td></tr>
<tr><th id="701">701</th><td>    <i>// Map more space for chunks, if necessary.</i></td></tr>
<tr><th id="702">702</th><td>    <b>if</b> (<a class="macro" href="sanitizer_internal_defs.h.html#228" title="__builtin_expect(!!(total_user_bytes &gt; region-&gt;mapped_user), 1)" data-ref="_M/LIKELY">LIKELY</a>(<a class="local col5 ref" href="#1165total_user_bytes" title='total_user_bytes' data-ref="1165total_user_bytes" data-ref-filename="1165total_user_bytes">total_user_bytes</a> &gt; <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;mapped_user)) {</td></tr>
<tr><th id="703">703</th><td>      <b>if</b> (<a class="macro" href="sanitizer_internal_defs.h.html#229" title="__builtin_expect(!!(region-&gt;mapped_user == 0), 0)" data-ref="_M/UNLIKELY">UNLIKELY</a>(<a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;mapped_user == <var>0</var>)) {</td></tr>
<tr><th id="704">704</th><td>        <b>if</b> (!<a class="member" href="#__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg" title='__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg' data-ref="__sanitizer::SizeClassAllocator64::kUsingConstantSpaceBeg" data-ref-filename="__sanitizer..SizeClassAllocator64..kUsingConstantSpaceBeg">kUsingConstantSpaceBeg</a> &amp;&amp; <a class="member" href="#__sanitizer::SizeClassAllocator64::kRandomShuffleChunks" title='__sanitizer::SizeClassAllocator64::kRandomShuffleChunks' data-ref="__sanitizer::SizeClassAllocator64::kRandomShuffleChunks" data-ref-filename="__sanitizer..SizeClassAllocator64..kRandomShuffleChunks">kRandomShuffleChunks</a>)</td></tr>
<tr><th id="705">705</th><td>          <i>// The random state is initialized from ASLR.</i></td></tr>
<tr><th id="706">706</th><td>          <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;rand_state = <b>static_cast</b>&lt;<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::u32" title='__sanitizer::u32' data-type='unsigned int' data-ref="__sanitizer::u32" data-ref-filename="__sanitizer..u32">u32</a>&gt;(<a class="local col3 ref" href="#1163region_beg" title='region_beg' data-ref="1163region_beg" data-ref-filename="1163region_beg">region_beg</a> &gt;&gt; <var>12</var>);</td></tr>
<tr><th id="707">707</th><td>        <i>// Postpone the first release to OS attempt for ReleaseToOSIntervalMs,</i></td></tr>
<tr><th id="708">708</th><td><i>        // preventing just allocated memory from being released sooner than</i></td></tr>
<tr><th id="709">709</th><td><i>        // necessary and also preventing extraneous ReleaseMemoryPagesToOS calls</i></td></tr>
<tr><th id="710">710</th><td><i>        // for short lived processes.</i></td></tr>
<tr><th id="711">711</th><td><i>        // Do it only when the feature is turned on, to avoid a potentially</i></td></tr>
<tr><th id="712">712</th><td><i>        // extraneous syscall.</i></td></tr>
<tr><th id="713">713</th><td>        <b>if</b> (<a class="member fn" href="#__sanitizer::SizeClassAllocator64::ReleaseToOSIntervalMs" title='__sanitizer::SizeClassAllocator64::ReleaseToOSIntervalMs' data-ref="__sanitizer::SizeClassAllocator64::ReleaseToOSIntervalMs" data-ref-filename="__sanitizer..SizeClassAllocator64..ReleaseToOSIntervalMs">ReleaseToOSIntervalMs</a>() &gt;= <var>0</var>)</td></tr>
<tr><th id="714">714</th><td>          <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;rtoi.last_release_at_ns = <a class="ref fn" href="sanitizer_common.h.html#__sanitizer::MonotonicNanoTime" title='__sanitizer::MonotonicNanoTime' data-ref="__sanitizer::MonotonicNanoTime" data-ref-filename="__sanitizer..MonotonicNanoTime">MonotonicNanoTime</a>();</td></tr>
<tr><th id="715">715</th><td>      }</td></tr>
<tr><th id="716">716</th><td>      <i>// Do the mmap for the user memory.</i></td></tr>
<tr><th id="717">717</th><td>      <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col6 decl" id="1166user_map_size" title='user_map_size' data-type='const __sanitizer::uptr' data-ref="1166user_map_size" data-ref-filename="1166user_map_size">user_map_size</dfn> =</td></tr>
<tr><th id="718">718</th><td>          RoundUpTo(<a class="local col5 ref" href="#1165total_user_bytes" title='total_user_bytes' data-ref="1165total_user_bytes" data-ref-filename="1165total_user_bytes">total_user_bytes</a> - <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;mapped_user, <a class="member" href="#__sanitizer::SizeClassAllocator64::kUserMapSize" title='__sanitizer::SizeClassAllocator64::kUserMapSize' data-ref="__sanitizer::SizeClassAllocator64::kUserMapSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kUserMapSize">kUserMapSize</a>);</td></tr>
<tr><th id="719">719</th><td>      <b>if</b> (<a class="macro" href="sanitizer_internal_defs.h.html#229" title="__builtin_expect(!!(IsRegionExhausted(region, class_id, user_map_size)), 0)" data-ref="_M/UNLIKELY">UNLIKELY</a>(<a class="member fn" href="#__sanitizer::SizeClassAllocator64::IsRegionExhausted" title='__sanitizer::SizeClassAllocator64::IsRegionExhausted' data-ref="__sanitizer::SizeClassAllocator64::IsRegionExhausted" data-ref-filename="__sanitizer..SizeClassAllocator64..IsRegionExhausted">IsRegionExhausted</a>(<a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>, <a class="local col0 ref" href="#1160class_id" title='class_id' data-ref="1160class_id" data-ref-filename="1160class_id">class_id</a>, <a class="local col6 ref" href="#1166user_map_size" title='user_map_size' data-ref="1166user_map_size" data-ref-filename="1166user_map_size">user_map_size</a>)))</td></tr>
<tr><th id="720">720</th><td>        <b>return</b> <b>false</b>;</td></tr>
<tr><th id="721">721</th><td>      <b>if</b> (<a class="macro" href="sanitizer_internal_defs.h.html#229" title="__builtin_expect(!!(!MapWithCallback(region_beg + region-&gt;mapped_user, user_map_size, &quot;SizeClassAllocator: region data&quot;)), 0)" data-ref="_M/UNLIKELY">UNLIKELY</a>(!<a class="member fn" href="#__sanitizer::SizeClassAllocator64::MapWithCallback" title='__sanitizer::SizeClassAllocator64::MapWithCallback' data-ref="__sanitizer::SizeClassAllocator64::MapWithCallback" data-ref-filename="__sanitizer..SizeClassAllocator64..MapWithCallback">MapWithCallback</a>(<a class="local col3 ref" href="#1163region_beg" title='region_beg' data-ref="1163region_beg" data-ref-filename="1163region_beg">region_beg</a> + <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;mapped_user,</td></tr>
<tr><th id="722">722</th><td>                                    <a class="local col6 ref" href="#1166user_map_size" title='user_map_size' data-ref="1166user_map_size" data-ref-filename="1166user_map_size">user_map_size</a>,</td></tr>
<tr><th id="723">723</th><td>                                    <q>"SizeClassAllocator: region data"</q>)))</td></tr>
<tr><th id="724">724</th><td>        <b>return</b> <b>false</b>;</td></tr>
<tr><th id="725">725</th><td>      <a class="local col9 ref" href="#1159stat" title='stat' data-ref="1159stat" data-ref-filename="1159stat">stat</a>-&gt;<a class="ref fn" href="sanitizer_allocator_stats.h.html#__sanitizer::AllocatorStats::Add" title='__sanitizer::AllocatorStats::Add' data-ref="__sanitizer::AllocatorStats::Add" data-ref-filename="__sanitizer..AllocatorStats..Add">Add</a>(<a class="enum" href="sanitizer_allocator_stats.h.html#__sanitizer::AllocatorStatMapped" title='__sanitizer::AllocatorStatMapped' data-ref="__sanitizer::AllocatorStatMapped" data-ref-filename="__sanitizer..AllocatorStatMapped">AllocatorStatMapped</a>, <a class="local col6 ref" href="#1166user_map_size" title='user_map_size' data-ref="1166user_map_size" data-ref-filename="1166user_map_size">user_map_size</a>);</td></tr>
<tr><th id="726">726</th><td>      <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;mapped_user += <a class="local col6 ref" href="#1166user_map_size" title='user_map_size' data-ref="1166user_map_size" data-ref-filename="1166user_map_size">user_map_size</a>;</td></tr>
<tr><th id="727">727</th><td>    }</td></tr>
<tr><th id="728">728</th><td>    <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col7 decl" id="1167new_chunks_count" title='new_chunks_count' data-type='const __sanitizer::uptr' data-ref="1167new_chunks_count" data-ref-filename="1167new_chunks_count">new_chunks_count</dfn> =</td></tr>
<tr><th id="729">729</th><td>        (<a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;mapped_user - <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;allocated_user) / <a class="local col4 ref" href="#1164size" title='size' data-ref="1164size" data-ref-filename="1164size">size</a>;</td></tr>
<tr><th id="730">730</th><td></td></tr>
<tr><th id="731">731</th><td>    <b>if</b> (<a class="member" href="#__sanitizer::SizeClassAllocator64::kMetadataSize" title='__sanitizer::SizeClassAllocator64::kMetadataSize' data-ref="__sanitizer::SizeClassAllocator64::kMetadataSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kMetadataSize">kMetadataSize</a>) {</td></tr>
<tr><th id="732">732</th><td>      <i>// Calculate the required space for metadata.</i></td></tr>
<tr><th id="733">733</th><td>      <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col8 decl" id="1168total_meta_bytes" title='total_meta_bytes' data-type='const __sanitizer::uptr' data-ref="1168total_meta_bytes" data-ref-filename="1168total_meta_bytes">total_meta_bytes</dfn> =</td></tr>
<tr><th id="734">734</th><td>          <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;allocated_meta + <a class="local col7 ref" href="#1167new_chunks_count" title='new_chunks_count' data-ref="1167new_chunks_count" data-ref-filename="1167new_chunks_count">new_chunks_count</a> * <a class="member" href="#__sanitizer::SizeClassAllocator64::kMetadataSize" title='__sanitizer::SizeClassAllocator64::kMetadataSize' data-ref="__sanitizer::SizeClassAllocator64::kMetadataSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kMetadataSize">kMetadataSize</a>;</td></tr>
<tr><th id="735">735</th><td>      <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col9 decl" id="1169meta_map_size" title='meta_map_size' data-type='const __sanitizer::uptr' data-ref="1169meta_map_size" data-ref-filename="1169meta_map_size">meta_map_size</dfn> = (<a class="local col8 ref" href="#1168total_meta_bytes" title='total_meta_bytes' data-ref="1168total_meta_bytes" data-ref-filename="1168total_meta_bytes">total_meta_bytes</a> &gt; <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;mapped_meta) ?</td></tr>
<tr><th id="736">736</th><td>          RoundUpTo(<a class="local col8 ref" href="#1168total_meta_bytes" title='total_meta_bytes' data-ref="1168total_meta_bytes" data-ref-filename="1168total_meta_bytes">total_meta_bytes</a> - <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;mapped_meta, <a class="member" href="#__sanitizer::SizeClassAllocator64::kMetaMapSize" title='__sanitizer::SizeClassAllocator64::kMetaMapSize' data-ref="__sanitizer::SizeClassAllocator64::kMetaMapSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kMetaMapSize">kMetaMapSize</a>) : <var>0</var>;</td></tr>
<tr><th id="737">737</th><td>      <i>// Map more space for metadata, if necessary.</i></td></tr>
<tr><th id="738">738</th><td>      <b>if</b> (<a class="local col9 ref" href="#1169meta_map_size" title='meta_map_size' data-ref="1169meta_map_size" data-ref-filename="1169meta_map_size">meta_map_size</a>) {</td></tr>
<tr><th id="739">739</th><td>        <b>if</b> (<a class="macro" href="sanitizer_internal_defs.h.html#229" title="__builtin_expect(!!(IsRegionExhausted(region, class_id, meta_map_size)), 0)" data-ref="_M/UNLIKELY">UNLIKELY</a>(<a class="member fn" href="#__sanitizer::SizeClassAllocator64::IsRegionExhausted" title='__sanitizer::SizeClassAllocator64::IsRegionExhausted' data-ref="__sanitizer::SizeClassAllocator64::IsRegionExhausted" data-ref-filename="__sanitizer..SizeClassAllocator64..IsRegionExhausted">IsRegionExhausted</a>(<a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>, <a class="local col0 ref" href="#1160class_id" title='class_id' data-ref="1160class_id" data-ref-filename="1160class_id">class_id</a>, <a class="local col9 ref" href="#1169meta_map_size" title='meta_map_size' data-ref="1169meta_map_size" data-ref-filename="1169meta_map_size">meta_map_size</a>)))</td></tr>
<tr><th id="740">740</th><td>          <b>return</b> <b>false</b>;</td></tr>
<tr><th id="741">741</th><td>        <b>if</b> (<a class="macro" href="sanitizer_internal_defs.h.html#229" title="__builtin_expect(!!(!MapWithCallback( GetMetadataEnd(region_beg) - region-&gt;mapped_meta - meta_map_size, meta_map_size, &quot;SizeClassAllocator: region metadata&quot;)), 0)" data-ref="_M/UNLIKELY">UNLIKELY</a>(!<a class="member fn" href="#__sanitizer::SizeClassAllocator64::MapWithCallback" title='__sanitizer::SizeClassAllocator64::MapWithCallback' data-ref="__sanitizer::SizeClassAllocator64::MapWithCallback" data-ref-filename="__sanitizer..SizeClassAllocator64..MapWithCallback">MapWithCallback</a>(</td></tr>
<tr><th id="742">742</th><td>            <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetMetadataEnd" title='__sanitizer::SizeClassAllocator64::GetMetadataEnd' data-ref="__sanitizer::SizeClassAllocator64::GetMetadataEnd" data-ref-filename="__sanitizer..SizeClassAllocator64..GetMetadataEnd">GetMetadataEnd</a>(<a class="local col3 ref" href="#1163region_beg" title='region_beg' data-ref="1163region_beg" data-ref-filename="1163region_beg">region_beg</a>) - <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;mapped_meta - <a class="local col9 ref" href="#1169meta_map_size" title='meta_map_size' data-ref="1169meta_map_size" data-ref-filename="1169meta_map_size">meta_map_size</a>,</td></tr>
<tr><th id="743">743</th><td>            <a class="local col9 ref" href="#1169meta_map_size" title='meta_map_size' data-ref="1169meta_map_size" data-ref-filename="1169meta_map_size">meta_map_size</a>, <q>"SizeClassAllocator: region metadata"</q>)))</td></tr>
<tr><th id="744">744</th><td>          <b>return</b> <b>false</b>;</td></tr>
<tr><th id="745">745</th><td>        <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;mapped_meta += <a class="local col9 ref" href="#1169meta_map_size" title='meta_map_size' data-ref="1169meta_map_size" data-ref-filename="1169meta_map_size">meta_map_size</a>;</td></tr>
<tr><th id="746">746</th><td>      }</td></tr>
<tr><th id="747">747</th><td>    }</td></tr>
<tr><th id="748">748</th><td></td></tr>
<tr><th id="749">749</th><td>    <i>// If necessary, allocate more space for the free array and populate it with</i></td></tr>
<tr><th id="750">750</th><td><i>    // newly allocated chunks.</i></td></tr>
<tr><th id="751">751</th><td>    <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col0 decl" id="1170total_freed_chunks" title='total_freed_chunks' data-type='const __sanitizer::uptr' data-ref="1170total_freed_chunks" data-ref-filename="1170total_freed_chunks">total_freed_chunks</dfn> = <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;num_freed_chunks + <a class="local col7 ref" href="#1167new_chunks_count" title='new_chunks_count' data-ref="1167new_chunks_count" data-ref-filename="1167new_chunks_count">new_chunks_count</a>;</td></tr>
<tr><th id="752">752</th><td>    <b>if</b> (<a class="macro" href="sanitizer_internal_defs.h.html#229" title="__builtin_expect(!!(!EnsureFreeArraySpace(region, region_beg, total_freed_chunks)), 0)" data-ref="_M/UNLIKELY">UNLIKELY</a>(!<a class="member fn" href="#__sanitizer::SizeClassAllocator64::EnsureFreeArraySpace" title='__sanitizer::SizeClassAllocator64::EnsureFreeArraySpace' data-ref="__sanitizer::SizeClassAllocator64::EnsureFreeArraySpace" data-ref-filename="__sanitizer..SizeClassAllocator64..EnsureFreeArraySpace">EnsureFreeArraySpace</a>(<a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>, <a class="local col3 ref" href="#1163region_beg" title='region_beg' data-ref="1163region_beg" data-ref-filename="1163region_beg">region_beg</a>, <a class="local col0 ref" href="#1170total_freed_chunks" title='total_freed_chunks' data-ref="1170total_freed_chunks" data-ref-filename="1170total_freed_chunks">total_freed_chunks</a>)))</td></tr>
<tr><th id="753">753</th><td>      <b>return</b> <b>false</b>;</td></tr>
<tr><th id="754">754</th><td>    <a class="typedef" href="#__sanitizer::SizeClassAllocator64::CompactPtrT" title='__sanitizer::SizeClassAllocator64::CompactPtrT' data-type='__sanitizer::u32' data-ref="__sanitizer::SizeClassAllocator64::CompactPtrT" data-ref-filename="__sanitizer..SizeClassAllocator64..CompactPtrT">CompactPtrT</a> *<dfn class="local col1 decl" id="1171free_array" title='free_array' data-type='__sanitizer::SizeClassAllocator64::CompactPtrT *' data-ref="1171free_array" data-ref-filename="1171free_array">free_array</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetFreeArray" title='__sanitizer::SizeClassAllocator64::GetFreeArray' data-ref="__sanitizer::SizeClassAllocator64::GetFreeArray" data-ref-filename="__sanitizer..SizeClassAllocator64..GetFreeArray">GetFreeArray</a>(<a class="local col3 ref" href="#1163region_beg" title='region_beg' data-ref="1163region_beg" data-ref-filename="1163region_beg">region_beg</a>);</td></tr>
<tr><th id="755">755</th><td>    <b>for</b> (<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col2 decl" id="1172i" title='i' data-type='__sanitizer::uptr' data-ref="1172i" data-ref-filename="1172i">i</dfn> = <var>0</var>, <dfn class="local col3 decl" id="1173chunk" title='chunk' data-type='__sanitizer::uptr' data-ref="1173chunk" data-ref-filename="1173chunk">chunk</dfn> = <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;allocated_user; <a class="local col2 ref" href="#1172i" title='i' data-ref="1172i" data-ref-filename="1172i">i</a> &lt; <a class="local col7 ref" href="#1167new_chunks_count" title='new_chunks_count' data-ref="1167new_chunks_count" data-ref-filename="1167new_chunks_count">new_chunks_count</a>;</td></tr>
<tr><th id="756">756</th><td>         <a class="local col2 ref" href="#1172i" title='i' data-ref="1172i" data-ref-filename="1172i">i</a>++, <a class="local col3 ref" href="#1173chunk" title='chunk' data-ref="1173chunk" data-ref-filename="1173chunk">chunk</a> += <a class="local col4 ref" href="#1164size" title='size' data-ref="1164size" data-ref-filename="1164size">size</a>)</td></tr>
<tr><th id="757">757</th><td>      <a class="local col1 ref" href="#1171free_array" title='free_array' data-ref="1171free_array" data-ref-filename="1171free_array">free_array</a>[<a class="local col0 ref" href="#1170total_freed_chunks" title='total_freed_chunks' data-ref="1170total_freed_chunks" data-ref-filename="1170total_freed_chunks">total_freed_chunks</a> - <var>1</var> - <a class="local col2 ref" href="#1172i" title='i' data-ref="1172i" data-ref-filename="1172i">i</a>] = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::PointerToCompactPtr" title='__sanitizer::SizeClassAllocator64::PointerToCompactPtr' data-ref="__sanitizer::SizeClassAllocator64::PointerToCompactPtr" data-ref-filename="__sanitizer..SizeClassAllocator64..PointerToCompactPtr">PointerToCompactPtr</a>(<var>0</var>, <a class="local col3 ref" href="#1173chunk" title='chunk' data-ref="1173chunk" data-ref-filename="1173chunk">chunk</a>);</td></tr>
<tr><th id="758">758</th><td>    <b>if</b> (<a class="member" href="#__sanitizer::SizeClassAllocator64::kRandomShuffleChunks" title='__sanitizer::SizeClassAllocator64::kRandomShuffleChunks' data-ref="__sanitizer::SizeClassAllocator64::kRandomShuffleChunks" data-ref-filename="__sanitizer..SizeClassAllocator64..kRandomShuffleChunks">kRandomShuffleChunks</a>)</td></tr>
<tr><th id="759">759</th><td>      RandomShuffle(&amp;<a class="local col1 ref" href="#1171free_array" title='free_array' data-ref="1171free_array" data-ref-filename="1171free_array">free_array</a>[<a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;num_freed_chunks], <a class="local col7 ref" href="#1167new_chunks_count" title='new_chunks_count' data-ref="1167new_chunks_count" data-ref-filename="1167new_chunks_count">new_chunks_count</a>,</td></tr>
<tr><th id="760">760</th><td>                    &amp;<a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;rand_state);</td></tr>
<tr><th id="761">761</th><td></td></tr>
<tr><th id="762">762</th><td>    <i>// All necessary memory is mapped and now it is safe to advance all</i></td></tr>
<tr><th id="763">763</th><td><i>    // 'allocated_*' counters.</i></td></tr>
<tr><th id="764">764</th><td>    <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;num_freed_chunks += <a class="local col7 ref" href="#1167new_chunks_count" title='new_chunks_count' data-ref="1167new_chunks_count" data-ref-filename="1167new_chunks_count">new_chunks_count</a>;</td></tr>
<tr><th id="765">765</th><td>    <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;allocated_user += <a class="local col7 ref" href="#1167new_chunks_count" title='new_chunks_count' data-ref="1167new_chunks_count" data-ref-filename="1167new_chunks_count">new_chunks_count</a> * <a class="local col4 ref" href="#1164size" title='size' data-ref="1164size" data-ref-filename="1164size">size</a>;</td></tr>
<tr><th id="766">766</th><td>    <a class="macro" href="sanitizer_internal_defs.h.html#303" title="do { __sanitizer::u64 v1 = (__sanitizer::u64)((region-&gt;allocated_user)); __sanitizer::u64 v2 = (__sanitizer::u64)((region-&gt;mapped_user)); if (__builtin_expect(!!(!(v1 &lt;= v2)), 0)) __sanitizer::CheckFailed(&quot;/fast/tmp/llvm-proj-12/compiler-rt/lib/asan/../sanitizer_common/sanitizer_allocator_primary64.h&quot;, 766, &quot;(&quot; &quot;(region-&gt;allocated_user)&quot; &quot;) &quot; &quot;&lt;=&quot; &quot; (&quot; &quot;(region-&gt;mapped_user)&quot; &quot;)&quot;, v1, v2); } while (false)" data-ref="_M/CHECK_LE">CHECK_LE</a>(<a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;allocated_user, <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;mapped_user);</td></tr>
<tr><th id="767">767</th><td>    <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;allocated_meta += <a class="local col7 ref" href="#1167new_chunks_count" title='new_chunks_count' data-ref="1167new_chunks_count" data-ref-filename="1167new_chunks_count">new_chunks_count</a> * <a class="member" href="#__sanitizer::SizeClassAllocator64::kMetadataSize" title='__sanitizer::SizeClassAllocator64::kMetadataSize' data-ref="__sanitizer::SizeClassAllocator64::kMetadataSize" data-ref-filename="__sanitizer..SizeClassAllocator64..kMetadataSize">kMetadataSize</a>;</td></tr>
<tr><th id="768">768</th><td>    <a class="macro" href="sanitizer_internal_defs.h.html#303" title="do { __sanitizer::u64 v1 = (__sanitizer::u64)((region-&gt;allocated_meta)); __sanitizer::u64 v2 = (__sanitizer::u64)((region-&gt;mapped_meta)); if (__builtin_expect(!!(!(v1 &lt;= v2)), 0)) __sanitizer::CheckFailed(&quot;/fast/tmp/llvm-proj-12/compiler-rt/lib/asan/../sanitizer_common/sanitizer_allocator_primary64.h&quot;, 768, &quot;(&quot; &quot;(region-&gt;allocated_meta)&quot; &quot;) &quot; &quot;&lt;=&quot; &quot; (&quot; &quot;(region-&gt;mapped_meta)&quot; &quot;)&quot;, v1, v2); } while (false)" data-ref="_M/CHECK_LE">CHECK_LE</a>(<a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;allocated_meta, <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;mapped_meta);</td></tr>
<tr><th id="769">769</th><td>    <a class="local col1 ref" href="#1161region" title='region' data-ref="1161region" data-ref-filename="1161region">region</a>-&gt;exhausted = <b>false</b>;</td></tr>
<tr><th id="770">770</th><td></td></tr>
<tr><th id="771">771</th><td>    <i>// TODO(alekseyshl): Consider bumping last_release_at_ns here to prevent</i></td></tr>
<tr><th id="772">772</th><td><i>    // MaybeReleaseToOS from releasing just allocated pages or protect these</i></td></tr>
<tr><th id="773">773</th><td><i>    // not yet used chunks some other way.</i></td></tr>
<tr><th id="774">774</th><td></td></tr>
<tr><th id="775">775</th><td>    <b>return</b> <b>true</b>;</td></tr>
<tr><th id="776">776</th><td>  }</td></tr>
<tr><th id="777">777</th><td></td></tr>
<tr><th id="778">778</th><td>  <b>class</b> <dfn class="type def" id="__sanitizer::SizeClassAllocator64::MemoryMapper" title='__sanitizer::SizeClassAllocator64::MemoryMapper' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper">MemoryMapper</dfn> {</td></tr>
<tr><th id="779">779</th><td>   <b>public</b>:</td></tr>
<tr><th id="780">780</th><td>    <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::MemoryMapper::MemoryMapper" title='__sanitizer::SizeClassAllocator64::MemoryMapper::MemoryMapper' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::MemoryMapper" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..MemoryMapper">MemoryMapper</dfn>(<em>const</em> <a class="typedef" href="#__sanitizer::SizeClassAllocator64::ThisT" title='__sanitizer::SizeClassAllocator64::ThisT' data-type='SizeClassAllocator64&lt;Params&gt;' data-ref="__sanitizer::SizeClassAllocator64::ThisT" data-ref-filename="__sanitizer..SizeClassAllocator64..ThisT">ThisT</a>&amp; <dfn class="local col4 decl" id="1174base_allocator" title='base_allocator' data-type='const __sanitizer::SizeClassAllocator64::ThisT &amp;' data-ref="1174base_allocator" data-ref-filename="1174base_allocator">base_allocator</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col5 decl" id="1175class_id" title='class_id' data-type='__sanitizer::uptr' data-ref="1175class_id" data-ref-filename="1175class_id">class_id</dfn>)</td></tr>
<tr><th id="781">781</th><td>        : <a class="member field" href="#__sanitizer::SizeClassAllocator64::MemoryMapper::allocator" title='__sanitizer::SizeClassAllocator64::MemoryMapper::allocator' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::allocator" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..allocator">allocator</a>(<a class="local col4 ref" href="#1174base_allocator" title='base_allocator' data-ref="1174base_allocator" data-ref-filename="1174base_allocator">base_allocator</a>),</td></tr>
<tr><th id="782">782</th><td>          <a class="member field" href="#__sanitizer::SizeClassAllocator64::MemoryMapper::region_base" title='__sanitizer::SizeClassAllocator64::MemoryMapper::region_base' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::region_base" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..region_base">region_base</a>(<a class="local col4 ref" href="#1174base_allocator" title='base_allocator' data-ref="1174base_allocator" data-ref-filename="1174base_allocator">base_allocator</a>.GetRegionBeginBySizeClass(<a class="local col5 ref" href="#1175class_id" title='class_id' data-ref="1175class_id" data-ref-filename="1175class_id">class_id</a>)),</td></tr>
<tr><th id="783">783</th><td>          <a class="member field" href="#__sanitizer::SizeClassAllocator64::MemoryMapper::released_ranges_count" title='__sanitizer::SizeClassAllocator64::MemoryMapper::released_ranges_count' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::released_ranges_count" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..released_ranges_count">released_ranges_count</a>(<var>0</var>),</td></tr>
<tr><th id="784">784</th><td>          <a class="member field" href="#__sanitizer::SizeClassAllocator64::MemoryMapper::released_bytes" title='__sanitizer::SizeClassAllocator64::MemoryMapper::released_bytes' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::released_bytes" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..released_bytes">released_bytes</a>(<var>0</var>) {</td></tr>
<tr><th id="785">785</th><td>    }</td></tr>
<tr><th id="786">786</th><td></td></tr>
<tr><th id="787">787</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::MemoryMapper::GetReleasedRangesCount" title='__sanitizer::SizeClassAllocator64::MemoryMapper::GetReleasedRangesCount' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::GetReleasedRangesCount" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..GetReleasedRangesCount">GetReleasedRangesCount</dfn>() <em>const</em> {</td></tr>
<tr><th id="788">788</th><td>      <b>return</b> <a class="member field" href="#__sanitizer::SizeClassAllocator64::MemoryMapper::released_ranges_count" title='__sanitizer::SizeClassAllocator64::MemoryMapper::released_ranges_count' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::released_ranges_count" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..released_ranges_count">released_ranges_count</a>;</td></tr>
<tr><th id="789">789</th><td>    }</td></tr>
<tr><th id="790">790</th><td></td></tr>
<tr><th id="791">791</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::MemoryMapper::GetReleasedBytes" title='__sanitizer::SizeClassAllocator64::MemoryMapper::GetReleasedBytes' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::GetReleasedBytes" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..GetReleasedBytes">GetReleasedBytes</dfn>() <em>const</em> {</td></tr>
<tr><th id="792">792</th><td>      <b>return</b> <a class="member field" href="#__sanitizer::SizeClassAllocator64::MemoryMapper::released_bytes" title='__sanitizer::SizeClassAllocator64::MemoryMapper::released_bytes' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::released_bytes" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..released_bytes">released_bytes</a>;</td></tr>
<tr><th id="793">793</th><td>    }</td></tr>
<tr><th id="794">794</th><td></td></tr>
<tr><th id="795">795</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::MemoryMapper::MapPackedCounterArrayBuffer" title='__sanitizer::SizeClassAllocator64::MemoryMapper::MapPackedCounterArrayBuffer' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::MapPackedCounterArrayBuffer" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..MapPackedCounterArrayBuffer">MapPackedCounterArrayBuffer</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col6 decl" id="1176buffer_size" title='buffer_size' data-type='__sanitizer::uptr' data-ref="1176buffer_size" data-ref-filename="1176buffer_size">buffer_size</dfn>) {</td></tr>
<tr><th id="796">796</th><td>      <i>// TODO(alekseyshl): The idea to explore is to check if we have enough</i></td></tr>
<tr><th id="797">797</th><td><i>      // space between num_freed_chunks*sizeof(CompactPtrT) and</i></td></tr>
<tr><th id="798">798</th><td><i>      // mapped_free_array to fit buffer_size bytes and use that space instead</i></td></tr>
<tr><th id="799">799</th><td><i>      // of mapping a temporary one.</i></td></tr>
<tr><th id="800">800</th><td>      <b>return</b> <b>reinterpret_cast</b>&lt;<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a>&gt;(</td></tr>
<tr><th id="801">801</th><td>          <a class="ref fn" href="sanitizer_common.h.html#__sanitizer::MmapOrDieOnFatalError" title='__sanitizer::MmapOrDieOnFatalError' data-ref="__sanitizer::MmapOrDieOnFatalError" data-ref-filename="__sanitizer..MmapOrDieOnFatalError">MmapOrDieOnFatalError</a>(<a class="local col6 ref" href="#1176buffer_size" title='buffer_size' data-ref="1176buffer_size" data-ref-filename="1176buffer_size">buffer_size</a>, <q>"ReleaseToOSPageCounters"</q>));</td></tr>
<tr><th id="802">802</th><td>    }</td></tr>
<tr><th id="803">803</th><td></td></tr>
<tr><th id="804">804</th><td>    <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::MemoryMapper::UnmapPackedCounterArrayBuffer" title='__sanitizer::SizeClassAllocator64::MemoryMapper::UnmapPackedCounterArrayBuffer' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::UnmapPackedCounterArrayBuffer" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..UnmapPackedCounterArrayBuffer">UnmapPackedCounterArrayBuffer</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col7 decl" id="1177buffer" title='buffer' data-type='__sanitizer::uptr' data-ref="1177buffer" data-ref-filename="1177buffer">buffer</dfn>, <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col8 decl" id="1178buffer_size" title='buffer_size' data-type='__sanitizer::uptr' data-ref="1178buffer_size" data-ref-filename="1178buffer_size">buffer_size</dfn>) {</td></tr>
<tr><th id="805">805</th><td>      <a class="ref fn" href="sanitizer_common.h.html#__sanitizer::UnmapOrDie" title='__sanitizer::UnmapOrDie' data-ref="__sanitizer::UnmapOrDie" data-ref-filename="__sanitizer..UnmapOrDie">UnmapOrDie</a>(<b>reinterpret_cast</b>&lt;<em>void</em> *&gt;(<a class="local col7 ref" href="#1177buffer" title='buffer' data-ref="1177buffer" data-ref-filename="1177buffer">buffer</a>), <a class="local col8 ref" href="#1178buffer_size" title='buffer_size' data-ref="1178buffer_size" data-ref-filename="1178buffer_size">buffer_size</a>);</td></tr>
<tr><th id="806">806</th><td>    }</td></tr>
<tr><th id="807">807</th><td></td></tr>
<tr><th id="808">808</th><td>    <i>// Releases [from, to) range of pages back to OS.</i></td></tr>
<tr><th id="809">809</th><td>    <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::MemoryMapper::ReleasePageRangeToOS" title='__sanitizer::SizeClassAllocator64::MemoryMapper::ReleasePageRangeToOS' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::ReleasePageRangeToOS" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..ReleasePageRangeToOS">ReleasePageRangeToOS</dfn>(<a class="typedef" href="#__sanitizer::SizeClassAllocator64::CompactPtrT" title='__sanitizer::SizeClassAllocator64::CompactPtrT' data-type='__sanitizer::u32' data-ref="__sanitizer::SizeClassAllocator64::CompactPtrT" data-ref-filename="__sanitizer..SizeClassAllocator64..CompactPtrT">CompactPtrT</a> <dfn class="local col9 decl" id="1179from" title='from' data-type='__sanitizer::SizeClassAllocator64::CompactPtrT' data-ref="1179from" data-ref-filename="1179from">from</dfn>, <a class="typedef" href="#__sanitizer::SizeClassAllocator64::CompactPtrT" title='__sanitizer::SizeClassAllocator64::CompactPtrT' data-type='__sanitizer::u32' data-ref="__sanitizer::SizeClassAllocator64::CompactPtrT" data-ref-filename="__sanitizer..SizeClassAllocator64..CompactPtrT">CompactPtrT</a> <dfn class="local col0 decl" id="1180to" title='to' data-type='__sanitizer::SizeClassAllocator64::CompactPtrT' data-ref="1180to" data-ref-filename="1180to">to</dfn>) {</td></tr>
<tr><th id="810">810</th><td>      <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col1 decl" id="1181from_page" title='from_page' data-type='const __sanitizer::uptr' data-ref="1181from_page" data-ref-filename="1181from_page">from_page</dfn> = <a class="member field" href="#__sanitizer::SizeClassAllocator64::MemoryMapper::allocator" title='__sanitizer::SizeClassAllocator64::MemoryMapper::allocator' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::allocator" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..allocator">allocator</a>.CompactPtrToPointer(<a class="member field" href="#__sanitizer::SizeClassAllocator64::MemoryMapper::region_base" title='__sanitizer::SizeClassAllocator64::MemoryMapper::region_base' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::region_base" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..region_base">region_base</a>, <a class="local col9 ref" href="#1179from" title='from' data-ref="1179from" data-ref-filename="1179from">from</a>);</td></tr>
<tr><th id="811">811</th><td>      <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col2 decl" id="1182to_page" title='to_page' data-type='const __sanitizer::uptr' data-ref="1182to_page" data-ref-filename="1182to_page">to_page</dfn> = <a class="member field" href="#__sanitizer::SizeClassAllocator64::MemoryMapper::allocator" title='__sanitizer::SizeClassAllocator64::MemoryMapper::allocator' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::allocator" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..allocator">allocator</a>.CompactPtrToPointer(<a class="member field" href="#__sanitizer::SizeClassAllocator64::MemoryMapper::region_base" title='__sanitizer::SizeClassAllocator64::MemoryMapper::region_base' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::region_base" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..region_base">region_base</a>, <a class="local col0 ref" href="#1180to" title='to' data-ref="1180to" data-ref-filename="1180to">to</a>);</td></tr>
<tr><th id="812">812</th><td>      <a class="ref fn" href="sanitizer_common.h.html#__sanitizer::ReleaseMemoryPagesToOS" title='__sanitizer::ReleaseMemoryPagesToOS' data-ref="__sanitizer::ReleaseMemoryPagesToOS" data-ref-filename="__sanitizer..ReleaseMemoryPagesToOS">ReleaseMemoryPagesToOS</a>(<a class="local col1 ref" href="#1181from_page" title='from_page' data-ref="1181from_page" data-ref-filename="1181from_page">from_page</a>, <a class="local col2 ref" href="#1182to_page" title='to_page' data-ref="1182to_page" data-ref-filename="1182to_page">to_page</a>);</td></tr>
<tr><th id="813">813</th><td>      <a class="member field" href="#__sanitizer::SizeClassAllocator64::MemoryMapper::released_ranges_count" title='__sanitizer::SizeClassAllocator64::MemoryMapper::released_ranges_count' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::released_ranges_count" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..released_ranges_count">released_ranges_count</a>++;</td></tr>
<tr><th id="814">814</th><td>      <a class="member field" href="#__sanitizer::SizeClassAllocator64::MemoryMapper::released_bytes" title='__sanitizer::SizeClassAllocator64::MemoryMapper::released_bytes' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::released_bytes" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..released_bytes">released_bytes</a> += <a class="local col2 ref" href="#1182to_page" title='to_page' data-ref="1182to_page" data-ref-filename="1182to_page">to_page</a> - <a class="local col1 ref" href="#1181from_page" title='from_page' data-ref="1181from_page" data-ref-filename="1181from_page">from_page</a>;</td></tr>
<tr><th id="815">815</th><td>    }</td></tr>
<tr><th id="816">816</th><td></td></tr>
<tr><th id="817">817</th><td>   <b>private</b>:</td></tr>
<tr><th id="818">818</th><td>    <em>const</em> <a class="typedef" href="#__sanitizer::SizeClassAllocator64::ThisT" title='__sanitizer::SizeClassAllocator64::ThisT' data-type='SizeClassAllocator64&lt;Params&gt;' data-ref="__sanitizer::SizeClassAllocator64::ThisT" data-ref-filename="__sanitizer..SizeClassAllocator64..ThisT">ThisT</a>&amp; <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::MemoryMapper::allocator" title='__sanitizer::SizeClassAllocator64::MemoryMapper::allocator' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::allocator" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..allocator">allocator</dfn>;</td></tr>
<tr><th id="819">819</th><td>    <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::MemoryMapper::region_base" title='__sanitizer::SizeClassAllocator64::MemoryMapper::region_base' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::region_base" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..region_base">region_base</dfn>;</td></tr>
<tr><th id="820">820</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::MemoryMapper::released_ranges_count" title='__sanitizer::SizeClassAllocator64::MemoryMapper::released_ranges_count' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::released_ranges_count" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..released_ranges_count">released_ranges_count</dfn>;</td></tr>
<tr><th id="821">821</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="decl field" id="__sanitizer::SizeClassAllocator64::MemoryMapper::released_bytes" title='__sanitizer::SizeClassAllocator64::MemoryMapper::released_bytes' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper::released_bytes" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper..released_bytes">released_bytes</dfn>;</td></tr>
<tr><th id="822">822</th><td>  };</td></tr>
<tr><th id="823">823</th><td></td></tr>
<tr><th id="824">824</th><td>  <i>// Attempts to release RAM occupied by freed chunks back to OS. The region is</i></td></tr>
<tr><th id="825">825</th><td><i>  // expected to be locked.</i></td></tr>
<tr><th id="826">826</th><td>  <em>void</em> <dfn class="decl def fn" id="__sanitizer::SizeClassAllocator64::MaybeReleaseToOS" title='__sanitizer::SizeClassAllocator64::MaybeReleaseToOS' data-ref="__sanitizer::SizeClassAllocator64::MaybeReleaseToOS" data-ref-filename="__sanitizer..SizeClassAllocator64..MaybeReleaseToOS">MaybeReleaseToOS</dfn>(<a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col3 decl" id="1183class_id" title='class_id' data-type='__sanitizer::uptr' data-ref="1183class_id" data-ref-filename="1183class_id">class_id</dfn>, <em>bool</em> <dfn class="local col4 decl" id="1184force" title='force' data-type='bool' data-ref="1184force" data-ref-filename="1184force">force</dfn>) {</td></tr>
<tr><th id="827">827</th><td>    <a class="type" href="#__sanitizer::SizeClassAllocator64::RegionInfo" title='__sanitizer::SizeClassAllocator64::RegionInfo' data-ref="__sanitizer::SizeClassAllocator64::RegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..RegionInfo">RegionInfo</a> *<dfn class="local col5 decl" id="1185region" title='region' data-type='__sanitizer::SizeClassAllocator64::RegionInfo *' data-ref="1185region" data-ref-filename="1185region">region</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetRegionInfo" title='__sanitizer::SizeClassAllocator64::GetRegionInfo' data-ref="__sanitizer::SizeClassAllocator64::GetRegionInfo" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionInfo">GetRegionInfo</a>(<a class="local col3 ref" href="#1183class_id" title='class_id' data-ref="1183class_id" data-ref-filename="1183class_id">class_id</a>);</td></tr>
<tr><th id="828">828</th><td>    <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col6 decl" id="1186chunk_size" title='chunk_size' data-type='const __sanitizer::uptr' data-ref="1186chunk_size" data-ref-filename="1186chunk_size">chunk_size</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::ClassIdToSize" title='__sanitizer::SizeClassAllocator64::ClassIdToSize' data-ref="__sanitizer::SizeClassAllocator64::ClassIdToSize" data-ref-filename="__sanitizer..SizeClassAllocator64..ClassIdToSize">ClassIdToSize</a>(<a class="local col3 ref" href="#1183class_id" title='class_id' data-ref="1183class_id" data-ref-filename="1183class_id">class_id</a>);</td></tr>
<tr><th id="829">829</th><td>    <em>const</em> <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col7 decl" id="1187page_size" title='page_size' data-type='const __sanitizer::uptr' data-ref="1187page_size" data-ref-filename="1187page_size">page_size</dfn> = <a class="ref fn" href="sanitizer_common.h.html#__sanitizer::GetPageSizeCached" title='__sanitizer::GetPageSizeCached' data-ref="__sanitizer::GetPageSizeCached" data-ref-filename="__sanitizer..GetPageSizeCached">GetPageSizeCached</a>();</td></tr>
<tr><th id="830">830</th><td></td></tr>
<tr><th id="831">831</th><td>    <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::uptr" title='__sanitizer::uptr' data-type='unsigned long' data-ref="__sanitizer::uptr" data-ref-filename="__sanitizer..uptr">uptr</a> <dfn class="local col8 decl" id="1188n" title='n' data-type='__sanitizer::uptr' data-ref="1188n" data-ref-filename="1188n">n</dfn> = <a class="local col5 ref" href="#1185region" title='region' data-ref="1185region" data-ref-filename="1185region">region</a>-&gt;num_freed_chunks;</td></tr>
<tr><th id="832">832</th><td>    <b>if</b> (<a class="local col8 ref" href="#1188n" title='n' data-ref="1188n" data-ref-filename="1188n">n</a> * <a class="local col6 ref" href="#1186chunk_size" title='chunk_size' data-ref="1186chunk_size" data-ref-filename="1186chunk_size">chunk_size</a> &lt; <a class="local col7 ref" href="#1187page_size" title='page_size' data-ref="1187page_size" data-ref-filename="1187page_size">page_size</a>)</td></tr>
<tr><th id="833">833</th><td>      <b>return</b>;  <i>// No chance to release anything.</i></td></tr>
<tr><th id="834">834</th><td>    <b>if</b> ((<a class="local col5 ref" href="#1185region" title='region' data-ref="1185region" data-ref-filename="1185region">region</a>-&gt;stats.n_freed -</td></tr>
<tr><th id="835">835</th><td>         <a class="local col5 ref" href="#1185region" title='region' data-ref="1185region" data-ref-filename="1185region">region</a>-&gt;rtoi.n_freed_at_last_release) * <a class="local col6 ref" href="#1186chunk_size" title='chunk_size' data-ref="1186chunk_size" data-ref-filename="1186chunk_size">chunk_size</a> &lt; <a class="local col7 ref" href="#1187page_size" title='page_size' data-ref="1187page_size" data-ref-filename="1187page_size">page_size</a>) {</td></tr>
<tr><th id="836">836</th><td>      <b>return</b>;  <i>// Nothing new to release.</i></td></tr>
<tr><th id="837">837</th><td>    }</td></tr>
<tr><th id="838">838</th><td></td></tr>
<tr><th id="839">839</th><td>    <b>if</b> (!<a class="local col4 ref" href="#1184force" title='force' data-ref="1184force" data-ref-filename="1184force">force</a>) {</td></tr>
<tr><th id="840">840</th><td>      <a class="typedef" href="sanitizer_internal_defs.h.html#__sanitizer::s32" title='__sanitizer::s32' data-type='int' data-ref="__sanitizer::s32" data-ref-filename="__sanitizer..s32">s32</a> <dfn class="local col9 decl" id="1189interval_ms" title='interval_ms' data-type='__sanitizer::s32' data-ref="1189interval_ms" data-ref-filename="1189interval_ms">interval_ms</dfn> = <a class="member fn" href="#__sanitizer::SizeClassAllocator64::ReleaseToOSIntervalMs" title='__sanitizer::SizeClassAllocator64::ReleaseToOSIntervalMs' data-ref="__sanitizer::SizeClassAllocator64::ReleaseToOSIntervalMs" data-ref-filename="__sanitizer..SizeClassAllocator64..ReleaseToOSIntervalMs">ReleaseToOSIntervalMs</a>();</td></tr>
<tr><th id="841">841</th><td>      <b>if</b> (<a class="local col9 ref" href="#1189interval_ms" title='interval_ms' data-ref="1189interval_ms" data-ref-filename="1189interval_ms">interval_ms</a> &lt; <var>0</var>)</td></tr>
<tr><th id="842">842</th><td>        <b>return</b>;</td></tr>
<tr><th id="843">843</th><td></td></tr>
<tr><th id="844">844</th><td>      <b>if</b> (<a class="local col5 ref" href="#1185region" title='region' data-ref="1185region" data-ref-filename="1185region">region</a>-&gt;rtoi.last_release_at_ns + <a class="local col9 ref" href="#1189interval_ms" title='interval_ms' data-ref="1189interval_ms" data-ref-filename="1189interval_ms">interval_ms</a> * <var>1000000ULL</var> &gt;</td></tr>
<tr><th id="845">845</th><td>          <a class="ref fn" href="sanitizer_common.h.html#__sanitizer::MonotonicNanoTime" title='__sanitizer::MonotonicNanoTime' data-ref="__sanitizer::MonotonicNanoTime" data-ref-filename="__sanitizer..MonotonicNanoTime">MonotonicNanoTime</a>()) {</td></tr>
<tr><th id="846">846</th><td>        <b>return</b>;  <i>// Memory was returned recently.</i></td></tr>
<tr><th id="847">847</th><td>      }</td></tr>
<tr><th id="848">848</th><td>    }</td></tr>
<tr><th id="849">849</th><td></td></tr>
<tr><th id="850">850</th><td>    <a class="type" href="#__sanitizer::SizeClassAllocator64::MemoryMapper" title='__sanitizer::SizeClassAllocator64::MemoryMapper' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper">MemoryMapper</a> <dfn class="local col0 decl" id="1190memory_mapper" title='memory_mapper' data-type='__sanitizer::SizeClassAllocator64::MemoryMapper' data-ref="1190memory_mapper" data-ref-filename="1190memory_mapper">memory_mapper</dfn>(*<b>this</b>, <a class="local col3 ref" href="#1183class_id" title='class_id' data-ref="1183class_id" data-ref-filename="1183class_id">class_id</a>);</td></tr>
<tr><th id="851">851</th><td></td></tr>
<tr><th id="852">852</th><td>    ReleaseFreeMemoryToOS&lt;<a class="type" href="#__sanitizer::SizeClassAllocator64::MemoryMapper" title='__sanitizer::SizeClassAllocator64::MemoryMapper' data-ref="__sanitizer::SizeClassAllocator64::MemoryMapper" data-ref-filename="__sanitizer..SizeClassAllocator64..MemoryMapper">MemoryMapper</a>&gt;(</td></tr>
<tr><th id="853">853</th><td>        <a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetFreeArray" title='__sanitizer::SizeClassAllocator64::GetFreeArray' data-ref="__sanitizer::SizeClassAllocator64::GetFreeArray" data-ref-filename="__sanitizer..SizeClassAllocator64..GetFreeArray">GetFreeArray</a>(<a class="member fn" href="#__sanitizer::SizeClassAllocator64::GetRegionBeginBySizeClass" title='__sanitizer::SizeClassAllocator64::GetRegionBeginBySizeClass' data-ref="__sanitizer::SizeClassAllocator64::GetRegionBeginBySizeClass" data-ref-filename="__sanitizer..SizeClassAllocator64..GetRegionBeginBySizeClass">GetRegionBeginBySizeClass</a>(<a class="local col3 ref" href="#1183class_id" title='class_id' data-ref="1183class_id" data-ref-filename="1183class_id">class_id</a>)), <a class="local col8 ref" href="#1188n" title='n' data-ref="1188n" data-ref-filename="1188n">n</a>, <a class="local col6 ref" href="#1186chunk_size" title='chunk_size' data-ref="1186chunk_size" data-ref-filename="1186chunk_size">chunk_size</a>,</td></tr>
<tr><th id="854">854</th><td>        RoundUpTo(<a class="local col5 ref" href="#1185region" title='region' data-ref="1185region" data-ref-filename="1185region">region</a>-&gt;allocated_user, <a class="local col7 ref" href="#1187page_size" title='page_size' data-ref="1187page_size" data-ref-filename="1187page_size">page_size</a>) / <a class="local col7 ref" href="#1187page_size" title='page_size' data-ref="1187page_size" data-ref-filename="1187page_size">page_size</a>,</td></tr>
<tr><th id="855">855</th><td>        &amp;<a class="local col0 ref" href="#1190memory_mapper" title='memory_mapper' data-ref="1190memory_mapper" data-ref-filename="1190memory_mapper">memory_mapper</a>);</td></tr>
<tr><th id="856">856</th><td></td></tr>
<tr><th id="857">857</th><td>    <b>if</b> (<a class="local col0 ref" href="#1190memory_mapper" title='memory_mapper' data-ref="1190memory_mapper" data-ref-filename="1190memory_mapper">memory_mapper</a>.GetReleasedRangesCount() &gt; <var>0</var>) {</td></tr>
<tr><th id="858">858</th><td>      <a class="local col5 ref" href="#1185region" title='region' data-ref="1185region" data-ref-filename="1185region">region</a>-&gt;rtoi.n_freed_at_last_release = <a class="local col5 ref" href="#1185region" title='region' data-ref="1185region" data-ref-filename="1185region">region</a>-&gt;stats.n_freed;</td></tr>
<tr><th id="859">859</th><td>      <a class="local col5 ref" href="#1185region" title='region' data-ref="1185region" data-ref-filename="1185region">region</a>-&gt;rtoi.num_releases += <a class="local col0 ref" href="#1190memory_mapper" title='memory_mapper' data-ref="1190memory_mapper" data-ref-filename="1190memory_mapper">memory_mapper</a>.GetReleasedRangesCount();</td></tr>
<tr><th id="860">860</th><td>      <a class="local col5 ref" href="#1185region" title='region' data-ref="1185region" data-ref-filename="1185region">region</a>-&gt;rtoi.last_released_bytes = <a class="local col0 ref" href="#1190memory_mapper" title='memory_mapper' data-ref="1190memory_mapper" data-ref-filename="1190memory_mapper">memory_mapper</a>.GetReleasedBytes();</td></tr>
<tr><th id="861">861</th><td>    }</td></tr>
<tr><th id="862">862</th><td>    <a class="local col5 ref" href="#1185region" title='region' data-ref="1185region" data-ref-filename="1185region">region</a>-&gt;rtoi.last_release_at_ns = <a class="ref fn" href="sanitizer_common.h.html#__sanitizer::MonotonicNanoTime" title='__sanitizer::MonotonicNanoTime' data-ref="__sanitizer::MonotonicNanoTime" data-ref-filename="__sanitizer..MonotonicNanoTime">MonotonicNanoTime</a>();</td></tr>
<tr><th id="863">863</th><td>  }</td></tr>
<tr><th id="864">864</th><td>};</td></tr>
<tr><th id="865">865</th><td></td></tr>
</table><hr/><p id='footer'>
Generated while processing <a href='../asan/asan_activation.cpp.html'>llvm/compiler-rt/lib/asan/asan_activation.cpp</a><br/>Generated on <em>2021-Jul-01</em> from project llvm revision <em>12</em>